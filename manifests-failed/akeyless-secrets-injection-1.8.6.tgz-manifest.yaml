---
# Source: akeyless-secrets-injection/templates/webhook-servicaccount.yaml
apiVersion: v1
kind: ServiceAccount
automountServiceAccountToken: true
metadata:
  name: my-release-akeyless-secrets-injection
  namespace: "akeyless-secrets-injection-1.8.6.tgz"
  labels:
    app: my-release-akeyless-secrets-injection
    chart: akeyless-secrets-injection-1.8.6
    release: my-release
    heritage: Helm
    component: mutating-webhook
---
# Source: akeyless-secrets-injection/templates/webhook-service.yaml
apiVersion: v1
kind: Service
metadata:
  name: my-release-akeyless-secrets-injection
  labels:
    app: my-release-akeyless-secrets-injection
    chart: akeyless-secrets-injection-1.8.6
    release: my-release
    heritage: Helm
    component: mutating-webhook
spec:
  type: ClusterIP
  ports:
    - port: 443
      targetPort: 8443
      protocol: TCP
      name: secrets-webhook
  selector:
    app: akeyless-secrets-injection
    release: my-release
---
# Source: akeyless-secrets-injection/templates/webhook-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-release-akeyless-secrets-injection
  labels:
    app: akeyless-secrets-injection
    chart: akeyless-secrets-injection-1.8.6
    release: my-release
    heritage: Helm
    component: mutating-webhook
spec:
  replicas: 2
  selector:
    matchLabels:
      app: akeyless-secrets-injection
      release: my-release
  template:
    metadata:
      labels:
        app: akeyless-secrets-injection
        release: my-release
      annotations:
        checksum/config: c718ab85718aadc59fcc8854c5982c150896d94a3d5ea627f5d2e637dbbd50d2
    spec:
      serviceAccountName: my-release-akeyless-secrets-injection
      volumes:
      - name: serving-cert
        secret:
          defaultMode: 420
          secretName: my-release-akeyless-secrets-injection
      containers:
        - name: akeyless-secrets-injection
          image: "docker.registry-2.akeyless.io/k8s-webhook-server:0.24.3"
          env:
          - name: TLS_CERT_FILE
            value: /var/serving-cert/servingCert
          - name: TLS_PRIVATE_KEY_FILE
            value: /var/serving-cert/servingKey
          - name: INTERNAL_PORT
            value: "8443"
          - name: DEBUG
            value: "false"
          - name: AKEYLESS_AGENT_IMAGE
            value: "docker.registry-2.akeyless.io/k8s-secrets-sidecar:0.24.3"
          - name: AKEYLESS_ACCESS_ID
            value: 
          - name: AKEYLESS_ACCESS_TYPE
            value: 
          - name: AKEYLESS_AGENT_LIMITS_CPU
            value: 500m
          - name: AKEYLESS_AGENT_LIMITS_MEM
            value: 128Mi
          - name: AKEYLESS_AGENT_REQUESTS_CPU
            value: 250m
          - name: AKEYLESS_AGENT_REQUESTS_MEM
            value: 64Mi
          - name: AKEYLESS_URL
            value: https://vault.akeyless.io
          imagePullPolicy: IfNotPresent
          ports:
            - containerPort: 8443
          livenessProbe:
            httpGet:
              path: /health
              port: 8443
              scheme: HTTPS
            failureThreshold: 5
            initialDelaySeconds: 10
            periodSeconds: 30
          readinessProbe:
            httpGet:
              path: /health
              port: 8443
              scheme: HTTPS
            initialDelaySeconds: 10
            periodSeconds: 30
            timeoutSeconds: 5
          volumeMounts:
          - mountPath: /var/serving-cert
            name: serving-cert
          securityContext: #//only for k8s - not openshift compatible
            runAsUser: 65534
            allowPrivilegeEscalation: false
          resources:
            limits:
              cpu: 0.5
              memory: 192Mi
            requests:
              cpu: 0.25
              memory: 128Mi
      affinity:
        podAntiAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
          - weight: 100
            podAffinityTerm:
              topologyKey: kubernetes.io/hostname
              labelSelector:
                matchLabels:
                  app: akeyless-secrets-injection
                  release: my-release
---
# Source: akeyless-secrets-injection/templates/apiservice-webhook.yaml
apiVersion: v1
kind: List
metadata:
items:

- apiVersion: v1
  kind: Secret
  metadata:
    name: my-release-akeyless-secrets-injection
  data:
    servingCert: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUR1RENDQXFDZ0F3SUJBZ0lSQUxldHVnaFMzWmJzZ3VpeHh2KzZ2V3d3RFFZSktvWklodmNOQVFFTEJRQXcKRlRFVE1CRUdBMVVFQXhNS2MzWmpMV05oZEMxallUQWVGdzB5TkRBMk1qQXhORFUwTlRGYUZ3MHlOVEEyTWpBeApORFUwTlRGYU1Ga3hWekJWQmdOVkJBTVRUbTE1TFhKbGJHVmhjMlV0WVd0bGVXeGxjM010YzJWamNtVjBjeTFwCmJtcGxZM1JwYjI0dVlXdGxlV3hsYzNNdGMyVmpjbVYwY3kxcGJtcGxZM1JwYjI0dE1TNDRMall1ZEdkNkxuTjIKWXpDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBTHp3aCt3MjhxZTJaSTBpb2JYTApwNFBnaHgweXE0MjdJSk5IUHBDbTFZUmZuaXRZS1UvdklkMGlXWlN5MkJmSFpraUFyejRqS3lBRXRmTUVaYWM2ClhxRkdrNWxIUzFic0c0SFA3TkJ4Wm5WN0ZMZ3ovdTlIa0x4cVU1UGtocmRvZ0RiN2NNU01CM2dEdnk4a3haK1oKcW0zdyt5YUN5STJUYURieFJhZ1hualQxYzJLM01zSWMzYVZBeXdXTjkzT2l3RUVMaTRNSEE2S1BiaWNCQUR5ZQpYb0RKV2NDekVtd21NSE9LTVlUZzllRFQ2K3JuMStyeVZpU0x0NVhBTzhsT2lrdXZtOXI1UUo0YTBRSTZyUHoyCnMzRStmRE44R3VSMDd3NTBQaFd6NHBnM0x3SWE5YVJnTHIrUC9OS3J0SXJ5SmVPajNaU0NYcEJPWmdKK3ZvSlYKRUFVQ0F3RUFBYU9CdmpDQnV6QU9CZ05WSFE4QkFmOEVCQU1DQmFBd0hRWURWUjBsQkJZd0ZBWUlLd1lCQlFVSApBd0VHQ0NzR0FRVUZCd01DTUF3R0ExVWRFd0VCL3dRQ01BQXdId1lEVlIwakJCZ3dGb0FVbTFNRXE0S1EyR0t5CndMRjgyYmpRaXFPL290NHdXd1lEVlIwUkJGUXdVb0pPYlhrdGNtVnNaV0Z6WlMxaGEyVjViR1Z6Y3kxelpXTnkKWlhSekxXbHVhbVZqZEdsdmJpNWhhMlY1YkdWemN5MXpaV055WlhSekxXbHVhbVZqZEdsdmJpMHhMamd1Tmk1MApaM291YzNaamdnQXdEUVlKS29aSWh2Y05BUUVMQlFBRGdnRUJBR0M0QUd3cjFHZHVuZTBKMGNZak5qMW5zWEE3CnB4Umg2NWVkTjRiV25wVXhIcm5nZTFaQjVkVXM0cUhkS0V3MHBBUDZibGR4WHJtVGE2dFM5YngzcE5jWnM0RmcKU0VseEVodStUWS8yTytxdmVxNUI2cmxseWFPa0VZWHVKNUlyQ1FNcitWdUN6eDg4eWFvSE9LYkNEY290eDlKeApwUU4wclZabHVuZVRFSEdDbWI5dWxkREFEYWNHOG9pOGxCV3BvYW8zTXU4NC9Rb1R3SDJsN2xOeER0S2lWTDhjCnNRVG05eFBlbnVMVStpK0pkQWtrdUdkOCt6eUdUa1Z2WXlDekNWUkZDZ2d0ZHh3dnJoZndNRDdoSDAvOVVUcVQKdjQycUhTdXQxcUxqSzBUOFZQZDQ2YjYvMis5eTNDOFRlLzlFaHBXdG4rZlBTMEFQZzlsVlEybnQxMEk9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
    servingKey: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb3dJQkFBS0NBUUVBdlBDSDdEYnlwN1pralNLaHRjdW5nK0NISFRLcmpic2drMGMra0tiVmhGK2VLMWdwClQrOGgzU0pabExMWUY4ZG1TSUN2UGlNcklBUzE4d1JscHpwZW9VYVRtVWRMVnV3YmdjL3MwSEZtZFhzVXVEUCsKNzBlUXZHcFRrK1NHdDJpQU52dHd4SXdIZUFPL0x5VEZuNW1xYmZEN0pvTElqWk5vTnZGRnFCZWVOUFZ6WXJjeQp3aHpkcFVETEJZMzNjNkxBUVF1TGd3Y0Rvbzl1SndFQVBKNWVnTWxad0xNU2JDWXdjNG94aE9EMTROUHI2dWZYCjZ2SldKSXUzbGNBN3lVNktTNitiMnZsQW5oclJBanFzL1BhemNUNThNM3dhNUhUdkRuUStGYlBpbURjdkFocjEKcEdBdXY0LzgwcXUwaXZJbDQ2UGRsSUpla0U1bUFuNitnbFVRQlFJREFRQUJBb0lCQURnZDFMRVM3T1ZsSmQ1SgpYL0JINlp3Z3J1QzhNUG5xajFWTy9zVWwyQnIxNzF0K1Z0N1g3cDNvV3VUd2JZQTZpQ1dXbXZZQXFnbGJmTk1PCkJrY3g3Zk5HckFZRmg5bnNUSXMwdjJoMWxmSGt1Wld3VTlLcjFkQXdZRngzcm8rQTZUdnJXR1g0RlN2UEtSU08KZm1mVjB5bk9Qam9FOUI0Z252NWFrTTdKSFFNck5BTmJaRXVSVVlkODdJWVVSckp4SWxpei9TZ0dBY1M1a2NrZgp0ZkVRTml4bGE0R0IvRFpLTnZlVk1IM0N6U0orVENHbm9rbFFYTzJYaDlXZDJFSzlQY28xUzdqdDNoRHNvV25FCkxMR0UxalNadEcxUkFkMm1Ia0xIeEFEc3hZNjIvZUhNUHp2TjRpNlh2WXR2UU4wWUFVZXhkWVBxR2xIMVdDWUwKRVBLcE1RMENnWUVBd2FXWGVhZHBZN1E1SnVJYjhlTmxHdUxzS1JFdzdNeFZPSTJQaDlXTHJJTWRlWjhjeFBLcwpHdmUzYTdQMTdRZ2hBK1g3UXJFZEd2TFZCeDl5TGpFVklYcEs3NmFSWHRFRzlEYmpMcGx0VmZ6Q25kQ3JpNE5DCi9Ka1JTQ25LalU3emZCMlFlRWhCRnpFT05zS3Q2VjNJWTc0MStQdmx0Zlp4WmZKV2haUVY4OE1DZ1lFQStjYnEKckZqNjRGRlpCa0E4d29UcldEOWg1U1d2WmptRTVFeUdZWDdCNW96Nmx5TzgwSmd1UmdRN1d0M0FHOEZCczFJUQpCeDhNSEUwYVVtS2lUaUxUR0RSZlpsT0FoMUhCemN2SC9QMy9aSjN6NUVwM0NJYUlodE5SQXVGUVpjV3NZUjRYCmMweE1YRmozaUg4ZEdxeXZUMk14a0JkQmVWaUVMMFhrZ1ByWUdKY0NnWUFGbTdBWlc5blhnMTZzVzV3SGsxaFkKUVA0cDZrK0tiQmlEdk1YTlgwZmVSU1hUWWVKSmFlWEdHaXA3dWdpRFJ0cjk2K2tzODBndWdaM2R5UEZibVJ4TgpqZWNocmFkRUliV2IyUU1YVkdZd09WUEJra3VGak5XaHp5VUsrL3Jid00rWVpwcktnUDB4bU1BYW9lUzdmM1hRClBhLytkLzBkR2ZnS3hjdnZybXc4VlFLQmdRRERIN2JpTHB6RnNpYm1zRFlIQzRsQ3Bqa1dwcXJ3STgwQ0FCb1cKZmN5Q0MrNFROaExoclpDd2w4dTZmM0w4KzZzVXArM25ja1NtczBEMXpTSFlBbkovL1NIdHNSdStHb3RZOW5IagozSlN3Q0lpbjlkZ3BhOWVwNDlqc2RCRzNmNFhiVklPalNaNTVvZksxeWY5MWdDTnYxQ0M2M01BRVNMYnlxeG9ICi9HM21Qd0tCZ0Qvb1FzSWlXNDAva2xHbEU2ekJCU1M0akhLVGN2VENBWTd0d0VDRXJBV2M1ODVkeEhwbE5hQXUKVURQWW5XK21kMzc3eW9TWENsUS85WTZZalQ4ZS85OW13OWtHbVBWR3ljL2ZIdktCcndtRk1VSXVERDJkeXpLNApLVDFEaXlCSzhpV1dKRkJDZkNwT0xuZTlwVzFMMENmLzJUQ25wQ1I0Rm94eFZrZUthTmt1Ci0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tCg==
    caCert: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURGVENDQWYyZ0F3SUJBZ0lRSTFwMzdNeXl6QThaMWZUQ0FlQ1Z4akFOQmdrcWhraUc5dzBCQVFzRkFEQVYKTVJNd0VRWURWUVFERXdwemRtTXRZMkYwTFdOaE1CNFhEVEkwTURZeU1ERTBOVFExTVZvWERUTTBNRFl4T0RFMApOVFExTVZvd0ZURVRNQkVHQTFVRUF4TUtjM1pqTFdOaGRDMWpZVENDQVNJd0RRWUpLb1pJaHZjTkFRRUJCUUFECmdnRVBBRENDQVFvQ2dnRUJBTnh2UkZ3T3VaanN5UkZ4VU0vbnBVLytqTWNwT29ETWwzc25vVjlYYzB3OUdWalkKMlY2a0JBamlrVDRHSU5KbFY3SzBONEs5S1cxWHBUOVlhWWRUVTlrMEJ5RUlhU25acGg1Q3pDVktnY3VSN2NRMQo5OFpaT3hPSFFEdXc3K0tNeEgvWk9SaGtkZXdoWHk3VEs5Z2k3dmFvME5XcVZVblhZaHNvNktzRUczV1lxT2VHCkVMRnZuU3RxK25Sa3NSM0Y2bmdTeDRXR2o3bDhLY0dIN0FzaGRsM0RwMkZlZHNvelhkTWMvb0lreHE5UExTYy8KWGtWUDhQREJQdXh5WnBWTVBIN2xocHZvRk11ekFNZ0pMMkJaRHU1Mk5Ob3dFWndBdklMMlFmTmNiZ0VFZ2NzQwpwSjNSWVVWODN5amZBME1XNmFRQUV6MXZhbGxONWx5TWFsNjdKQVVDQXdFQUFhTmhNRjh3RGdZRFZSMFBBUUgvCkJBUURBZ0trTUIwR0ExVWRKUVFXTUJRR0NDc0dBUVVGQndNQkJnZ3JCZ0VGQlFjREFqQVBCZ05WSFJNQkFmOEUKQlRBREFRSC9NQjBHQTFVZERnUVdCQlNiVXdTcmdwRFlZckxBc1h6WnVOQ0tvNytpM2pBTkJna3Foa2lHOXcwQgpBUXNGQUFPQ0FRRUFTcFhob3EwYitlTFRsK3prQytWWk42SlBSOXMrZU96OS9rWjcxcXphMWYrOVFrS21CZFVzCkErT3pONk5wdFRBNksyckpYVFRqZUNrTndIOUgzTll5WXVuUHlnVU9sUHlxYks2Tm03WWxmVHVGb2cyQ0VJSGoKckZ3L09kc1ZhZlJsclJwcThJWkRZSENmcXFvdDlWbk5KNHJDc0FRRnNESkpuNVFTandVN0ExMDBSNWpMcWs5ago4dnVzdnpuVW1ZbldVYmN5a29MU1cxZjI1OEhkWHJxdVJOMXJ0MFhZUUF6eStvRXpsRU9WWjA5byszdktrVFptCnVHbDRqRDkwYWQ3aVFJVGJuZUlWQ2xoVVJKVkNSOW8yS3VyYXVFaUt2Z1hNVW1mTmRWY1BFSzZnMDhNUk5sQTQKZEZJV3hVZkgxRTlZSVpmNjlJeDNHbi9jeGtHRVM1N0RHQT09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K

- apiVersion: admissionregistration.k8s.io/v1
  kind: MutatingWebhookConfiguration
  metadata:
    name: my-release-akeyless-secrets-injection
  webhooks:
  - name: pods.akeyless-secrets-injection.admission
    clientConfig:
      service:
        namespace: akeyless-secrets-injection-1.8.6.tgz
        name: my-release-akeyless-secrets-injection
        path: /pods
      caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURGVENDQWYyZ0F3SUJBZ0lRSTFwMzdNeXl6QThaMWZUQ0FlQ1Z4akFOQmdrcWhraUc5dzBCQVFzRkFEQVYKTVJNd0VRWURWUVFERXdwemRtTXRZMkYwTFdOaE1CNFhEVEkwTURZeU1ERTBOVFExTVZvWERUTTBNRFl4T0RFMApOVFExTVZvd0ZURVRNQkVHQTFVRUF4TUtjM1pqTFdOaGRDMWpZVENDQVNJd0RRWUpLb1pJaHZjTkFRRUJCUUFECmdnRVBBRENDQVFvQ2dnRUJBTnh2UkZ3T3VaanN5UkZ4VU0vbnBVLytqTWNwT29ETWwzc25vVjlYYzB3OUdWalkKMlY2a0JBamlrVDRHSU5KbFY3SzBONEs5S1cxWHBUOVlhWWRUVTlrMEJ5RUlhU25acGg1Q3pDVktnY3VSN2NRMQo5OFpaT3hPSFFEdXc3K0tNeEgvWk9SaGtkZXdoWHk3VEs5Z2k3dmFvME5XcVZVblhZaHNvNktzRUczV1lxT2VHCkVMRnZuU3RxK25Sa3NSM0Y2bmdTeDRXR2o3bDhLY0dIN0FzaGRsM0RwMkZlZHNvelhkTWMvb0lreHE5UExTYy8KWGtWUDhQREJQdXh5WnBWTVBIN2xocHZvRk11ekFNZ0pMMkJaRHU1Mk5Ob3dFWndBdklMMlFmTmNiZ0VFZ2NzQwpwSjNSWVVWODN5amZBME1XNmFRQUV6MXZhbGxONWx5TWFsNjdKQVVDQXdFQUFhTmhNRjh3RGdZRFZSMFBBUUgvCkJBUURBZ0trTUIwR0ExVWRKUVFXTUJRR0NDc0dBUVVGQndNQkJnZ3JCZ0VGQlFjREFqQVBCZ05WSFJNQkFmOEUKQlRBREFRSC9NQjBHQTFVZERnUVdCQlNiVXdTcmdwRFlZckxBc1h6WnVOQ0tvNytpM2pBTkJna3Foa2lHOXcwQgpBUXNGQUFPQ0FRRUFTcFhob3EwYitlTFRsK3prQytWWk42SlBSOXMrZU96OS9rWjcxcXphMWYrOVFrS21CZFVzCkErT3pONk5wdFRBNksyckpYVFRqZUNrTndIOUgzTll5WXVuUHlnVU9sUHlxYks2Tm03WWxmVHVGb2cyQ0VJSGoKckZ3L09kc1ZhZlJsclJwcThJWkRZSENmcXFvdDlWbk5KNHJDc0FRRnNESkpuNVFTandVN0ExMDBSNWpMcWs5ago4dnVzdnpuVW1ZbldVYmN5a29MU1cxZjI1OEhkWHJxdVJOMXJ0MFhZUUF6eStvRXpsRU9WWjA5byszdktrVFptCnVHbDRqRDkwYWQ3aVFJVGJuZUlWQ2xoVVJKVkNSOW8yS3VyYXVFaUt2Z1hNVW1mTmRWY1BFSzZnMDhNUk5sQTQKZEZJV3hVZkgxRTlZSVpmNjlJeDNHbi9jeGtHRVM1N0RHQT09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
    rules:
    - operations:
      - CREATE
      apiGroups:
      - "*"
      apiVersions:
      - "*"
      resources:
      - pods
    failurePolicy: Ignore
    namespaceSelector:
      matchExpressions:
      - key: name
        operator: NotIn
        values:
        - akeyless-secrets-injection-1.8.6.tgz
    objectSelector:
      matchExpressions:
      - key: release
        operator: NotIn
        values: 
        - my-release
    admissionReviewVersions: ["v1beta1"]
    sideEffects: None #Unknown
