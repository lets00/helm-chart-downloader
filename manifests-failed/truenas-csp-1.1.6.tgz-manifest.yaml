---
# Source: truenas-csp/charts/hpe-csi-driver/templates/hpe-csi-rbac.yaml
kind: ServiceAccount
apiVersion: v1
metadata:
  name: hpe-csi-controller-sa
  namespace: truenas-csp-1.1.6.tgz
---
# Source: truenas-csp/charts/hpe-csi-driver/templates/hpe-csi-rbac.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: hpe-csi-node-sa
  namespace: truenas-csp-1.1.6.tgz
---
# Source: truenas-csp/charts/hpe-csi-driver/templates/hpe-csi-rbac.yaml
kind: ServiceAccount
apiVersion: v1
metadata:
  name: hpe-csp-sa
  namespace: truenas-csp-1.1.6.tgz
---
# Source: truenas-csp/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: my-release-truenas-csp
  labels:
    helm.sh/chart: truenas-csp-1.1.6
    app.kubernetes.io/name: truenas-csp
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "2.4.2"
    app.kubernetes.io/managed-by: Helm
---
# Source: truenas-csp/charts/hpe-csi-driver/templates/hpe-linux-config.yaml
kind: ConfigMap
apiVersion: v1
metadata:
  name: hpe-linux-config
  namespace: truenas-csp-1.1.6.tgz
data:

  config.json: |-
    {
    	"Nimble": {
    		"Default": [
    			{
    				"category": "iscsi",
    				"severity": "warning",
    				"description": "Manual startup of iSCSI nodes on boot. Can be set in /etc/iscsi/iscsid.conf",
    				"parameter": "startup",
    				"recommendation": "manual"
    			},
    			{
    				"category": "iscsi",
    				"severity": "warning",
    				"description": "Replacement_timeout of 10 seconds is recommended for faster failover of I/O by multipath on path failures. Can be set in /etc/iscsi/iscsid.conf",
    				"parameter": "replacement_timeout",
    				"recommendation": "10"
    			},
    			{
    				"category": "iscsi",
    				"severity": "warning",
    				"description": "Minimum login timeout of 15 seconds is recommended with iSCSI. Can be set in /etc/iscsi/iscsid.conf",
    				"parameter": "login_timeout",
    				"recommendation": "15"
    			},
    			{
    				"category": "iscsi",
    				"severity": "warning",
    				"description": "Minimum timeout of 10 seconds is recommended with noop requests. Can be set in /etc/iscsi/iscsid.conf",
    				"parameter": "noop_out_timeout",
    				"recommendation": "10"
    			},
    			{
    				"category": "iscsi",
    				"severity": "warning",
    				"description": "Minimum cmds_max of 512 is recommended for each session if handling multiple LUN's. Can be set in /etc/iscsi/iscsid.conf",
    				"parameter": "cmds_max",
    				"recommendation": "512"
    			},
    			{
    				"category": "iscsi",
    				"severity": "warning",
    				"description": "Minimum queue_depth of 256 is recommended for each iSCSI session/path. Can be set in /etc/iscsi/iscsid.conf",
    				"parameter": "queue_depth",
    				"recommendation": "256"
    			},
    			{
    				"category": "iscsi",
    				"severity": "warning",
    				"description": "Minimum number of sessions per iSCSI login is recommended to be 1 by default. If additional sessions are needed this can be set in /etc/iscsi/iscsid.conf. If NCM is running, please change min_session_per_array in /etc/ncm.conf and restart nlt service instead",
    				"parameter": "nr_sessions",
    				"recommendation": "1"
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": "product attribute recommended to be set to Server in /etc/multipath.conf",
    				"parameter": "product",
    				"recommendation": "\"Server\""
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": "alua prioritizer is recommended. Can be set in /etc/multipath.conf",
    				"parameter": "prio",
    				"recommendation": "alua"
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": "scsi_dh_alua device handler is recommended. Can be set in /etc/multipath.conf",
    				"parameter": "hardware_handler",
    				"recommendation": "\"1 alua\""
    			},
    			{
    				"category": "multipath",
    				"severity": "warning",
    				"description": "immediate failback setting is recommended. Can be set in /etc/multipath.conf",
    				"parameter": "failback",
    				"recommendation": "immediate"
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": "immediately fail i/o on transient path failures to retry on other paths, value=1. Can be set in /etc/multipath.conf",
    				"parameter": "fast_io_fail_tmo",
    				"recommendation": "5"
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": "queueing is recommended for 150 seconds, with no_path_retry value of 30. Can be set in /etc/multipath.conf",
    				"parameter": "no_path_retry",
    				"recommendation": "30"
    			},
    			{
    				"category": "multipath",
    				"severity": "warning",
    				"description": "service-time path selector is recommended. Can be set in /etc/multipath.conf",
    				"parameter": "path_selector",
    				"recommendation": "\"service-time 0\""
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": "vendor attribute recommended to be set to Nimble in /etc/multipath.conf",
    				"parameter": "vendor",
    				"recommendation": "\"Nimble\""
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": "group paths according to ALUA path priority of active/standby. Recommended to be set to group_by_prio in /etc/multipath.conf",
    				"parameter": "path_grouping_policy",
    				"recommendation": "group_by_prio"
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": "tur path checker is recommended. Can be set in /etc/multipath.conf",
    				"parameter": "path_checker",
    				"recommendation": "tur"
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": "infinite value is recommended for timeout in cases of device loss for FC. Can be set in /etc/multipath.conf",
    				"parameter": "dev_loss_tmo",
    				"recommendation": "infinity"
    			}
    		],
    		"Ubuntu": null
    	},
    	"3PARdata": {
    		"Default": [
    			{
    				"category": "iscsi",
    				"severity": "warning",
    				"description": "Manual startup of iSCSI nodes on boot. Can be set in /etc/iscsi/iscsid.conf",
    				"parameter": "startup",
    				"recommendation": "manual"
    			},
    			{
    				"category": "iscsi",
    				"severity": "warning",
    				"description": "Replacement_timeout of 10 seconds is recommended for faster failover of I/O by multipath on path failures. Can be set in /etc/iscsi/iscsid.conf",
    				"parameter": "replacement_timeout",
    				"recommendation": "10"
    			},
    			{
    				"category": "iscsi",
    				"severity": "warning",
    				"description": "Minimum login timeout of 15 seconds is recommended with iSCSI. Can be set in /etc/iscsi/iscsid.conf",
    				"parameter": "login_timeout",
    				"recommendation": "15"
    			},
    			{
    				"category": "iscsi",
    				"severity": "warning",
    				"description": "Minimum timeout of 10 seconds is recommended with noop requests. Can be set in /etc/iscsi/iscsid.conf",
    				"parameter": "noop_out_timeout",
    				"recommendation": "10"
    			},
    			{
    				"category": "iscsi",
    				"severity": "warning",
    				"description": "Minimum cmds_max of 512 is recommended for each session if handling multiple LUN's. Can be set in /etc/iscsi/iscsid.conf",
    				"parameter": "cmds_max",
    				"recommendation": "512"
    			},
    			{
    				"category": "iscsi",
    				"severity": "warning",
    				"description": "Minimum queue_depth of 256 is recommended for each iSCSI session/path. Can be set in /etc/iscsi/iscsid.conf",
    				"parameter": "queue_depth",
    				"recommendation": "256"
    			},
    			{
    				"category": "iscsi",
    				"severity": "warning",
    				"description": "Minimum number of sessions per iSCSI login is recommended to be 1 by default. If additional sessions are needed this can be set in /etc/iscsi/iscsid.conf. If NCM is running, please change min_session_per_array in /etc/ncm.conf and restart nlt service instead",
    				"parameter": "nr_sessions",
    				"recommendation": "1"
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": "product attribute recommended to be set to VV in /etc/multipath.conf",
    				"parameter": "product",
    				"recommendation": "\"VV\""
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": "alua prioritizer is recommended. Can be set in /etc/multipath.conf",
    				"parameter": "prio",
    				"recommendation": "alua"
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": "scsi_dh_alua device handler is recommended. Can be set in /etc/multipath.conf",
    				"parameter": "hardware_handler",
    				"recommendation": "\"1 alua\""
    			},
    			{
    				"category": "multipath",
    				"severity": "warning",
    				"description": "immediate failback setting is recommended. Can be set in /etc/multipath.conf",
    				"parameter": "failback",
    				"recommendation": "immediate"
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": "immediately fail i/o on transient path failures to retry on other paths, value=1. Can be set in /etc/multipath.conf",
    				"parameter": "fast_io_fail_tmo",
    				"recommendation": "10"
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": "queueing is recommended for 150 seconds, with no_path_retry value of 18. Can be set in /etc/multipath.conf",
    				"parameter": "no_path_retry",
    				"recommendation": "18"
    			},
    			{
    				"category": "multipath",
    				"severity": "warning",
    				"description": "round-robin 0 path selector is recommended. Can be set in /etc/multipath.conf",
    				"parameter": "path_selector",
    				"recommendation": "\"round-robin 0\""
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": "vendor attribute recommended to be set to 3PARdata. Can be set in /etc/multipath.conf",
    				"parameter": "vendor",
    				"recommendation": "\"3PARdata\""
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": "group paths according to ALUA path priority of active/standby. Recommended to be set to group_by_prio in /etc/multipath.conf",
    				"parameter": "path_grouping_policy",
    				"recommendation": "group_by_prio"
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": "infinite value is recommended for timeout in cases of device loss for FC. Can be set in /etc/multipath.conf",
    				"parameter": "dev_loss_tmo",
    				"recommendation": "infinity"
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": "tur path checker is recommended. Can be set in /etc/multipath.conf",
    				"parameter": "path_checker",
    				"recommendation": "tur"
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": "0 value is recommended for features. Can be set in /etc/multipath.conf",
    				"parameter": "features",
    				"recommendation": "\"0\""
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": "uniform rr_weight is recommended. Can be set in /etc/multipath.conf",
    				"parameter": "rr_weight",
    				"recommendation": "\"uniform\""
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": "rr_min_io_rq 1 is recommended. Can be set in /etc/multipath.conf",
    				"parameter": "rr_min_io_rq",
    				"recommendation": "1"
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": "detect_prio yes is recommended. Can be set in /etc/multipath.conf",
    				"parameter": "detect_prio",
    				"recommendation": "yes"
    			}
    		],
    		"Ubuntu": [
    			{
    				"category": "iscsi",
    				"severity": "warning",
    				"description": "Automatic startup of iSCSI nodes on boot. Can be set in /etc/iscsi/iscsid.conf",
    				"parameter": "startup",
    				"recommendation": "automatic"
    			},
    			{
    				"category": "iscsi",
    				"severity": "warning",
    				"description": "Replacement_timeout of 10 seconds is recommended for faster failover of I/O by multipath on path failures. Can be set in /etc/iscsi/iscsid.conf",
    				"parameter": "replacement_timeout",
    				"recommendation": "10"
    			},
    			{
    				"category": "iscsi",
    				"severity": "warning",
    				"description": "Minimum interval of 10 seconds is recommended with noop requests. Can be set in /etc/iscsi/iscsid.conf",
    				"parameter": "noop_out_interval",
    				"recommendation": "10"
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": "product attribute recommended to be set to VV in /etc/multipath.conf",
    				"parameter": "product",
    				"recommendation": "\"VV\""
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": "alua prioritizer is recommended. Can be set in /etc/multipath.conf",
    				"parameter": "prio",
    				"recommendation": "alua"
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": "scsi_dh_alua device handler is recommended. Can be set in /etc/multipath.conf",
    				"parameter": "hardware_handler",
    				"recommendation": "\"1 alua\""
    			},
    			{
    				"category": "multipath",
    				"severity": "warning",
    				"description": "immediate failback setting is recommended. Can be set in /etc/multipath.conf",
    				"parameter": "failback",
    				"recommendation": "immediate"
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": "queueing is recommended for 150 seconds, with no_path_retry value of 18. Can be set in /etc/multipath.conf",
    				"parameter": "no_path_retry",
    				"recommendation": "18"
    			},
    			{
    				"category": "multipath",
    				"severity": "warning",
    				"description": "round-robin 0 path selector is recommended. Can be set in /etc/multipath.conf",
    				"parameter": "path_selector",
    				"recommendation": "\"round-robin 0\""
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": "vendor attribute recommended to be set to 3PARdata in /etc/multipath.conf",
    				"parameter": "vendor",
    				"recommendation": "\"3PARdata\""
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": "group paths according to ALUA path priority of active/standby. Recommended to be set to group_by_prio in /etc/multipath.conf",
    				"parameter": "path_grouping_policy",
    				"recommendation": "group_by_prio"
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": "getuid_callout whitelist is recommended. Can be set in /etc/multipath.conf",
    				"parameter": "getuid_callout",
    				"recommendation": "\"/lib/udev/scsi_id --whitelisted --device=/dev/%n\""
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": "rr_min_io is recommended with value as 100. Can be set in /etc/multipath.conf",
    				"parameter": "rr_min_io",
    				"recommendation": "100"
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": " tur checker is recommended. Can be set in /etc/multipath.conf",
    				"parameter": "checker",
    				"recommendation": "tur"
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": " tur path checker is recommended. Can be set in /etc/multipath.conf",
    				"parameter": "path_checker",
    				"recommendation": "tur"
    			},
    			{
    				"category": "multipath",
    				"severity": "critical",
    				"description": " features 0 is recommended. Can be set in /etc/multipath.conf",
    				"parameter": "features",
    				"recommendation": "\"0\""
    			}
    		]
    	}
    }
---
# Source: truenas-csp/charts/hpe-csi-driver/templates/hpe-csi-rbac.yaml
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: hpe-csi-provisioner-role
rules:
  - apiGroups: [""]
    resources: ["secrets"]
    verbs: ["get", "list"]
  - apiGroups: [""]
    resources: ["namespaces"]
    verbs: ["get", "list", "create"]
  - apiGroups: [""]
    resources: ["nodes"]
    verbs: ["get", "list"]
  - apiGroups: [""]
    resources: ["serviceaccounts"]
    verbs: ["get", "list", "create"]
  - apiGroups: [""]
    resources: ["configmaps"]
    verbs: ["get", "create"]
  - apiGroups: [""]
    resources: ["persistentvolumes"]
    verbs: ["get", "list", "watch", "create", "delete", "update"]
  - apiGroups: [""]
    resources: ["persistentvolumeclaims"]
    verbs: ["create", "get", "list", "watch", "update", "delete"]
  - apiGroups: [""]
    resources: ["services"]
    verbs: ["create", "get", "list", "watch", "update", "delete"]
  - apiGroups: ["apps"]
    resources: ["deployments"]
    verbs: ["create", "get", "list", "watch", "update", "delete"]
  - apiGroups: ["storage.k8s.io"]
    resources: ["storageclasses"]
    verbs: ["get", "list", "watch"]
  - apiGroups: [""]
    resources: ["events"]
    verbs: ["list", "watch", "create", "update", "patch"]
  - apiGroups: ["snapshot.storage.k8s.io"]
    resources: ["volumesnapshots"]
    verbs: ["get", "list"]
  - apiGroups: ["snapshot.storage.k8s.io"]
    resources: ["volumesnapshotcontents"]
    verbs: ["get", "list"]
  - apiGroups: [""]
    resources: ["pods"]
    verbs: ["get", "list", "delete"]
  - apiGroups: ["storage.k8s.io"]
    resources: ["volumeattachments"]
    verbs: ["get", "list", "watch", "update", "patch", "delete"]
---
# Source: truenas-csp/charts/hpe-csi-driver/templates/hpe-csi-rbac.yaml
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: hpe-csi-attacher-role
rules:
  - apiGroups: [""]
    resources: ["persistentvolumes"]
    verbs: ["get", "list", "watch", "update", "patch"]
  - apiGroups: [""]
    resources: ["nodes"]
    verbs: ["get", "list", "watch"]
  - apiGroups: ["storage.k8s.io"]
    resources: ["volumeattachments"]
    verbs: ["get", "list", "watch", "update", "patch"]
  - apiGroups: ["storage.k8s.io"]
    resources: ["volumeattachments/status"]
    verbs: ["get", "list", "watch", "update", "create", "delete", "patch"]
  - apiGroups: [""]
    resources: ["secrets"]
    verbs: ["get", "watch", "list"]
  - apiGroups: ["storage.k8s.io"]
    resources: ["csinodes"]
    verbs: ["get", "list", "watch"]
---
# Source: truenas-csp/charts/hpe-csi-driver/templates/hpe-csi-rbac.yaml
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: hpe-csi-snapshotter-role
rules:
  - apiGroups: [""]
    resources: ["secrets"]
    verbs: ["get", "list"]
  - apiGroups: [""]
    resources: ["persistentvolumes"]
    verbs: ["get", "list", "watch", "create", "delete"]
  - apiGroups: [""]
    resources: ["persistentvolumeclaims"]
    verbs: ["get", "list", "watch", "update"]
  - apiGroups: ["storage.k8s.io"]
    resources: ["storageclasses"]
    verbs: ["get", "list", "watch"]
  - apiGroups: [""]
    resources: ["events"]
    verbs: ["list", "watch", "create", "update", "patch"]
  - apiGroups: ["snapshot.storage.k8s.io"]
    resources: ["volumesnapshots"]
    verbs: ["create", "update", "delete", "get", "list", "watch"]
  - apiGroups: ["snapshot.storage.k8s.io"]
    resources: ["volumesnapshots/status"]
    verbs: ["update"]
  - apiGroups: ["snapshot.storage.k8s.io"]
    resources: ["volumesnapshotcontents"]
    verbs: ["create", "update", "delete", "get", "list", "watch", "patch"]
  - apiGroups: ["snapshot.storage.k8s.io"]
    resources: ["volumesnapshotcontents/status"]
    verbs: ["create", "get", "list", "watch", "update", "delete", "patch"]
  - apiGroups: ["snapshot.storage.k8s.io"]
    resources: ["volumesnapshotclasses"]
    verbs: ["get", "list", "watch"]
  - apiGroups: ["apiextensions.k8s.io"]
    resources: ["customresourcedefinitions"]
    verbs: ["get", "list", "watch", "create", "delete", "update"]
---
# Source: truenas-csp/charts/hpe-csi-driver/templates/hpe-csi-rbac.yaml
# Resizer must be able to work with PVCs, PVs, SCs.
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: external-resizer-role
rules:
  - apiGroups: [""]
    resources: ["secrets"]
    verbs: ["get", "list", "watch"]
  - apiGroups: [""]
    resources: ["persistentvolumes"]
    verbs: ["get", "list", "watch", "update", "patch"]
  - apiGroups: [""]
    resources: ["persistentvolumeclaims"]
    verbs: ["get", "list", "watch"]
  - apiGroups: [""]
    resources: ["persistentvolumeclaims/status"]
    verbs: ["update", "patch"]
  - apiGroups: ["storage.k8s.io"]
    resources: ["storageclasses"]
    verbs: ["get", "list", "watch"]
  - apiGroups: [""]
    resources: ["events"]
    verbs: ["list", "watch", "create", "update", "patch"]
---
# Source: truenas-csp/charts/hpe-csi-driver/templates/hpe-csi-rbac.yaml
# cluster role to support volumegroup
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: hpe-csi-volumegroup-role
rules:
  - apiGroups: ["storage.hpe.com"]
    resources: ["volumegroups"]
    verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
  - apiGroups: ["storage.hpe.com"]
    resources: ["volumegroupcontents"]
    verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
  - apiGroups: ["storage.hpe.com"]
    resources: ["volumegroupclasses"]
    verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
  - apiGroups: ["storage.hpe.com"]
    resources: ["volumegroups/status"]
    verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
  - apiGroups: ["storage.hpe.com"]
    resources: ["volumegroupcontents/status"]
    verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
  - apiGroups: [""]
    resources: ["namespaces"]
    verbs: ["get", "list", "create"]
  - apiGroups: [""]
    resources: ["persistentvolumes"]
    verbs: ["get", "list", "watch", "create", "delete"]
  - apiGroups: [""]
    resources: ["persistentvolumeclaims"]
    verbs: ["create", "get", "list", "watch", "update", "delete"]
  - apiGroups: [""]
    resources: ["persistentvolumeclaims/status"]
    verbs: ["update", "patch"]
  - apiGroups: [""]
    resources: ["events"]
    verbs: ["list", "watch", "create", "update", "patch"]
  - apiGroups: [""]
    resources: ["secrets"]
    verbs: ["get"]
  - apiGroups: ["apiextensions.k8s.io"]
    resources: ["customresourcedefinitions"]
    verbs: ["create", "list", "watch", "delete", "get", "update"]
  - apiGroups: ["coordination.k8s.io"]
    resources: ["leases"]
    verbs: ["get", "watch", "list", "delete", "update", "create"]
---
# Source: truenas-csp/charts/hpe-csi-driver/templates/hpe-csi-rbac.yaml
# cluster role to support snapshotgroup
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: hpe-csi-snapshotgroup-role
rules:
  - apiGroups: ["storage.hpe.com"]
    resources: ["snapshotgroups"]
    verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
  - apiGroups: ["storage.hpe.com"]
    resources: ["snapshotgroupcontents"]
    verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
  - apiGroups: ["storage.hpe.com"]
    resources: ["snapshotgroupclasses"]
    verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
  - apiGroups: ["storage.hpe.com"]
    resources: ["snapshotgroups/status"]
    verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
  - apiGroups: ["storage.hpe.com"]
    resources: ["snapshotgroupcontents/status"]
    verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
  - apiGroups: [""]
    resources: ["namespaces"]
    verbs: ["get", "list", "create"]
  - apiGroups: [""]
    resources: ["persistentvolumes"]
    verbs: ["get", "list", "watch", "create", "delete"]
  - apiGroups: [""]
    resources: ["persistentvolumeclaims"]
    verbs: ["create", "get", "list", "watch", "update", "delete"]
  - apiGroups: [""]
    resources: ["persistentvolumeclaims/status"]
    verbs: ["update", "patch"]
  - apiGroups: [""]
    resources: ["events"]
    verbs: ["list", "watch", "create", "update", "patch"]
  - apiGroups: [""]
    resources: ["secrets"]
    verbs: ["get"]
  - apiGroups: ["apiextensions.k8s.io"]
    resources: ["customresourcedefinitions"]
    verbs: ["create", "list", "watch", "delete", "get", "update"]
  - apiGroups: ["coordination.k8s.io"]
    resources: ["leases"]
    verbs: ["get", "watch", "list", "delete", "update", "create"]
  - apiGroups: ["storage.hpe.com"]
    resources: ["volumegroups"]
    verbs: ["get", "list", "watch"]
  - apiGroups: ["storage.hpe.com"]
    resources: ["volumegroupcontents"]
    verbs: ["get", "list", "watch"]
  - apiGroups: ["storage.hpe.com"]
    resources: ["volumegroupclasses"]
    verbs: ["get", "list", "watch"]
  - apiGroups: ["snapshot.storage.k8s.io"]
    resources: ["volumesnapshotcontents"]
    verbs: ["create", "get", "list", "watch", "update", "delete", "patch"]
  - apiGroups: ["snapshot.storage.k8s.io"]
    resources: ["volumesnapshotcontents/status"]
    verbs: ["create", "get", "list", "watch", "update", "delete", "patch"]
  - apiGroups: ["snapshot.storage.k8s.io"]
    resources: ["volumesnapshots"]
    verbs: ["create", "get", "list", "watch", "update", "delete"]
  - apiGroups: ["snapshot.storage.k8s.io"]
    resources: ["volumesnapshots/status"]
    verbs: ["update"]
  - apiGroups: ["snapshot.storage.k8s.io"]
    resources: ["volumesnapshotclasses"]
    verbs: ["get", "list"]
---
# Source: truenas-csp/charts/hpe-csi-driver/templates/hpe-csi-rbac.yaml
# mutator must be able to work with PVCs, PVs, SCs.
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: csi-mutator-role
rules:
  - apiGroups: [""]
    resources: ["secrets"]
    verbs: ["get", "list", "watch"]
  - apiGroups: [""]
    resources: ["persistentvolumes"]
    verbs: ["get", "list", "watch", "update", "patch"]
  - apiGroups: [""]
    resources: ["persistentvolumeclaims"]
    verbs: ["get", "list", "watch"]
  - apiGroups: ["storage.k8s.io"]
    resources: ["storageclasses"]
    verbs: ["get", "list", "watch"]
  - apiGroups: [""]
    resources: ["persistentvolumeclaims/status"]
    verbs: ["update", "patch"]
  - apiGroups: [""]
    resources: ["events"]
    verbs: ["list", "watch", "create", "update", "patch"]
---
# Source: truenas-csp/charts/hpe-csi-driver/templates/hpe-csi-rbac.yaml
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: hpe-csi-driver-role
rules:
  - apiGroups: ["storage.hpe.com"]
    resources: ["hpenodeinfos"]
    verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
  - apiGroups: ["storage.hpe.com"]
    resources: ["hpevolumeinfos"]
    verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
  - apiGroups: ["storage.hpe.com"]
    resources: ["hpereplicationdeviceinfos"]
    verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
  - apiGroups: ["storage.hpe.com"]
    resources: ["hpevolumegroupinfos"]
    verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
  - apiGroups: ["storage.hpe.com"]
    resources: ["hpesnapshotgroupinfos"]
    verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]    
  - apiGroups: [""]
    resources: ["pods"]
    verbs: ["get", "list"]
  - apiGroups: [""]
    resources: ["secrets"]
    verbs: ["get", "list"]
  - apiGroups: [""]
    resources: ["services"]
    verbs: ["get"]
  - apiGroups: [""]
    resources: ["persistentvolumes"]
    verbs: ["get", "list"]
  - apiGroups: [""]
    resources: ["nodes"]
    verbs: ["get", "list"]
  - apiGroups: [""]
    resources: ["persistentvolumeclaims"]
    verbs: ["get", "list"]
  - apiGroups: [""]
    resources: ["namespaces"]
    verbs: ["get", "list"]
  - apiGroups: ["storage.k8s.io"]
    resources: ["storageclasses"]
    verbs: ["get", "list", "watch"]
---
# Source: truenas-csp/charts/hpe-csi-driver/templates/hpe-csi-rbac.yaml
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: hpe-csi-provisioner-binding
subjects:
  - kind: ServiceAccount
    name: hpe-csi-controller-sa
    namespace: truenas-csp-1.1.6.tgz
roleRef:
  kind: ClusterRole
  name: hpe-csi-provisioner-role
  apiGroup: rbac.authorization.k8s.io
---
# Source: truenas-csp/charts/hpe-csi-driver/templates/hpe-csi-rbac.yaml
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: hpe-csi-attacher-binding
subjects:
  - kind: ServiceAccount
    name: hpe-csi-controller-sa
    namespace: truenas-csp-1.1.6.tgz
roleRef:
  kind: ClusterRole
  name: hpe-csi-attacher-role
  apiGroup: rbac.authorization.k8s.io
---
# Source: truenas-csp/charts/hpe-csi-driver/templates/hpe-csi-rbac.yaml
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: hpe-csi-snapshotter-binding
subjects:
  - kind: ServiceAccount
    name: hpe-csi-controller-sa
    namespace: truenas-csp-1.1.6.tgz
roleRef:
  kind: ClusterRole
  name: hpe-csi-snapshotter-role
  apiGroup: rbac.authorization.k8s.io
---
# Source: truenas-csp/charts/hpe-csi-driver/templates/hpe-csi-rbac.yaml
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: csi-resizer-role
subjects:
  - kind: ServiceAccount
    name: hpe-csi-controller-sa
    namespace: truenas-csp-1.1.6.tgz
roleRef:
  kind: ClusterRole
  name: external-resizer-role
  apiGroup: rbac.authorization.k8s.io
---
# Source: truenas-csp/charts/hpe-csi-driver/templates/hpe-csi-rbac.yaml
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: hpe-csi-volumegroup-binding
subjects:
  - kind: ServiceAccount
    name: hpe-csi-controller-sa
    namespace: truenas-csp-1.1.6.tgz
roleRef:
  kind: ClusterRole
  name: hpe-csi-volumegroup-role
  apiGroup: rbac.authorization.k8s.io
---
# Source: truenas-csp/charts/hpe-csi-driver/templates/hpe-csi-rbac.yaml
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: hpe-csi-snapshotgroup-binding
subjects:
  - kind: ServiceAccount
    name: hpe-csi-controller-sa
    namespace: truenas-csp-1.1.6.tgz
roleRef:
  kind: ClusterRole
  name: hpe-csi-snapshotgroup-role
  apiGroup: rbac.authorization.k8s.io
---
# Source: truenas-csp/charts/hpe-csi-driver/templates/hpe-csi-rbac.yaml
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: csi-mutator-binding
subjects:
  - kind: ServiceAccount
    name: hpe-csi-controller-sa
    # replace with non-default namespace name
    namespace: truenas-csp-1.1.6.tgz

roleRef:
  kind: ClusterRole
  name: csi-mutator-role
  apiGroup: rbac.authorization.k8s.io
---
# Source: truenas-csp/charts/hpe-csi-driver/templates/hpe-csi-rbac.yaml
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: hpe-csi-driver-binding
subjects:
  - kind: ServiceAccount
    name: hpe-csi-controller-sa
    namespace: truenas-csp-1.1.6.tgz
  - kind: ServiceAccount
    name: hpe-csi-node-sa
    namespace: truenas-csp-1.1.6.tgz
  - kind: ServiceAccount
    name: hpe-csp-sa
    namespace: truenas-csp-1.1.6.tgz

roleRef:
  kind: ClusterRole
  name: hpe-csi-driver-role
  apiGroup: rbac.authorization.k8s.io
---
# Source: truenas-csp/charts/hpe-csi-driver/templates/hpe-csi-rbac.yaml
# Resizer must be able to work with end point in current namespace
# if (and only if) leadership election is enabled
kind: Role
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  namespace: truenas-csp-1.1.6.tgz
  name: external-resizer-cfg
rules:
  - apiGroups: ["coordination.k8s.io"]
    resources: ["leases"]
    verbs: ["get", "watch", "list", "delete", "update", "create"]
---
# Source: truenas-csp/charts/hpe-csi-driver/templates/hpe-csi-rbac.yaml
# mutator must be able to work with end point in current namespace
# if (and only if) leadership election is enabled
kind: Role
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  namespace: truenas-csp-1.1.6.tgz
  name: csi-mutator-cfg
rules:
  - apiGroups: ["coordination.k8s.io"]
    resources: ["leases"]
    verbs: ["get", "watch", "list", "delete", "update", "create"]
---
# Source: truenas-csp/charts/hpe-csi-driver/templates/hpe-csi-rbac.yaml
kind: RoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: csi-resizer-role-cfg
  namespace: truenas-csp-1.1.6.tgz
subjects:
  - kind: ServiceAccount
    name: hpe-csi-controller-sa
    namespace: truenas-csp-1.1.6.tgz
roleRef:
  kind: Role
  name: external-resizer-cfg
  apiGroup: rbac.authorization.k8s.io
---
# Source: truenas-csp/charts/hpe-csi-driver/templates/hpe-csi-rbac.yaml
kind: RoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: csi-mutator-role-cfg
  namespace: truenas-csp-1.1.6.tgz
subjects:
  - kind: ServiceAccount
    name: hpe-csi-controller-sa
    namespace: truenas-csp-1.1.6.tgz

roleRef:
  kind: Role
  name: csi-mutator-cfg
  apiGroup: rbac.authorization.k8s.io
---
# Source: truenas-csp/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: truenas-csp-svc
  labels:
    helm.sh/chart: truenas-csp-1.1.6
    app.kubernetes.io/name: truenas-csp
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "2.4.2"
    app.kubernetes.io/managed-by: Helm
spec:
  type: ClusterIP
  ports:
    - port: 8080
      targetPort: http
      protocol: TCP
      name: http
  selector:
    app.kubernetes.io/name: truenas-csp
    app.kubernetes.io/instance: my-release
---
# Source: truenas-csp/charts/hpe-csi-driver/templates/hpe-csi-node.yaml
#######################################
############  Node driver  ############
#######################################

kind: DaemonSet
apiVersion: apps/v1
metadata:
  name: hpe-csi-node
  namespace: truenas-csp-1.1.6.tgz
spec:
  selector:
    matchLabels:
      app: hpe-csi-node
  template:
    metadata:
      labels:
        app: hpe-csi-node
        role: hpe-csi
    spec:
      serviceAccountName: hpe-csi-node-sa
      priorityClassName: system-node-critical
      hostNetwork: true
      dnsPolicy: ClusterFirstWithHostNet
      dnsConfig:
        options:
          - name: ndots
            value: "1"
      initContainers:
        - name: hpe-csi-node-init
          image: quay.io/hpestorage/csi-driver:v2.4.2
          args: ['--node-init']
          volumeMounts:
            - name: root-dir
              mountPath: /host
              mountPropagation: "Bidirectional"
            - name: device-dir
              mountPath: /dev
            - name: sys
              mountPath: /sys
            - name: etc-hpe-storage-dir
              mountPath: /etc/hpe-storage
            - name: runsystemd
              mountPath: /run/systemd
            - name: etcsystemd
              mountPath: /etc/systemd/system
          imagePullPolicy: "IfNotPresent"
          securityContext:
            privileged: true
            capabilities:
              add: ["SYS_ADMIN"]
            allowPrivilegeEscalation: true
      containers:
        - name: csi-node-driver-registrar
          image: registry.k8s.io/sig-storage/csi-node-driver-registrar:v2.10.0
          args:
            - "--csi-address=$(ADDRESS)"
            - "--kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)"
            - "--v=5"
          env:
            - name: ADDRESS
              value: /csi/csi.sock
            - name: DRIVER_REG_SOCK_PATH
              value: /var/lib/kubelet//plugins/csi.hpe.com/csi.sock
          imagePullPolicy: "IfNotPresent"
          volumeMounts:
            - name: plugin-dir
              mountPath: /csi
            - name: registration-dir
              mountPath: /registration
        - name: hpe-csi-driver
          image: quay.io/hpestorage/csi-driver:v2.4.2
          args :
            - "--endpoint=$(CSI_ENDPOINT)"
            - "--node-service"
            - "--flavor=kubernetes"
          env:
            - name: CSI_ENDPOINT
              value: unix:///csi/csi.sock
            - name: LOG_LEVEL
              value: info
            - name: NODE_NAME
              valueFrom:
                fieldRef:
                  fieldPath: spec.nodeName
            
            
            
            - name: KUBELET_ROOT_DIR
              value: /var/lib/kubelet/
            
          imagePullPolicy: "IfNotPresent"
          securityContext:
            privileged: true
            capabilities:
              add: ["SYS_ADMIN"]
            allowPrivilegeEscalation: true
          volumeMounts:
            - name: plugin-dir
              mountPath: /csi
            - name: pods-mount-dir
              mountPath:  /var/lib/kubelet/
              # needed so that any mounts setup inside this container are
              # propagated back to the host machine.
              mountPropagation: "Bidirectional"
            - name: root-dir
              mountPath: /host
              mountPropagation: "Bidirectional"
            - name: device-dir
              mountPath: /dev
            - name: log-dir
              mountPath: /var/log
            - name: etc-hpe-storage-dir
              mountPath: /etc/hpe-storage
            - name: etc-kubernetes
              mountPath: /etc/kubernetes
            - name: sys
              mountPath: /sys
            - name: runsystemd
              mountPath: /run/systemd
            - name: etcsystemd
              mountPath: /etc/systemd/system
            - name: linux-config-file
              mountPath: /opt/hpe-storage/nimbletune/config.json
              subPath: config.json
      volumes:
        - name: registration-dir
          hostPath:
          
            path: /var/lib/kubelet//plugins_registry
            type: Directory
        - name: plugin-dir
          hostPath:
          
            path: /var/lib/kubelet//plugins/csi.hpe.com
            type: DirectoryOrCreate
        - name: pods-mount-dir
          hostPath:
          
            path: /var/lib/kubelet/
        - name: root-dir
          hostPath:
            path: /
        - name: device-dir
          hostPath:
            path: /dev
        - name: log-dir
          hostPath:
            path: /var/log
        - name: etc-hpe-storage-dir
          hostPath:
            path: /etc/hpe-storage
        - name: etc-kubernetes
          hostPath:
            path: /etc/kubernetes
        - name: runsystemd
          hostPath:
            path: /run/systemd
        - name: etcsystemd
          hostPath:
            path: /etc/systemd/system
        - name: sys
          hostPath:
            path: /sys
        - name: linux-config-file
          configMap:
            name: hpe-linux-config
      tolerations:
        - effect: NoSchedule
          key: csi.hpe.com/hpe-nfs
          operator: Exists
---
# Source: truenas-csp/charts/hpe-csi-driver/templates/hpe-csi-controller.yaml
#############################################
############  Controller driver  ############
#############################################

kind: Deployment
apiVersion: apps/v1
metadata:
  name: hpe-csi-controller
  namespace: truenas-csp-1.1.6.tgz
spec:
  replicas: 1
  selector:
    matchLabels:
      app: hpe-csi-controller
  template:
    metadata:
      labels:
        app: hpe-csi-controller
        role: hpe-csi
    spec:
      serviceAccountName: hpe-csi-controller-sa
      priorityClassName: system-cluster-critical
      hostNetwork: true
      dnsPolicy: ClusterFirstWithHostNet
      dnsConfig:
        options:
          - name: ndots
            value: "1"
      containers:
        - name: csi-provisioner
          image: registry.k8s.io/sig-storage/csi-provisioner:v4.0.0
          args:
            - "--csi-address=$(ADDRESS)"
            - "--v=5"
            - "--extra-create-metadata"
            - "--timeout=30s"
            - "--worker-threads=16"
          env:
            - name: ADDRESS
              value: /var/lib/csi/sockets/pluginproxy/csi.sock
          imagePullPolicy: "IfNotPresent"
          volumeMounts:
            - name: socket-dir
              mountPath: /var/lib/csi/sockets/pluginproxy
        - name: csi-attacher
          image: registry.k8s.io/sig-storage/csi-attacher:v4.5.0
          args:
            - "--v=5"
            - "--csi-address=$(ADDRESS)"
          env:
            - name: ADDRESS
              value: /var/lib/csi/sockets/pluginproxy/csi.sock
          imagePullPolicy: "IfNotPresent"
          volumeMounts:
            - name: socket-dir
              mountPath: /var/lib/csi/sockets/pluginproxy
        - name: csi-snapshotter
          image: registry.k8s.io/sig-storage/csi-snapshotter:v6.3.3
          args:
            - "--v=5"
            - "--csi-address=$(ADDRESS)"
          env:
            - name: ADDRESS
              value: /var/lib/csi/sockets/pluginproxy/csi.sock
          imagePullPolicy: "IfNotPresent"
          volumeMounts:
            - name: socket-dir
              mountPath: /var/lib/csi/sockets/pluginproxy/
        - name: csi-resizer
          image: registry.k8s.io/sig-storage/csi-resizer:v1.9.3
          args:
            - "--csi-address=$(ADDRESS)"
            - "--v=5"
          env:
            - name: ADDRESS
              value: /var/lib/csi/sockets/pluginproxy/csi.sock
          imagePullPolicy: "IfNotPresent"
          volumeMounts:
            - name: socket-dir
              mountPath: /var/lib/csi/sockets/pluginproxy
        - name: hpe-csi-driver
          image: quay.io/hpestorage/csi-driver:v2.4.2
          args :
            - "--endpoint=$(CSI_ENDPOINT)"
            - "--flavor=kubernetes"
            - "--pod-monitor"
            - "--pod-monitor-interval=30"
          env:
            - name: CSI_ENDPOINT
              value: unix:///var/lib/csi/sockets/pluginproxy/csi.sock
            - name: LOG_LEVEL
              value: info
          imagePullPolicy: "IfNotPresent"
          volumeMounts:
            - name: socket-dir
              mountPath: /var/lib/csi/sockets/pluginproxy
            - name: log-dir
              mountPath: /var/log
            - name: k8s
              mountPath: /etc/kubernetes
            - name: hpeconfig
              mountPath: /etc/hpe-storage
            - name: root-dir
              mountPath: /host
        - name: csi-volume-mutator
          image: quay.io/hpestorage/volume-mutator:v1.3.5
          args:
            - "--v=5"
            - "--csi-address=$(ADDRESS)"
          env:
            - name: ADDRESS
              value: /var/lib/csi/sockets/pluginproxy/csi-extensions.sock
          imagePullPolicy: "IfNotPresent"
          volumeMounts:
            - name: socket-dir
              mountPath: /var/lib/csi/sockets/pluginproxy/
        - name: csi-volume-group-snapshotter
          image: quay.io/hpestorage/volume-group-snapshotter:v1.0.5
          args:
            - "--v=5"
            - "--csi-address=$(ADDRESS)"
          env:
            - name: ADDRESS
              value: /var/lib/csi/sockets/pluginproxy/csi-extensions.sock
          imagePullPolicy: "IfNotPresent"
          volumeMounts:
            - name: socket-dir
              mountPath: /var/lib/csi/sockets/pluginproxy/
        - name: csi-volume-group-provisioner
          image: quay.io/hpestorage/volume-group-provisioner:v1.0.5
          args:
            - "--v=5"
            - "--csi-address=$(ADDRESS)"
          env:
            - name: ADDRESS
              value: /var/lib/csi/sockets/pluginproxy/csi-extensions.sock
          imagePullPolicy: "IfNotPresent"
          volumeMounts:
            - name: socket-dir
              mountPath: /var/lib/csi/sockets/pluginproxy/
        - name: csi-extensions
          image: quay.io/hpestorage/csi-extensions:v1.2.6
          args:
            - "--v=5"
            - "--endpoint=$(CSI_ENDPOINT)"
          env:
            - name: CSI_ENDPOINT
              value: unix:///var/lib/csi/sockets/pluginproxy/csi-extensions.sock
            - name: LOG_LEVEL
              value: info
          imagePullPolicy: "IfNotPresent"
          volumeMounts:
            - name: socket-dir
              mountPath: /var/lib/csi/sockets/pluginproxy/
      volumes:
        - name: socket-dir
          emptyDir: {}
        - name: log-dir
          hostPath:
            path: /var/log
        - name: k8s
          hostPath:
            path: /etc/kubernetes
        - name: hpeconfig
          hostPath:
            path: /etc/hpe-storage
        - name: root-dir
          hostPath:
            path: /
---
# Source: truenas-csp/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: truenas-csp
  labels:
    helm.sh/chart: truenas-csp-1.1.6
    app.kubernetes.io/name: truenas-csp
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "2.4.2"
    app.kubernetes.io/managed-by: Helm
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: truenas-csp
      app.kubernetes.io/instance: my-release
  template:
    metadata:
      labels:
        app.kubernetes.io/name: truenas-csp
        app.kubernetes.io/instance: my-release
    spec:
      serviceAccountName: my-release-truenas-csp
      securityContext:
        {}
      containers:
        - name: truenas-csp
          securityContext:
            {}
          image: quay.io/datamattsson/truenas-csp:v2.4.2
          imagePullPolicy: IfNotPresent
          
          
          ports:
            - name: http
              containerPort: 8080
              protocol: TCP
          readinessProbe:
            tcpSocket:
              port: 8080
            initialDelaySeconds: 5
            periodSeconds: 10
          livenessProbe:
            tcpSocket:
              port: 8080
            initialDelaySeconds: 15
            periodSeconds: 20
          resources:
            limits:
              cpu: 1000m
              memory: 1Gi
            requests:
              cpu: 100m
              memory: 256Mi
      tolerations:
        - effect: NoExecute
          key: node.kubernetes.io/not-ready
          operator: Exists
          tolerationSeconds: 30
        - effect: NoExecute
          key: node.kubernetes.io/unreachable
          operator: Exists
          tolerationSeconds: 30
---
# Source: truenas-csp/charts/hpe-csi-driver/templates/csi-driver-crd.yaml
################# CSI Driver ###########
apiVersion: storage.k8s.io/v1
kind: CSIDriver
metadata:
  name: csi.hpe.com
spec:
  podInfoOnMount: true
  volumeLifecycleModes:
  - Persistent
  - Ephemeral
