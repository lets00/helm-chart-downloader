---
# Source: victoria-metrics-k8s-stack/charts/grafana/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
automountServiceAccountToken: false
metadata:
  labels:
    helm.sh/chart: grafana-7.3.12
    app.kubernetes.io/name: grafana
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "10.4.3"
    app.kubernetes.io/managed-by: Helm
  name: my-release-grafana
  namespace: default
---
# Source: victoria-metrics-k8s-stack/charts/kube-state-metrics/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:    
    helm.sh/chart: kube-state-metrics-5.16.4
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: metrics
    app.kubernetes.io/part-of: kube-state-metrics
    app.kubernetes.io/name: kube-state-metrics
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "2.10.1"
  name: my-release-kube-state-metrics
  namespace: default
---
# Source: victoria-metrics-k8s-stack/charts/prometheus-node-exporter/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: my-release-prometheus-node-exporter
  namespace: default
  labels:
    helm.sh/chart: prometheus-node-exporter-4.27.0
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: metrics
    app.kubernetes.io/part-of: prometheus-node-exporter
    app.kubernetes.io/name: prometheus-node-exporter
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "1.7.0"
    jobLabel: node-exporter
---
# Source: victoria-metrics-k8s-stack/charts/victoria-metrics-operator/templates/service_account.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: my-release-victoria-metrics-operator
  namespace: default
  labels:
    app.kubernetes.io/name: victoria-metrics-operator
    app.kubernetes.io/instance: my-release
    helm.sh/chart: victoria-metrics-operator-0.32.0
    app.kubernetes.io/managed-by: Helm
---
# Source: victoria-metrics-k8s-stack/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: my-release-victoria-metrics-k8s-stack
  labels:
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
---
# Source: victoria-metrics-k8s-stack/charts/grafana/templates/secret.yaml
apiVersion: v1
kind: Secret
metadata:
  name: my-release-grafana
  namespace: default
  labels:
    helm.sh/chart: grafana-7.3.12
    app.kubernetes.io/name: grafana
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "10.4.3"
    app.kubernetes.io/managed-by: Helm
type: Opaque
data:
  
  admin-user: "YWRtaW4="
  admin-password: "WTVweUkzRDVsRlBkc3Y5eEJJdzBLY0M2WTNkWkowZDhlendaWVZBQg=="
  ldap-toml: ""
---
# Source: victoria-metrics-k8s-stack/templates/victoria-metrics-operator/alertmanager/vmalertmanager.yaml
apiVersion: v1
kind: Secret
metadata:
  name: my-release-victoria-metrics-k8s-stack-alertmanager
  namespace: default
  labels: 
    app.kubernetes.io/component: victoria-metrics-k8s-stack-alertmanager
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
stringData:
  alertmanager.yaml: "receivers:\n- name: blackhole\nroute:\n  receiver: blackhole\ntemplates:\n- /etc/vm/configs/**/*.tmpl"
---
# Source: victoria-metrics-k8s-stack/charts/grafana/templates/configmap-dashboard-provider.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    helm.sh/chart: grafana-7.3.12
    app.kubernetes.io/name: grafana
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "10.4.3"
    app.kubernetes.io/managed-by: Helm
  name: my-release-grafana-config-dashboards
  namespace: default
data:
  provider.yaml: |-
    apiVersion: 1
    providers:
      - name: 'sidecarProvider'
        orgId: 1
        folder: ''
        type: file
        disableDeletion: false
        allowUiUpdates: false
        updateIntervalSeconds: 30
        options:
          foldersFromFilesStructure: false
          path: /tmp/dashboards
---
# Source: victoria-metrics-k8s-stack/charts/grafana/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: my-release-grafana
  namespace: default
  labels:
    helm.sh/chart: grafana-7.3.12
    app.kubernetes.io/name: grafana
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "10.4.3"
    app.kubernetes.io/managed-by: Helm
data:
  
  grafana.ini: |
    [analytics]
    check_for_updates = true
    [grafana_net]
    url = https://grafana.net
    [log]
    mode = console
    [paths]
    data = /var/lib/grafana/
    logs = /var/log/grafana
    plugins = /var/lib/grafana/plugins
    provisioning = /etc/grafana/provisioning
    [server]
    domain = ''
  dashboardproviders.yaml: |
    apiVersion: 1
    providers:
    - disableDeletion: false
      editable: true
      folder: ""
      name: default
      options:
        path: /var/lib/grafana/dashboards/default
      orgId: 1
      type: file
  download_dashboards.sh: |
    #!/usr/bin/env sh
    set -euf
    mkdir -p /var/lib/grafana/dashboards/default
  
    curl -skf \
    --connect-timeout 60 \
    --max-time 60 \
    -H "Accept: application/json" \
    -H "Content-Type: application/json;charset=UTF-8" \
      "https://grafana.com/api/dashboards/1860/revisions/22/download" \
      | sed '/-- .* --/! s/"datasource":.*,/"datasource": "VictoriaMetrics",/g' \
    > "/var/lib/grafana/dashboards/default/nodeexporter.json"
---
# Source: victoria-metrics-k8s-stack/charts/grafana/templates/dashboards-json-configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: my-release-grafana-dashboards-default
  namespace: default
  labels:
    helm.sh/chart: grafana-7.3.12
    app.kubernetes.io/name: grafana
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "10.4.3"
    app.kubernetes.io/managed-by: Helm
    dashboard-provider: default
    grafana_dashboard: ""
data:
  {}
---
# Source: victoria-metrics-k8s-stack/templates/grafana/dashboards/alertmanager-overview.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-alertmanager-overview
  labels:
    grafana_dashboard: "1"
    app: victoria-metrics-k8s-stack-grafana
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
data:
  alertmanager-overview.json:  |-
    {
        "__inputs": [

        ],
        "__requires": [

        ],
        "annotations": {
            "list": [

            ]
        },
        "editable": false,
        "gnetId": null,
        "graphTooltip": 1,
        "hideControls": false,
        "id": null,
        "links": [

        ],
        "refresh": "30s",
        "rows": [
            {
                "collapse": false,
                "collapsed": false,
                "panels": [
                    {
                        "aliasColors": {

                        },
                        "bars": false,
                        "dashLength": 10,
                        "dashes": false,
                        "datasource": "$datasource",
                        "description": "current set of alerts stored in the Alertmanager",
                        "fill": 1,
                        "fillGradient": 0,
                        "gridPos": {

                        },
                        "id": 2,
                        "legend": {
                            "alignAsTable": false,
                            "avg": false,
                            "current": false,
                            "max": false,
                            "min": false,
                            "rightSide": false,
                            "show": false,
                            "sideWidth": null,
                            "total": false,
                            "values": false
                        },
                        "lines": true,
                        "linewidth": 1,
                        "links": [

                        ],
                        "nullPointMode": "null",
                        "percentage": false,
                        "pointradius": 5,
                        "points": false,
                        "renderer": "flot",
                        "repeat": null,
                        "seriesOverrides": [

                        ],
                        "spaceLength": 10,
                        "span": 6,
                        "stack": true,
                        "steppedLine": false,
                        "targets": [
                            {
                                "expr": "sum(alertmanager_alerts{namespace=~\"$namespace\",service=~\"$service\"}) by (namespace,service,instance)",
                                "format": "time_series",
                                "intervalFactor": 2,
                                "legendFormat": "{{instance}}",
                                "refId": "A"
                            }
                        ],
                        "thresholds": [

                        ],
                        "timeFrom": null,
                        "timeShift": null,
                        "title": "Alerts",
                        "tooltip": {
                            "shared": true,
                            "sort": 0,
                            "value_type": "individual"
                        },
                        "type": "graph",
                        "xaxis": {
                            "buckets": null,
                            "mode": "time",
                            "name": null,
                            "show": true,
                            "values": [

                            ]
                        },
                        "yaxes": [
                            {
                                "format": "none",
                                "label": null,
                                "logBase": 1,
                                "max": null,
                                "min": null,
                                "show": true
                            },
                            {
                                "format": "none",
                                "label": null,
                                "logBase": 1,
                                "max": null,
                                "min": null,
                                "show": true
                            }
                        ]
                    },
                    {
                        "aliasColors": {

                        },
                        "bars": false,
                        "dashLength": 10,
                        "dashes": false,
                        "datasource": "$datasource",
                        "description": "rate of successful and invalid alerts received by the Alertmanager",
                        "fill": 1,
                        "fillGradient": 0,
                        "gridPos": {

                        },
                        "id": 3,
                        "legend": {
                            "alignAsTable": false,
                            "avg": false,
                            "current": false,
                            "max": false,
                            "min": false,
                            "rightSide": false,
                            "show": false,
                            "sideWidth": null,
                            "total": false,
                            "values": false
                        },
                        "lines": true,
                        "linewidth": 1,
                        "links": [

                        ],
                        "nullPointMode": "null",
                        "percentage": false,
                        "pointradius": 5,
                        "points": false,
                        "renderer": "flot",
                        "repeat": null,
                        "seriesOverrides": [

                        ],
                        "spaceLength": 10,
                        "span": 6,
                        "stack": true,
                        "steppedLine": false,
                        "targets": [
                            {
                                "expr": "sum(rate(alertmanager_alerts_received_total{namespace=~\"$namespace\",service=~\"$service\"}[$__rate_interval])) by (namespace,service,instance)",
                                "format": "time_series",
                                "intervalFactor": 2,
                                "legendFormat": "{{instance}} Received",
                                "refId": "A"
                            },
                            {
                                "expr": "sum(rate(alertmanager_alerts_invalid_total{namespace=~\"$namespace\",service=~\"$service\"}[$__rate_interval])) by (namespace,service,instance)",
                                "format": "time_series",
                                "intervalFactor": 2,
                                "legendFormat": "{{instance}} Invalid",
                                "refId": "B"
                            }
                        ],
                        "thresholds": [

                        ],
                        "timeFrom": null,
                        "timeShift": null,
                        "title": "Alerts receive rate",
                        "tooltip": {
                            "shared": true,
                            "sort": 0,
                            "value_type": "individual"
                        },
                        "type": "graph",
                        "xaxis": {
                            "buckets": null,
                            "mode": "time",
                            "name": null,
                            "show": true,
                            "values": [

                            ]
                        },
                        "yaxes": [
                            {
                                "format": "ops",
                                "label": null,
                                "logBase": 1,
                                "max": null,
                                "min": null,
                                "show": true
                            },
                            {
                                "format": "ops",
                                "label": null,
                                "logBase": 1,
                                "max": null,
                                "min": null,
                                "show": true
                            }
                        ]
                    }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Alerts",
                "titleSize": "h6",
                "type": "row"
            },
            {
                "collapse": false,
                "collapsed": false,
                "panels": [
                    {
                        "aliasColors": {

                        },
                        "bars": false,
                        "dashLength": 10,
                        "dashes": false,
                        "datasource": "$datasource",
                        "description": "rate of successful and invalid notifications sent by the Alertmanager",
                        "fill": 1,
                        "fillGradient": 0,
                        "gridPos": {

                        },
                        "id": 4,
                        "legend": {
                            "alignAsTable": false,
                            "avg": false,
                            "current": false,
                            "max": false,
                            "min": false,
                            "rightSide": false,
                            "show": false,
                            "sideWidth": null,
                            "total": false,
                            "values": false
                        },
                        "lines": true,
                        "linewidth": 1,
                        "links": [

                        ],
                        "nullPointMode": "null",
                        "percentage": false,
                        "pointradius": 5,
                        "points": false,
                        "renderer": "flot",
                        "repeat": "integration",
                        "seriesOverrides": [

                        ],
                        "spaceLength": 10,
                        "stack": true,
                        "steppedLine": false,
                        "targets": [
                            {
                                "expr": "sum(rate(alertmanager_notifications_total{namespace=~\"$namespace\",service=~\"$service\", integration=\"$integration\"}[$__rate_interval])) by (integration,namespace,service,instance)",
                                "format": "time_series",
                                "intervalFactor": 2,
                                "legendFormat": "{{instance}} Total",
                                "refId": "A"
                            },
                            {
                                "expr": "sum(rate(alertmanager_notifications_failed_total{namespace=~\"$namespace\",service=~\"$service\", integration=\"$integration\"}[$__rate_interval])) by (integration,namespace,service,instance)",
                                "format": "time_series",
                                "intervalFactor": 2,
                                "legendFormat": "{{instance}} Failed",
                                "refId": "B"
                            }
                        ],
                        "thresholds": [

                        ],
                        "timeFrom": null,
                        "timeShift": null,
                        "title": "$integration: Notifications Send Rate",
                        "tooltip": {
                            "shared": true,
                            "sort": 0,
                            "value_type": "individual"
                        },
                        "type": "graph",
                        "xaxis": {
                            "buckets": null,
                            "mode": "time",
                            "name": null,
                            "show": true,
                            "values": [

                            ]
                        },
                        "yaxes": [
                            {
                                "format": "ops",
                                "label": null,
                                "logBase": 1,
                                "max": null,
                                "min": null,
                                "show": true
                            },
                            {
                                "format": "ops",
                                "label": null,
                                "logBase": 1,
                                "max": null,
                                "min": null,
                                "show": true
                            }
                        ]
                    },
                    {
                        "aliasColors": {

                        },
                        "bars": false,
                        "dashLength": 10,
                        "dashes": false,
                        "datasource": "$datasource",
                        "description": "latency of notifications sent by the Alertmanager",
                        "fill": 1,
                        "fillGradient": 0,
                        "gridPos": {

                        },
                        "id": 5,
                        "legend": {
                            "alignAsTable": false,
                            "avg": false,
                            "current": false,
                            "max": false,
                            "min": false,
                            "rightSide": false,
                            "show": false,
                            "sideWidth": null,
                            "total": false,
                            "values": false
                        },
                        "lines": true,
                        "linewidth": 1,
                        "links": [

                        ],
                        "nullPointMode": "null",
                        "percentage": false,
                        "pointradius": 5,
                        "points": false,
                        "renderer": "flot",
                        "repeat": "integration",
                        "seriesOverrides": [

                        ],
                        "spaceLength": 10,
                        "stack": false,
                        "steppedLine": false,
                        "targets": [
                            {
                                "expr": "histogram_quantile(0.99,\n  sum(rate(alertmanager_notification_latency_seconds_bucket{namespace=~\"$namespace\",service=~\"$service\", integration=\"$integration\"}[$__rate_interval])) by (le,namespace,service,instance)\n) \n",
                                "format": "time_series",
                                "intervalFactor": 2,
                                "legendFormat": "{{instance}} 99th Percentile",
                                "refId": "A"
                            },
                            {
                                "expr": "histogram_quantile(0.50,\n  sum(rate(alertmanager_notification_latency_seconds_bucket{namespace=~\"$namespace\",service=~\"$service\", integration=\"$integration\"}[$__rate_interval])) by (le,namespace,service,instance)\n) \n",
                                "format": "time_series",
                                "intervalFactor": 2,
                                "legendFormat": "{{instance}} Median",
                                "refId": "B"
                            },
                            {
                                "expr": "sum(rate(alertmanager_notification_latency_seconds_sum{namespace=~\"$namespace\",service=~\"$service\", integration=\"$integration\"}[$__rate_interval])) by (namespace,service,instance)\n/\nsum(rate(alertmanager_notification_latency_seconds_count{namespace=~\"$namespace\",service=~\"$service\", integration=\"$integration\"}[$__rate_interval])) by (namespace,service,instance)\n",
                                "format": "time_series",
                                "intervalFactor": 2,
                                "legendFormat": "{{instance}} Average",
                                "refId": "C"
                            }
                        ],
                        "thresholds": [

                        ],
                        "timeFrom": null,
                        "timeShift": null,
                        "title": "$integration: Notification Duration",
                        "tooltip": {
                            "shared": true,
                            "sort": 0,
                            "value_type": "individual"
                        },
                        "type": "graph",
                        "xaxis": {
                            "buckets": null,
                            "mode": "time",
                            "name": null,
                            "show": true,
                            "values": [

                            ]
                        },
                        "yaxes": [
                            {
                                "format": "s",
                                "label": null,
                                "logBase": 1,
                                "max": null,
                                "min": null,
                                "show": true
                            },
                            {
                                "format": "s",
                                "label": null,
                                "logBase": 1,
                                "max": null,
                                "min": null,
                                "show": true
                            }
                        ]
                    }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Notifications",
                "titleSize": "h6",
                "type": "row"
            }
        ],
        "schemaVersion": 14,
        "style": "dark",
        "tags": [
            "alertmanager-mixin",
            "vm-k8s-stack"
        ],
        "templating": {
            "list": [
                {
                    "current": {
                        "text": "Prometheus",
                        "value": "Prometheus"
                    },
                    "hide": 0,
                    "label": "Data Source",
                    "name": "datasource",
                    "options": [

                    ],
                    "query": "prometheus",
                    "refresh": 1,
                    "regex": "",
                    "type": "datasource"
                },
                {
                    "allValue": null,
                    "current": {
                        "text": "",
                        "value": ""
                    },
                    "datasource": "$datasource",
                    "hide": 0,
                    "includeAll": false,
                    "label": "namespace",
                    "multi": false,
                    "name": "namespace",
                    "options": [

                    ],
                    "query": "label_values(alertmanager_alerts, namespace)",
                    "refresh": 2,
                    "regex": "",
                    "sort": 1,
                    "tagValuesQuery": "",
                    "tags": [

                    ],
                    "tagsQuery": "",
                    "type": "query",
                    "useTags": false
                },
                {
                    "allValue": null,
                    "current": {
                        "text": "",
                        "value": ""
                    },
                    "datasource": "$datasource",
                    "hide": 0,
                    "includeAll": false,
                    "label": "service",
                    "multi": false,
                    "name": "service",
                    "options": [

                    ],
                    "query": "label_values(alertmanager_alerts, service)",
                    "refresh": 2,
                    "regex": "",
                    "sort": 1,
                    "tagValuesQuery": "",
                    "tags": [

                    ],
                    "tagsQuery": "",
                    "type": "query",
                    "useTags": false
                },
                {
                    "allValue": null,
                    "current": {
                        "text": "all",
                        "value": "$__all"
                    },
                    "datasource": "$datasource",
                    "hide": 2,
                    "includeAll": true,
                    "label": null,
                    "multi": false,
                    "name": "integration",
                    "options": [

                    ],
                    "query": "label_values(alertmanager_notifications_total{integration=~\".*\"}, integration)",
                    "refresh": 2,
                    "regex": "",
                    "sort": 1,
                    "tagValuesQuery": "",
                    "tags": [

                    ],
                    "tagsQuery": "",
                    "type": "query",
                    "useTags": false
                }
            ]
        },
        "time": {
            "from": "now-1h",
            "to": "now"
        },
        "timepicker": {
            "refresh_intervals": [
                "5s",
                "10s",
                "30s",
                "1m",
                "5m",
                "15m",
                "30m",
                "1h",
                "2h",
                "1d"
            ],
            "time_options": [
                "5m",
                "15m",
                "1h",
                "6h",
                "12h",
                "24h",
                "2d",
                "7d",
                "30d"
            ]
        },
        "timezone": "utc",
        "title": "Alertmanager / Overview",
        "uid": "alertmanager-overview",
        "version": 0
    }
---
# Source: victoria-metrics-k8s-stack/templates/grafana/dashboards/backupmanager.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-backupmanager
  labels:
    grafana_dashboard: "1"
    app: victoria-metrics-k8s-stack-grafana
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
data:
  backupmanager.json:  |-
    {
        "__inputs": [],
        "__elements": {},
        "__requires": [
            {
                "type": "panel",
                "id": "barchart",
                "name": "Bar chart",
                "version": ""
            },
            {
                "type": "grafana",
                "id": "grafana",
                "name": "Grafana",
                "version": "10.4.0"
            },
            {
                "type": "datasource",
                "id": "prometheus",
                "name": "Prometheus",
                "version": "1.0.0"
            },
            {
                "type": "panel",
                "id": "stat",
                "name": "Stat",
                "version": ""
            },
            {
                "type": "panel",
                "id": "table",
                "name": "Table",
                "version": ""
            },
            {
                "type": "panel",
                "id": "timeseries",
                "name": "Time series",
                "version": ""
            }
        ],
        "annotations": {
            "list": [
                {
                    "builtIn": 1,
                    "datasource": {
                        "type": "grafana",
                        "uid": "-- Grafana --"
                    },
                    "enable": true,
                    "hide": true,
                    "iconColor": "rgba(0, 211, 255, 1)",
                    "name": "Annotations & Alerts",
                    "target": {
                        "limit": 100,
                        "matchAny": false,
                        "tags": [],
                        "type": "dashboard"
                    },
                    "type": "dashboard"
                }
            ]
        },
        "description": "Overview for VictoriaMetrics backupmanager v1.85.3 or higher",
        "editable": false,
        "fiscalYearStartMonth": 0,
        "graphTooltip": 0,
        "id": null,
        "links": [],
        "liveNow": false,
        "panels": [
            {
                "collapsed": false,
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 0
                },
                "id": 10,
                "panels": [],
                "title": "Stats",
                "type": "row"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "thresholds"
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                }
                            ]
                        }
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 5,
                    "w": 3,
                    "x": 0,
                    "y": 1
                },
                "id": 32,
                "options": {
                    "colorMode": "value",
                    "graphMode": "area",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "lastNotNull"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "count(vm_app_version{job=~\"$job\", instance=~\"$instance\", version=~\"^vmbackupmanager.+\" })",
                        "instant": true,
                        "legendFormat": "__auto",
                        "range": false,
                        "refId": "A"
                    }
                ],
                "title": "Instances",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Status of last backup operation.",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "thresholds"
                        },
                        "mappings": [
                            {
                                "options": {
                                    "0": {
                                        "index": 0,
                                        "text": "Success"
                                    }
                                },
                                "type": "value"
                            }
                        ],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                }
                            ]
                        }
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 5,
                    "w": 4,
                    "x": 3,
                    "y": 1
                },
                "id": 2,
                "options": {
                    "colorMode": "value",
                    "graphMode": "area",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "lastNotNull"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(vm_backup_last_run_failed)",
                        "legendFormat": "__auto",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Last backup status",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Number of backups stored in remote storage.",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "thresholds"
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                }
                            ]
                        }
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 5,
                    "w": 3,
                    "x": 7,
                    "y": 1
                },
                "id": 6,
                "options": {
                    "colorMode": "value",
                    "graphMode": "area",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "lastNotNull"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(vm_backups_stored{job=~\"$job\", instance=~\"$instance\"})",
                        "legendFormat": "__auto",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Total backups stored",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Space used in remote storage.",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "thresholds"
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                }
                            ]
                        },
                        "unit": "decbytes"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 5,
                    "w": 3,
                    "x": 10,
                    "y": 1
                },
                "id": 27,
                "options": {
                    "colorMode": "value",
                    "graphMode": "area",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "lastNotNull"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(vm_backups_size_bytes{job=~\"$job\", instance=~\"$instance\"})",
                        "legendFormat": "__auto",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Backups size",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "thresholds"
                        },
                        "mappings": [
                            {
                                "options": {
                                    "0": {
                                        "index": 0,
                                        "text": "No errors"
                                    }
                                },
                                "type": "value"
                            }
                        ],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 1
                                }
                            ]
                        }
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 5,
                    "w": 3,
                    "x": 13,
                    "y": 1
                },
                "id": 7,
                "options": {
                    "colorMode": "value",
                    "graphMode": "area",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "lastNotNull"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(increase(vm_backup_errors_total{job=~\"$job\", instance=~\"$instance\"}[1h]))",
                        "legendFormat": "__auto",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Backups errors ",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Status of last retention run.\n\nRetention is a process of removing old backups from remote storage.",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "thresholds"
                        },
                        "mappings": [
                            {
                                "options": {
                                    "0": {
                                        "index": 0,
                                        "text": "Success"
                                    }
                                },
                                "type": "value"
                            }
                        ],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                }
                            ]
                        }
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 5,
                    "w": 4,
                    "x": 16,
                    "y": 1
                },
                "id": 5,
                "options": {
                    "colorMode": "value",
                    "graphMode": "area",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "lastNotNull"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(vm_retention_last_run_failed)",
                        "legendFormat": "__auto",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Last retention status",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "thresholds"
                        },
                        "mappings": [
                            {
                                "options": {
                                    "0": {
                                        "index": 0,
                                        "text": "No errors"
                                    }
                                },
                                "type": "value"
                            }
                        ],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 1
                                }
                            ]
                        }
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 5,
                    "w": 4,
                    "x": 20,
                    "y": 1
                },
                "id": 8,
                "options": {
                    "colorMode": "value",
                    "graphMode": "area",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "lastNotNull"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(increase(vm_retention_errors_total{job=~\"$job\", instance=~\"$instance\"}[1h]))",
                        "legendFormat": "__auto",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Retention errors",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "thresholds"
                        },
                        "custom": {
                            "align": "auto",
                            "cellOptions": {
                                "type": "auto"
                            },
                            "inspect": false
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        }
                    },
                    "overrides": [
                        {
                            "matcher": {
                                "id": "byName",
                                "options": "name"
                            },
                            "properties": [
                                {
                                    "id": "custom.width",
                                    "value": 148
                                }
                            ]
                        },
                        {
                            "matcher": {
                                "id": "byName",
                                "options": "value"
                            },
                            "properties": [
                                {
                                    "id": "custom.width",
                                    "value": 101
                                }
                            ]
                        }
                    ]
                },
                "gridPos": {
                    "h": 6,
                    "w": 12,
                    "x": 0,
                    "y": 6
                },
                "id": 22,
                "options": {
                    "cellHeight": "sm",
                    "footer": {
                        "countRows": false,
                        "fields": "",
                        "reducer": [
                            "sum"
                        ],
                        "show": false
                    },
                    "showHeader": true,
                    "sortBy": [
                        {
                            "desc": false,
                            "displayName": "name"
                        }
                    ]
                },
                "pluginVersion": "10.4.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "sum(flag{job=~\"$job\", instance=~\"$instance\",name=~\"disableDaily|disableHourly|disableWeekly|disableMonthly\"}) by (name, value, instance)",
                        "format": "table",
                        "instant": true,
                        "legendFormat": "",
                        "range": false,
                        "refId": "A"
                    }
                ],
                "title": "Backups configuration",
                "transformations": [
                    {
                        "id": "groupBy",
                        "options": {
                            "fields": {
                                "instance": {
                                    "aggregations": [
                                        "uniqueValues"
                                    ],
                                    "operation": "aggregate"
                                },
                                "name": {
                                    "aggregations": [],
                                    "operation": "groupby"
                                },
                                "value": {
                                    "aggregations": [],
                                    "operation": "groupby"
                                }
                            }
                        }
                    }
                ],
                "type": "table"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "thresholds"
                        },
                        "custom": {
                            "align": "auto",
                            "cellOptions": {
                                "type": "auto"
                            },
                            "inspect": false
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        }
                    },
                    "overrides": [
                        {
                            "matcher": {
                                "id": "byName",
                                "options": "value"
                            },
                            "properties": [
                                {
                                    "id": "custom.width",
                                    "value": 100
                                }
                            ]
                        },
                        {
                            "matcher": {
                                "id": "byName",
                                "options": "name"
                            },
                            "properties": [
                                {
                                    "id": "custom.width",
                                    "value": 150
                                }
                            ]
                        }
                    ]
                },
                "gridPos": {
                    "h": 6,
                    "w": 12,
                    "x": 12,
                    "y": 6
                },
                "id": 21,
                "options": {
                    "cellHeight": "sm",
                    "footer": {
                        "countRows": false,
                        "fields": "",
                        "reducer": [
                            "sum"
                        ],
                        "show": false
                    },
                    "showHeader": true,
                    "sortBy": [
                        {
                            "desc": false,
                            "displayName": "name"
                        }
                    ]
                },
                "pluginVersion": "10.4.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "sum(flag{job=~\"$job\", instance=~\"$instance\",name=~\"keep(.*)\", is_set=\"true\"}) by (name, value, instance)",
                        "format": "table",
                        "instant": true,
                        "legendFormat": "",
                        "range": false,
                        "refId": "A"
                    }
                ],
                "title": "Retention configuration",
                "transformations": [
                    {
                        "id": "groupBy",
                        "options": {
                            "fields": {
                                "instance": {
                                    "aggregations": [
                                        "uniqueValues"
                                    ],
                                    "operation": "aggregate"
                                },
                                "name": {
                                    "aggregations": [],
                                    "operation": "groupby"
                                },
                                "value": {
                                    "aggregations": [],
                                    "operation": "groupby"
                                }
                            }
                        }
                    }
                ],
                "type": "table"
            },
            {
                "collapsed": true,
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 12
                },
                "id": 12,
                "panels": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Max duration of backup run. Lower better.\n\nEach backup starts with data upload during `latest` backup. Subsequent backups (`hourly`, `daily`, `weekly`, `monthly`)  are copying date by using server-side copy. ",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "fillOpacity": 80,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "lineWidth": 1,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    }
                                },
                                "links": [
                                    {
                                        "targetBlank": true,
                                        "title": "Drilldown",
                                        "url": "/d/gF-lxRdVz?viewPanel=36&var-ds=$ds&var-instance=$instance&var-job=$job&${__url_time_range}"
                                    }
                                ],
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        }
                                    ]
                                },
                                "unit": "s"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 13
                        },
                        "id": 23,
                        "interval": "1h",
                        "options": {
                            "barRadius": 0,
                            "barWidth": 0.97,
                            "groupWidth": 0.7,
                            "legend": {
                                "calcs": [
                                    "max",
                                    "min",
                                    "mean"
                                ],
                                "displayMode": "list",
                                "placement": "bottom",
                                "showLegend": false
                            },
                            "orientation": "auto",
                            "showValue": "auto",
                            "stacking": "none",
                            "tooltip": {
                                "mode": "single",
                                "sort": "none"
                            },
                            "xTickLabelRotation": 0,
                            "xTickLabelSpacing": 100
                        },
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "max(increase(vm_backup_duration_seconds_total{job=~\"$job\", instance=~\"$instance\"})) by (type) > 0",
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Max backup duration",
                        "type": "barchart"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "auto",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                }
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 13
                        },
                        "id": 16,
                        "options": {
                            "legend": {
                                "calcs": [],
                                "displayMode": "list",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "single",
                                "sort": "none"
                            }
                        },
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(increase(vm_backup_errors_total{job=~\"$job\", instance=~\"$instance\"})[$__interval]) by (instance) > 0",
                                "legendFormat": "{{instance}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Backup errors",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "auto",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "decbytes"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 21
                        },
                        "id": 29,
                        "options": {
                            "legend": {
                                "calcs": [],
                                "displayMode": "list",
                                "placement": "bottom",
                                "showLegend": false
                            },
                            "tooltip": {
                                "mode": "single",
                                "sort": "none"
                            }
                        },
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "vm_backups_size_bytes{job=~\"$job\", instance=~\"$instance\"}",
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Backups size",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "thresholds"
                                },
                                "custom": {
                                    "align": "auto",
                                    "cellOptions": {
                                        "type": "auto"
                                    },
                                    "inspect": false
                                },
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "decbytes"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 21
                        },
                        "id": 28,
                        "options": {
                            "footer": {
                                "fields": "",
                                "reducer": [
                                    "sum"
                                ],
                                "show": false
                            },
                            "showHeader": true,
                            "sortBy": [
                                {
                                    "desc": true,
                                    "displayName": "backup"
                                }
                            ]
                        },
                        "pluginVersion": "9.0.4",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": false,
                                "expr": "topk(10, sum(vm_backups_size_bytes{job=~\"$job\", instance=~\"$instance\"}) by (backup, job, type))",
                                "format": "table",
                                "instant": true,
                                "legendFormat": "__auto",
                                "range": false,
                                "refId": "A"
                            }
                        ],
                        "title": "Top 10 backups by size",
                        "transformations": [
                            {
                                "id": "groupBy",
                                "options": {
                                    "fields": {
                                        "Value": {
                                            "aggregations": [],
                                            "operation": "groupby"
                                        },
                                        "backup": {
                                            "aggregations": [],
                                            "operation": "groupby"
                                        },
                                        "job": {
                                            "aggregations": [],
                                            "operation": "groupby"
                                        },
                                        "type": {
                                            "aggregations": [],
                                            "operation": "groupby"
                                        }
                                    }
                                }
                            }
                        ],
                        "type": "table"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "fillOpacity": 80,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "lineWidth": 1,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    }
                                },
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "none"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 29
                        },
                        "id": 30,
                        "interval": "1d",
                        "options": {
                            "barRadius": 0,
                            "barWidth": 0.97,
                            "groupWidth": 0.85,
                            "legend": {
                                "calcs": [],
                                "displayMode": "list",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "orientation": "auto",
                            "showValue": "auto",
                            "stacking": "normal",
                            "tooltip": {
                                "mode": "single",
                                "sort": "none"
                            },
                            "xTickLabelRotation": 0,
                            "xTickLabelSpacing": 100
                        },
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(increase(vm_backups_total{job=~\"$job\", instance=~\"$instance\"}[24h])) by (type) > 0",
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Backup runs",
                        "type": "barchart"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "auto",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        }
                                    ]
                                },
                                "unit": "binBps"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 29
                        },
                        "id": 31,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "max",
                                    "mean"
                                ],
                                "displayMode": "list",
                                "placement": "right",
                                "showLegend": false
                            },
                            "tooltip": {
                                "mode": "single",
                                "sort": "none"
                            }
                        },
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(rollup_rate(vm_backups_uploaded_bytes_total[$__rate_interval])) by (rollup)",
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Backups upload speed",
                        "type": "timeseries"
                    }
                ],
                "title": "Backups",
                "type": "row"
            },
            {
                "collapsed": true,
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 13
                },
                "id": 18,
                "panels": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Max duration of retention run. Lower better.\n\nRetention is a process of removing old backups from remote storage.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "thresholds"
                                },
                                "custom": {
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "fillOpacity": 80,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "lineWidth": 1,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    }
                                },
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        }
                                    ]
                                },
                                "unit": "s"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 38
                        },
                        "id": 26,
                        "interval": "1h",
                        "options": {
                            "barRadius": 0,
                            "barWidth": 0.97,
                            "groupWidth": 0.7,
                            "legend": {
                                "calcs": [],
                                "displayMode": "list",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "orientation": "auto",
                            "showValue": "auto",
                            "stacking": "none",
                            "tooltip": {
                                "mode": "single",
                                "sort": "none"
                            },
                            "xTickLabelRotation": 0,
                            "xTickLabelSpacing": 0
                        },
                        "pluginVersion": "9.0.4",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "max(increase(vm_retention_duration_seconds_total{job=~\"$job\", instance=~\"$instance\"})) > 0",
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Max retention duration",
                        "type": "barchart"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "auto",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                }
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 38
                        },
                        "id": 25,
                        "options": {
                            "legend": {
                                "calcs": [],
                                "displayMode": "list",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "single",
                                "sort": "none"
                            }
                        },
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(increase(vm_retention_errors_total{job=~\"$job\", instance=~\"$instance\"})[$__interval]) by (instance) > 0",
                                "legendFormat": "{{instance}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Retention errors",
                        "type": "timeseries"
                    }
                ],
                "title": "Retention",
                "type": "row"
            },
            {
                "collapsed": true,
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 14
                },
                "id": 34,
                "panels": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Duration of backup run. Lower better.\n\nEach backup starts with data upload during `latest` backup. Subsequent backups (`hourly`, `daily`, `weekly`, `monthly`)  are copying date by using server-side copy.\n",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "fillOpacity": 80,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "lineWidth": 1,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    }
                                },
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        }
                                    ]
                                },
                                "unit": "s"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 11,
                            "w": 24,
                            "x": 0,
                            "y": 39
                        },
                        "id": 36,
                        "interval": "1h",
                        "options": {
                            "barRadius": 0,
                            "barWidth": 0.97,
                            "groupWidth": 0.7,
                            "legend": {
                                "calcs": [],
                                "displayMode": "list",
                                "placement": "bottom",
                                "showLegend": false
                            },
                            "orientation": "auto",
                            "showValue": "auto",
                            "stacking": "none",
                            "tooltip": {
                                "mode": "single",
                                "sort": "none"
                            },
                            "xTickLabelRotation": 0,
                            "xTickLabelSpacing": 100
                        },
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "increase(vm_backup_duration_seconds_total{job=~\"$job\", instance=~\"$instance\"}) > 0",
                                "legendFormat": "{{instance}} - {{type}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Backup duration per instance",
                        "type": "barchart"
                    }
                ],
                "title": "Drilldown",
                "type": "row"
            }
        ],
        "refresh": "1m",
        "schemaVersion": 39,
        "tags": [
            "vm-k8s-stack"
        ],
        "templating": {
            "list": [
                {
                    "current": {
                        "selected": true,
                        "text": "VictoriaMetrics",
                        "value": "VictoriaMetrics"
                    },
                    "hide": 0,
                    "includeAll": false,
                    "multi": false,
                    "name": "ds",
                    "options": [

                    ],
                    "query": "prometheus",
                    "queryValue": "",
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "type": "datasource"
                },
                {
                    "allValue": ".*",
                    "current": {

                    },
                    "datasource": {
                        "uid": "$ds"
                    },
                    "definition": "label_values(vm_app_version{version=~\"^vmbackupmanager.*\"}, job)",
                    "hide": 0,
                    "includeAll": true,
                    "multi": true,
                    "name": "job",
                    "options": [

                    ],
                    "query": {
                        "query": "label_values(vm_app_version{version=~\"^vmbackupmanager.*\"}, job)",
                        "refId": "StandardVariableQuery"
                    },
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": 0,
                    "tagValuesQuery": "",
                    "tagsQuery": "",
                    "type": "query",
                    "useTags": false
                },
                {
                    "allValue": ".*",
                    "current": {

                    },
                    "datasource": {
                        "uid": "$ds"
                    },
                    "definition": "label_values(vm_app_version{job=~\"$job\"}, instance)",
                    "hide": 0,
                    "includeAll": true,
                    "multi": true,
                    "name": "instance",
                    "options": [

                    ],
                    "query": {
                        "query": "label_values(vm_app_version{job=~\"$job\"}, instance)",
                        "refId": "VictoriaMetrics-instance-Variable-Query"
                    },
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": 0,
                    "tagValuesQuery": "",
                    "tagsQuery": "",
                    "type": "query",
                    "useTags": false
                },
                {
                    "datasource": {
                        "type": "prometheus",
                        "uid": "$ds"
                    },
                    "filters": [

                    ],
                    "hide": 0,
                    "name": "adhoc",
                    "skipUrlSync": false,
                    "type": "adhoc"
                }
            ]
        },
        "time": {
            "from": "now-7d",
            "to": "now"
        },
        "timepicker": {

        },
        "timezone": "utc",
        "title": "VictoriaMetrics - backupmanager",
        "uid": "gF-lxRdVz",
        "version": 1,
        "weekStart": ""
    }
---
# Source: victoria-metrics-k8s-stack/templates/grafana/dashboards/grafana-overview.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-grafana-overview
  labels:
    grafana_dashboard: "1"
    app: victoria-metrics-k8s-stack-grafana
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
data:
  grafana-overview.json:  |-
    {
        "annotations": {
            "list": [
                {
                    "builtIn": 1,
                    "datasource": "-- Grafana --",
                    "enable": true,
                    "hide": true,
                    "iconColor": "rgba(0, 211, 255, 1)",
                    "name": "Annotations & Alerts",
                    "target": {
                        "limit": 100,
                        "matchAny": false,
                        "tags": [

                        ],
                        "type": "dashboard"
                    },
                    "type": "dashboard"
                }
            ]
        },
        "editable": false,
        "gnetId": null,
        "graphTooltip": 0,
        "id": 3085,
        "iteration": 1631554945276,
        "links": [

        ],
        "panels": [
            {
                "datasource": "$datasource",
                "fieldConfig": {
                    "defaults": {
                        "mappings": [

                        ],
                        "noValue": "0",
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        }
                    },
                    "overrides": [

                    ]
                },
                "gridPos": {
                    "h": 5,
                    "w": 6,
                    "x": 0,
                    "y": 0
                },
                "id": 6,
                "options": {
                    "colorMode": "value",
                    "graphMode": "area",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "mean"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "text": {

                    },
                    "textMode": "auto"
                },
                "pluginVersion": "8.1.3",
                "targets": [
                    {
                        "expr": "grafana_alerting_result_total{job=~\"$job\", instance=~\"$instance\", state=\"alerting\"}",
                        "instant": true,
                        "interval": "",
                        "legendFormat": "",
                        "refId": "A"
                    }
                ],
                "timeFrom": null,
                "timeShift": null,
                "title": "Firing Alerts",
                "type": "stat"
            },
            {
                "datasource": "$datasource",
                "fieldConfig": {
                    "defaults": {
                        "mappings": [

                        ],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        }
                    },
                    "overrides": [

                    ]
                },
                "gridPos": {
                    "h": 5,
                    "w": 6,
                    "x": 6,
                    "y": 0
                },
                "id": 8,
                "options": {
                    "colorMode": "value",
                    "graphMode": "area",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "mean"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "text": {

                    },
                    "textMode": "auto"
                },
                "pluginVersion": "8.1.3",
                "targets": [
                    {
                        "expr": "sum(grafana_stat_totals_dashboard{job=~\"$job\", instance=~\"$instance\"})",
                        "interval": "",
                        "legendFormat": "",
                        "refId": "A"
                    }
                ],
                "timeFrom": null,
                "timeShift": null,
                "title": "Dashboards",
                "type": "stat"
            },
            {
                "datasource": "$datasource",
                "fieldConfig": {
                    "defaults": {
                        "custom": {
                            "align": null,
                            "displayMode": "auto"
                        },
                        "mappings": [

                        ],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        }
                    },
                    "overrides": [

                    ]
                },
                "gridPos": {
                    "h": 5,
                    "w": 12,
                    "x": 12,
                    "y": 0
                },
                "id": 10,
                "options": {
                    "showHeader": true
                },
                "pluginVersion": "8.1.3",
                "targets": [
                    {
                        "expr": "grafana_build_info{job=~\"$job\", instance=~\"$instance\"}",
                        "instant": true,
                        "interval": "",
                        "legendFormat": "",
                        "refId": "A"
                    }
                ],
                "timeFrom": null,
                "timeShift": null,
                "title": "Build Info",
                "transformations": [
                    {
                        "id": "labelsToFields",
                        "options": {

                        }
                    },
                    {
                        "id": "organize",
                        "options": {
                            "excludeByName": {
                                "Time": true,
                                "Value": true,
                                "branch": true,
                                "container": true,
                                "goversion": true,
                                "namespace": true,
                                "pod": true,
                                "revision": true
                            },
                            "indexByName": {
                                "Time": 7,
                                "Value": 11,
                                "branch": 4,
                                "container": 8,
                                "edition": 2,
                                "goversion": 6,
                                "instance": 1,
                                "job": 0,
                                "namespace": 9,
                                "pod": 10,
                                "revision": 5,
                                "version": 3
                            },
                            "renameByName": {

                            }
                        }
                    }
                ],
                "type": "table"
            },
            {
                "aliasColors": {

                },
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "$datasource",
                "fieldConfig": {
                    "defaults": {
                        "links": [

                        ]
                    },
                    "overrides": [

                    ]
                },
                "fill": 1,
                "fillGradient": 0,
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 5
                },
                "hiddenSeries": false,
                "id": 2,
                "legend": {
                    "avg": false,
                    "current": false,
                    "max": false,
                    "min": false,
                    "show": true,
                    "total": false,
                    "values": false
                },
                "lines": true,
                "linewidth": 1,
                "nullPointMode": "null",
                "options": {
                    "alertThreshold": true
                },
                "percentage": false,
                "pluginVersion": "8.1.3",
                "pointradius": 2,
                "points": false,
                "renderer": "flot",
                "seriesOverrides": [

                ],
                "spaceLength": 10,
                "stack": true,
                "steppedLine": false,
                "targets": [
                    {
                        "expr": "sum by (status_code) (irate(grafana_http_request_duration_seconds_count{job=~\"$job\", instance=~\"$instance\"}[1m])) ",
                        "interval": "",
                        "legendFormat": "{{status_code}}",
                        "refId": "A"
                    }
                ],
                "thresholds": [

                ],
                "timeFrom": null,
                "timeRegions": [

                ],
                "timeShift": null,
                "title": "RPS",
                "tooltip": {
                    "shared": true,
                    "sort": 0,
                    "value_type": "individual"
                },
                "type": "graph",
                "xaxis": {
                    "buckets": null,
                    "mode": "time",
                    "name": null,
                    "show": true,
                    "values": [

                    ]
                },
                "yaxes": [
                    {
                        "$$hashKey": "object:157",
                        "format": "reqps",
                        "label": null,
                        "logBase": 1,
                        "max": null,
                        "min": null,
                        "show": true
                    },
                    {
                        "$$hashKey": "object:158",
                        "format": "short",
                        "label": null,
                        "logBase": 1,
                        "max": null,
                        "min": null,
                        "show": false
                    }
                ],
                "yaxis": {
                    "align": false,
                    "alignLevel": null
                }
            },
            {
                "aliasColors": {

                },
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "$datasource",
                "fieldConfig": {
                    "defaults": {
                        "links": [

                        ]
                    },
                    "overrides": [

                    ]
                },
                "fill": 1,
                "fillGradient": 0,
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 5
                },
                "hiddenSeries": false,
                "id": 4,
                "legend": {
                    "avg": false,
                    "current": false,
                    "max": false,
                    "min": false,
                    "show": true,
                    "total": false,
                    "values": false
                },
                "lines": true,
                "linewidth": 1,
                "nullPointMode": "null",
                "options": {
                    "alertThreshold": true
                },
                "percentage": false,
                "pluginVersion": "8.1.3",
                "pointradius": 2,
                "points": false,
                "renderer": "flot",
                "seriesOverrides": [

                ],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                    {
                        "exemplar": true,
                        "expr": "histogram_quantile(0.99, sum(irate(grafana_http_request_duration_seconds_bucket{instance=~\"$instance\", job=~\"$job\"}[$__rate_interval])) by (le)) * 1",
                        "interval": "",
                        "legendFormat": "99th Percentile",
                        "refId": "A"
                    },
                    {
                        "exemplar": true,
                        "expr": "histogram_quantile(0.50, sum(irate(grafana_http_request_duration_seconds_bucket{instance=~\"$instance\", job=~\"$job\"}[$__rate_interval])) by (le)) * 1",
                        "interval": "",
                        "legendFormat": "50th Percentile",
                        "refId": "B"
                    },
                    {
                        "exemplar": true,
                        "expr": "sum(irate(grafana_http_request_duration_seconds_sum{instance=~\"$instance\", job=~\"$job\"}[$__rate_interval])) * 1 / sum(irate(grafana_http_request_duration_seconds_count{instance=~\"$instance\", job=~\"$job\"}[$__rate_interval]))",
                        "interval": "",
                        "legendFormat": "Average",
                        "refId": "C"
                    }
                ],
                "thresholds": [

                ],
                "timeFrom": null,
                "timeRegions": [

                ],
                "timeShift": null,
                "title": "Request Latency",
                "tooltip": {
                    "shared": true,
                    "sort": 0,
                    "value_type": "individual"
                },
                "type": "graph",
                "xaxis": {
                    "buckets": null,
                    "mode": "time",
                    "name": null,
                    "show": true,
                    "values": [

                    ]
                },
                "yaxes": [
                    {
                        "$$hashKey": "object:210",
                        "format": "ms",
                        "label": null,
                        "logBase": 1,
                        "max": null,
                        "min": null,
                        "show": true
                    },
                    {
                        "$$hashKey": "object:211",
                        "format": "short",
                        "label": null,
                        "logBase": 1,
                        "max": null,
                        "min": null,
                        "show": true
                    }
                ],
                "yaxis": {
                    "align": false,
                    "alignLevel": null
                }
            }
        ],
        "schemaVersion": 30,
        "style": "dark",
        "tags": [
            "vm-k8s-stack"
        ],
        "templating": {
            "list": [
                {
                    "current": {
                        "selected": true,
                        "text": "dev-cortex",
                        "value": "dev-cortex"
                    },
                    "description": null,
                    "error": null,
                    "hide": 0,
                    "includeAll": false,
                    "label": null,
                    "multi": false,
                    "name": "datasource",
                    "options": [

                    ],
                    "query": "prometheus",
                    "queryValue": "",
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "type": "datasource"
                },
                {
                    "allValue": ".*",
                    "current": {
                        "selected": false,
                        "text": [
                            "default/grafana"
                        ],
                        "value": [
                            "default/grafana"
                        ]
                    },
                    "datasource": "$datasource",
                    "definition": "label_values(grafana_build_info, job)",
                    "description": null,
                    "error": null,
                    "hide": 0,
                    "includeAll": true,
                    "label": null,
                    "multi": true,
                    "name": "job",
                    "options": [

                    ],
                    "query": {
                        "query": "label_values(grafana_build_info, job)",
                        "refId": "Billing Admin-job-Variable-Query"
                    },
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": 0,
                    "tagValuesQuery": "",
                    "tagsQuery": "",
                    "type": "query",
                    "useTags": false
                },
                {
                    "allValue": ".*",
                    "current": {
                        "selected": false,
                        "text": "All",
                        "value": "$__all"
                    },
                    "datasource": "$datasource",
                    "definition": "label_values(grafana_build_info, instance)",
                    "description": null,
                    "error": null,
                    "hide": 0,
                    "includeAll": true,
                    "label": null,
                    "multi": true,
                    "name": "instance",
                    "options": [

                    ],
                    "query": {
                        "query": "label_values(grafana_build_info, instance)",
                        "refId": "Billing Admin-instance-Variable-Query"
                    },
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": 0,
                    "tagValuesQuery": "",
                    "tagsQuery": "",
                    "type": "query",
                    "useTags": false
                }
            ]
        },
        "time": {
            "from": "now-6h",
            "to": "now"
        },
        "timepicker": {
            "refresh_intervals": [
                "10s",
                "30s",
                "1m",
                "5m",
                "15m",
                "30m",
                "1h",
                "2h",
                "1d"
            ]
        },
        "timezone": "utc",
        "title": "Grafana Overview",
        "uid": "6be0s85Mk",
        "version": 2
    }
---
# Source: victoria-metrics-k8s-stack/templates/grafana/dashboards/k8s-system-coredns.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-k8s-system-coredns
  labels:
    grafana_dashboard: "1"
    app: victoria-metrics-k8s-stack-grafana
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
data:
  k8s-system-coredns.json:  |-
    {
        "__inputs": [
            {
                "name": "DS_PROMETHEUS",
                "label": "Prometheus",
                "description": "",
                "type": "datasource",
                "pluginId": "prometheus",
                "pluginName": "Prometheus"
            }
        ],
        "__elements": [],
        "__requires": [
            {
                "type": "grafana",
                "id": "grafana",
                "name": "Grafana",
                "version": "8.4.4"
            },
            {
                "type": "datasource",
                "id": "prometheus",
                "name": "Prometheus",
                "version": "5.0.0"
            },
            {
                "type": "panel",
                "id": "timeseries",
                "name": "Time series",
                "version": ""
            },
            {
                "type": "panel",
                "id": "stat",
                "name": "Stat",
                "version": ""
            }
        ],
        "annotations": {
            "list": [
                {
                    "builtIn": 1,
                    "datasource": {
                        "type": "datasource",
                        "uid": "grafana"
                    },
                    "enable": true,
                    "hide": true,
                    "iconColor": "rgba(0, 211, 255, 1)",
                    "name": "Annotations & Alerts",
                    "target": {
                        "limit": 100,
                        "matchAny": false,
                        "tags": [],
                        "type": "dashboard"
                    },
                    "type": "dashboard"
                }
            ]
        },
        "description": "This is a modern CoreDNS dashboard for your Kubernetes cluster(s). Made for kube-prometheus-stack and take advantage of the latest Grafana features. GitHub repository: https://github.com/dotdc/grafana-dashboards-kubernetes",
        "editable": false,
        "fiscalYearStartMonth": 0,
        "graphTooltip": 1,
        "links": [],
        "liveNow": false,
        "panels": [
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "mappings": [
                            {
                                "options": {
                                    "0": {
                                        "text": "DOWN"
                                    },
                                    "1": {
                                        "text": "UP"
                                    }
                                },
                                "type": "value"
                            }
                        ],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "red",
                                    "value": null
                                },
                                {
                                    "color": "green",
                                    "value": 1
                                }
                            ]
                        }
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 3,
                    "w": 24,
                    "x": 0,
                    "y": 0
                },
                "id": 25,
                "options": {
                    "colorMode": "background",
                    "graphMode": "none",
                    "justifyMode": "auto",
                    "orientation": "vertical",
                    "reduceOptions": {
                        "calcs": [
                            "lastNotNull"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "textMode": "value_and_name",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.1",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "exemplar": true,
                        "expr": "up{job=~\"$job\", instance=~\"$instance\", cluster=~\"$cluster\"}",
                        "interval": "",
                        "legendFormat": "{{ instance }}",
                        "refId": "A"
                    }
                ],
                "title": "CoreDNS - Health Status",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "decimals": 2,
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "percentunit"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 3
                },
                "id": 19,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "list",
                        "placement": "bottom",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "single",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "exemplar": true,
                        "expr": "rate(process_cpu_seconds_total{job=~\"$job\", instance=~\"$instance\", cluster=~\"$cluster\"}[$__rate_interval])",
                        "interval": "$resolution",
                        "legendFormat": "{{ instance }}",
                        "refId": "A"
                    }
                ],
                "title": "CoreDNS - CPU Usage by instance",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "bytes"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 3
                },
                "id": 21,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "list",
                        "placement": "bottom",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "single",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "exemplar": true,
                        "expr": "process_resident_memory_bytes{job=~\"$job\", instance=~\"$instance\", cluster=~\"$cluster\"}",
                        "interval": "",
                        "legendFormat": "{{ instance }}",
                        "refId": "A"
                    }
                ],
                "title": "CoreDNS - Memory Usage by instance",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 11
                },
                "id": 9,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "list",
                        "placement": "bottom",
                        "showLegend": false
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "exemplar": true,
                        "expr": "sum(rate(coredns_dns_requests_total{instance=~\"$instance\",proto=\"$protocol\", cluster=~\"$cluster\"}[$__rate_interval]))",
                        "interval": "$resolution",
                        "legendFormat": "total $protocol requests",
                        "refId": "A"
                    }
                ],
                "title": "CoreDNS - Total DNS Requests ($protocol)",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "bytes"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 11
                },
                "id": 7,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "list",
                        "placement": "bottom",
                        "showLegend": false
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "exemplar": true,
                        "expr": "sum(rate(coredns_dns_request_size_bytes_sum{instance=~\"$instance\",proto=\"$protocol\", cluster=~\"$cluster\"}[$__rate_interval])) by (proto) / sum(rate(coredns_dns_request_size_bytes_count{instance=~\"$instance\",proto=\"$protocol\", cluster=~\"$cluster\"}[$__rate_interval])) by (proto)",
                        "interval": "$resolution",
                        "legendFormat": "average $protocol packet size",
                        "refId": "A"
                    }
                ],
                "title": "CoreDNS - Average Packet Size  ($protocol)",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 19
                },
                "id": 2,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "list",
                        "placement": "bottom",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "exemplar": true,
                        "expr": "sum(rate(coredns_dns_requests_total{instance=~\"$instance\", cluster=~\"$cluster\"}[$__rate_interval])) by (type)",
                        "interval": "$resolution",
                        "legendFormat": "{{ type }}",
                        "refId": "A"
                    }
                ],
                "title": "CoreDNS - Requests by type",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 19
                },
                "id": 4,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "list",
                        "placement": "bottom",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "exemplar": true,
                        "expr": "sum(rate(coredns_dns_responses_total{instance=~\"$instance\", cluster=~\"$cluster\"}[$__rate_interval])) by (rcode)",
                        "interval": "$resolution",
                        "legendFormat": "{{ rcode }}",
                        "refId": "A"
                    }
                ],
                "title": "CoreDNS - Requests by return code",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 27
                },
                "id": 23,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "list",
                        "placement": "bottom",
                        "showLegend": false
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "exemplar": true,
                        "expr": "sum(rate(coredns_forward_requests_total{cluster=~\"$cluster\"}[$__rate_interval]))",
                        "interval": "$resolution",
                        "legendFormat": "total forward requests",
                        "refId": "A"
                    }
                ],
                "title": "CoreDNS - Total Forward Requests",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 27
                },
                "id": 13,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "list",
                        "placement": "bottom",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "exemplar": true,
                        "expr": "sum(rate(coredns_forward_responses_total{rcode=~\"SERVFAIL|REFUSED\", cluster=~\"$cluster\"}[$__rate_interval])) by (rcode)",
                        "interval": "$resolution",
                        "legendFormat": "{{ rcode }}",
                        "refId": "A"
                    }
                ],
                "title": "CoreDNS - DNS Errors",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 35
                },
                "id": 17,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "list",
                        "placement": "bottom",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "exemplar": true,
                        "expr": "sum(rate(coredns_cache_hits_total{instance=~\"$instance\", cluster=~\"$cluster\"}[$__rate_interval])) by (type)",
                        "interval": "$resolution",
                        "legendFormat": "{{ type }}",
                        "refId": "A"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "exemplar": true,
                        "expr": "sum(rate(coredns_cache_misses_total{instance=~\"$instance\", cluster=~\"$cluster\"}[$__rate_interval])) by (type)",
                        "interval": "$resolution",
                        "legendFormat": "misses",
                        "refId": "B"
                    }
                ],
                "title": "CoreDNS - Cache Hits / Misses",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "bytes"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 35
                },
                "id": 15,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "list",
                        "placement": "bottom",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "exemplar": true,
                        "expr": "sum(coredns_cache_entries{cluster=~\"$cluster\"}) by (type)",
                        "interval": "",
                        "legendFormat": "{{ type }}",
                        "refId": "A"
                    }
                ],
                "title": "CoreDNS - Cache Size",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "custom": {
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "scaleDistribution": {
                                "type": "linear"
                            }
                        }
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 10,
                    "w": 12,
                    "x": 0,
                    "y": 43
                },
                "id": 27,
                "options": {
                    "calculate": false,
                    "cellGap": 1,
                    "color": {
                        "exponent": 0.5,
                        "fill": "dark-orange",
                        "mode": "scheme",
                        "reverse": false,
                        "scale": "exponential",
                        "scheme": "RdYlBu",
                        "steps": 64
                    },
                    "exemplars": {
                        "color": "rgba(255,0,255,0.7)"
                    },
                    "filterValues": {
                        "le": 1e-09
                    },
                    "legend": {
                        "show": true
                    },
                    "rowsFrame": {
                        "layout": "auto"
                    },
                    "tooltip": {
                        "mode": "single",
                        "showColorScale": false,
                        "yHistogram": false
                    },
                    "yAxis": {
                        "axisPlacement": "left",
                        "reverse": false,
                        "unit": "s"
                    }
                },
                "pluginVersion": "10.4.1",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "sum(increase(coredns_dns_request_duration_seconds_bucket{instance=~\"$instance\", cluster=~\"$cluster\"}[$__rate_interval])) by (le)",
                        "format": "heatmap",
                        "legendFormat": "{{le}}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "CoreDNS - DNS request duration",
                "type": "heatmap"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "custom": {
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "scaleDistribution": {
                                "type": "linear"
                            }
                        }
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 10,
                    "w": 12,
                    "x": 12,
                    "y": 43
                },
                "id": 28,
                "options": {
                    "calculate": false,
                    "cellGap": 1,
                    "color": {
                        "exponent": 0.5,
                        "fill": "dark-orange",
                        "mode": "scheme",
                        "reverse": false,
                        "scale": "exponential",
                        "scheme": "RdYlBu",
                        "steps": 64
                    },
                    "exemplars": {
                        "color": "rgba(255,0,255,0.7)"
                    },
                    "filterValues": {
                        "le": 1e-09
                    },
                    "legend": {
                        "show": true
                    },
                    "rowsFrame": {
                        "layout": "auto"
                    },
                    "tooltip": {
                        "mode": "single",
                        "showColorScale": false,
                        "yHistogram": false
                    },
                    "yAxis": {
                        "axisPlacement": "left",
                        "reverse": false,
                        "unit": "decbytes"
                    }
                },
                "pluginVersion": "10.4.1",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "sum(increase(coredns_dns_request_size_bytes_bucket{instance=~\"$instance\", le!=\"0\", cluster=~\"$cluster\"}[$__rate_interval])) by (le)",
                        "format": "heatmap",
                        "legendFormat": "{{le}}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "CoreDNS - DNS request size",
                "type": "heatmap"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "custom": {
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "scaleDistribution": {
                                "type": "linear"
                            }
                        }
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 10,
                    "w": 12,
                    "x": 0,
                    "y": 53
                },
                "id": 29,
                "options": {
                    "calculate": false,
                    "cellGap": 1,
                    "color": {
                        "exponent": 0.5,
                        "fill": "dark-orange",
                        "mode": "scheme",
                        "reverse": false,
                        "scale": "exponential",
                        "scheme": "RdYlBu",
                        "steps": 64
                    },
                    "exemplars": {
                        "color": "rgba(255,0,255,0.7)"
                    },
                    "filterValues": {
                        "le": 1e-09
                    },
                    "legend": {
                        "show": true
                    },
                    "rowsFrame": {
                        "layout": "auto"
                    },
                    "tooltip": {
                        "mode": "single",
                        "showColorScale": false,
                        "yHistogram": false
                    },
                    "yAxis": {
                        "axisPlacement": "left",
                        "reverse": false,
                        "unit": "decbytes"
                    }
                },
                "pluginVersion": "10.4.1",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "sum(increase(coredns_dns_response_size_bytes_bucket{instance=~\"$instance\", le!=\"0\", cluster=~\"$cluster\"}[$__rate_interval])) by (le)",
                        "format": "heatmap",
                        "legendFormat": "{{le}}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "CoreDNS - DNS response size",
                "type": "heatmap"
            }
        ],
        "refresh": "30s",
        "schemaVersion": 39,
        "tags": [
            "Kubernetes",
            "Prometheus",
            "vm-k8s-stack"
        ],
        "templating": {
            "list": [
                {
                    "current": {
                        "selected": false,
                        "text": "Prometheus",
                        "value": "Prometheus"
                    },
                    "hide": 0,
                    "includeAll": false,
                    "multi": false,
                    "name": "datasource",
                    "options": [

                    ],
                    "query": "prometheus",
                    "queryValue": "",
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "type": "datasource"
                },
                {
                    "current": {
                        "isNone": true,
                        "selected": false,
                        "text": "None",
                        "value": ""
                    },
                    "datasource": {
                        "type": "prometheus",
                        "uid": "${datasource}"
                    },
                    "definition": "label_values(kube_node_info,cluster)",
                    "hide": 2,
                    "includeAll": false,
                    "multi": false,
                    "name": "cluster",
                    "options": [

                    ],
                    "query": {
                        "qryType": 1,
                        "query": "label_values(kube_node_info,cluster)",
                        "refId": "PrometheusVariableQueryEditor-VariableQuery"
                    },
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": 1,
                    "type": "query"
                },
                {
                    "current": {
                        "selected": false,
                        "text": "All",
                        "value": "$__all"
                    },
                    "datasource": {
                        "type": "prometheus",
                        "uid": "${datasource}"
                    },
                    "definition": "label_values(up{job=\"$job\", cluster=\"$cluster\"},instance)",
                    "hide": 0,
                    "includeAll": true,
                    "label": "",
                    "multi": false,
                    "name": "instance",
                    "options": [

                    ],
                    "query": {
                        "qryType": 1,
                        "query": "label_values(up{job=\"$job\", cluster=\"$cluster\"},instance)",
                        "refId": "PrometheusVariableQueryEditor-VariableQuery"
                    },
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": 1,
                    "tagValuesQuery": "",
                    "tagsQuery": "",
                    "type": "query",
                    "useTags": false
                },
                {
                    "allValue": "udp,tcp",
                    "current": {
                        "selected": false,
                        "text": "udp",
                        "value": "udp"
                    },
                    "datasource": {
                        "type": "prometheus",
                        "uid": "${datasource}"
                    },
                    "definition": "label_values(coredns_dns_requests_total{cluster=\"$cluster\"}, proto)",
                    "hide": 0,
                    "includeAll": false,
                    "label": "",
                    "multi": false,
                    "name": "protocol",
                    "options": [

                    ],
                    "query": {
                        "query": "label_values(coredns_dns_requests_total{cluster=\"$cluster\"}, proto)",
                        "refId": "StandardVariableQuery"
                    },
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": 1,
                    "tagValuesQuery": "",
                    "tagsQuery": "",
                    "type": "query",
                    "useTags": false
                },
                {
                    "current": {
                        "selected": false,
                        "text": "30s",
                        "value": "30s"
                    },
                    "hide": 0,
                    "includeAll": false,
                    "multi": false,
                    "name": "resolution",
                    "options": [
                        {
                            "selected": false,
                            "text": "1s",
                            "value": "1s"
                        },
                        {
                            "selected": false,
                            "text": "15s",
                            "value": "15s"
                        },
                        {
                            "selected": true,
                            "text": "30s",
                            "value": "30s"
                        },
                        {
                            "selected": false,
                            "text": "1m",
                            "value": "1m"
                        },
                        {
                            "selected": false,
                            "text": "3m",
                            "value": "3m"
                        },
                        {
                            "selected": false,
                            "text": "5m",
                            "value": "5m"
                        }
                    ],
                    "query": "1s, 15s, 30s, 1m, 3m, 5m",
                    "queryValue": "",
                    "skipUrlSync": false,
                    "type": "custom"
                },
                {
                    "current": {
                        "selected": true,
                        "text": [
                            "coredns"
                        ],
                        "value": [
                            "coredns"
                        ]
                    },
                    "datasource": {
                        "type": "prometheus",
                        "uid": "${datasource}"
                    },
                    "definition": "label_values(coredns_build_info{cluster=\"$cluster\"},job)",
                    "hide": 0,
                    "includeAll": false,
                    "multi": true,
                    "name": "job",
                    "options": [

                    ],
                    "query": {
                        "qryType": 1,
                        "query": "label_values(coredns_build_info{cluster=\"$cluster\"},job)",
                        "refId": "PrometheusVariableQueryEditor-VariableQuery"
                    },
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": 1,
                    "type": "query"
                }
            ]
        },
        "time": {
            "from": "now-1h",
            "to": "now"
        },
        "timepicker": {

        },
        "timezone": "utc",
        "title": "Kubernetes / System / CoreDNS",
        "uid": "k8s_system_coredns",
        "version": 18,
        "weekStart": ""
    }
---
# Source: victoria-metrics-k8s-stack/templates/grafana/dashboards/k8s-views-global.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-k8s-views-global
  labels:
    grafana_dashboard: "1"
    app: victoria-metrics-k8s-stack-grafana
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
data:
  k8s-views-global.json:  |-
    {
        "__inputs": [
            {
                "name": "DS_PROMETHEUS",
                "label": "Prometheus",
                "description": "",
                "type": "datasource",
                "pluginId": "prometheus",
                "pluginName": "Prometheus"
            }
        ],
        "__elements": {},
        "__requires": [
            {
                "type": "panel",
                "id": "bargauge",
                "name": "Bar gauge",
                "version": ""
            },
            {
                "type": "grafana",
                "id": "grafana",
                "name": "Grafana",
                "version": "10.3.1"
            },
            {
                "type": "datasource",
                "id": "prometheus",
                "name": "Prometheus",
                "version": "1.0.0"
            },
            {
                "type": "panel",
                "id": "stat",
                "name": "Stat",
                "version": ""
            },
            {
                "type": "panel",
                "id": "timeseries",
                "name": "Time series",
                "version": ""
            }
        ],
        "annotations": {
            "list": [
                {
                    "builtIn": 1,
                    "datasource": {
                        "type": "datasource",
                        "uid": "grafana"
                    },
                    "enable": true,
                    "hide": true,
                    "iconColor": "rgba(0, 211, 255, 1)",
                    "name": "Annotations & Alerts",
                    "target": {
                        "limit": 100,
                        "matchAny": false,
                        "tags": [],
                        "type": "dashboard"
                    },
                    "type": "dashboard"
                }
            ]
        },
        "description": "This is a modern 'Global View' dashboard for your Kubernetes cluster(s). Made for kube-prometheus-stack and take advantage of the latest Grafana features. GitHub repository: https://github.com/dotdc/grafana-dashboards-kubernetes",
        "editable": false,
        "fiscalYearStartMonth": 0,
        "graphTooltip": 1,
        "links": [],
        "liveNow": false,
        "panels": [
            {
                "collapsed": false,
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 0
                },
                "id": 67,
                "panels": [],
                "title": "Overview",
                "type": "row"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "continuous-GrYlRd"
                        },
                        "mappings": [],
                        "max": 1,
                        "min": 0,
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "percentunit"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 6,
                    "x": 0,
                    "y": 1
                },
                "id": 77,
                "options": {
                    "displayMode": "lcd",
                    "maxVizHeight": 300,
                    "minVizHeight": 10,
                    "minVizWidth": 0,
                    "namePlacement": "auto",
                    "orientation": "horizontal",
                    "reduceOptions": {
                        "calcs": [
                            "lastNotNull"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showUnfilled": true,
                    "sizing": "auto",
                    "valueMode": "color"
                },
                "pluginVersion": "10.4.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "avg(sum by (instance, cpu) (rate(node_cpu_seconds_total{mode!~\"idle|iowait|steal\", cluster=\"$cluster\", job=\"$job\"}[$__rate_interval])))",
                        "interval": "",
                        "legendFormat": "Real Linux",
                        "range": true,
                        "refId": "Real Linux"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "avg(sum by (core) (rate(windows_cpu_time_total{mode!=\"idle\", cluster=\"$cluster\"}[$__rate_interval])))",
                        "hide": false,
                        "interval": "",
                        "legendFormat": "Real Windows",
                        "range": true,
                        "refId": "Real Windows"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "sum(kube_pod_container_resource_requests{resource=\"cpu\", cluster=\"$cluster\"}) / sum(machine_cpu_cores{cluster=\"$cluster\"})",
                        "hide": false,
                        "legendFormat": "Requests",
                        "range": true,
                        "refId": "Requests"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "sum(kube_pod_container_resource_limits{resource=\"cpu\", cluster=\"$cluster\"}) / sum(machine_cpu_cores{cluster=\"$cluster\"})",
                        "hide": false,
                        "legendFormat": "Limits",
                        "range": true,
                        "refId": "Limits"
                    }
                ],
                "title": "Global CPU  Usage",
                "transformations": [
                    {
                        "id": "calculateField",
                        "options": {
                            "alias": "Real",
                            "mode": "reduceRow",
                            "reduce": {
                                "include": [
                                    "Real Linux",
                                    "Real Windows"
                                ],
                                "reducer": "mean"
                            }
                        }
                    },
                    {
                        "id": "organize",
                        "options": {
                            "excludeByName": {
                                "Real Linux": true,
                                "Real Windows": true,
                                "Time": true
                            },
                            "indexByName": {
                                "Limits": 5,
                                "Real": 1,
                                "Real Linux": 2,
                                "Real Windows": 3,
                                "Requests": 4,
                                "Time": 0
                            },
                            "renameByName": {}
                        }
                    }
                ],
                "type": "bargauge"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "continuous-GrYlRd"
                        },
                        "decimals": 2,
                        "mappings": [],
                        "max": 1,
                        "min": 0,
                        "thresholds": {
                            "mode": "percentage",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "percentunit"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 6,
                    "x": 6,
                    "y": 1
                },
                "id": 78,
                "options": {
                    "displayMode": "lcd",
                    "maxVizHeight": 300,
                    "minVizHeight": 10,
                    "minVizWidth": 0,
                    "namePlacement": "auto",
                    "orientation": "horizontal",
                    "reduceOptions": {
                        "calcs": [
                            "lastNotNull"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showUnfilled": true,
                    "sizing": "auto",
                    "text": {},
                    "valueMode": "color"
                },
                "pluginVersion": "10.4.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(node_memory_MemTotal_bytes{cluster=\"$cluster\", job=\"$job\"} - node_memory_MemAvailable_bytes{cluster=\"$cluster\", job=\"$job\"}) / sum(node_memory_MemTotal_bytes{cluster=\"$cluster\", job=\"$job\"})",
                        "hide": false,
                        "interval": "",
                        "legendFormat": "Real Linux",
                        "range": true,
                        "refId": "Real Linux"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(windows_memory_available_bytes{cluster=\"$cluster\"} + windows_memory_cache_bytes{cluster=\"$cluster\"}) / sum(windows_os_visible_memory_bytes{cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Real Windows",
                        "range": true,
                        "refId": "Real Windows"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "sum(kube_pod_container_resource_requests{resource=\"memory\", cluster=\"$cluster\"}) / sum(machine_memory_bytes{cluster=\"$cluster\"})",
                        "hide": false,
                        "legendFormat": "Requests",
                        "range": true,
                        "refId": "Requests"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "sum(kube_pod_container_resource_limits{resource=\"memory\", cluster=\"$cluster\"}) / sum(machine_memory_bytes{cluster=\"$cluster\"})",
                        "hide": false,
                        "legendFormat": "Limits",
                        "range": true,
                        "refId": "Limits"
                    }
                ],
                "title": "Global RAM Usage",
                "transformations": [
                    {
                        "id": "calculateField",
                        "options": {
                            "alias": "Real",
                            "mode": "reduceRow",
                            "reduce": {
                                "include": [
                                    "Real Linux",
                                    "Real Windows"
                                ],
                                "reducer": "mean"
                            }
                        }
                    },
                    {
                        "id": "organize",
                        "options": {
                            "excludeByName": {
                                "Real Linux": true,
                                "Real Windows": true,
                                "Time": true
                            },
                            "includeByName": {},
                            "indexByName": {
                                "Limits": 5,
                                "Real": 3,
                                "Real Linux": 1,
                                "Real Windows": 2,
                                "Requests": 4,
                                "Time": 0
                            },
                            "renameByName": {}
                        }
                    }
                ],
                "type": "bargauge"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "mappings": [],
                        "noValue": "0",
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "blue",
                                    "value": null
                                }
                            ]
                        }
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 4,
                    "w": 2,
                    "x": 12,
                    "y": 1
                },
                "id": 63,
                "options": {
                    "colorMode": "value",
                    "graphMode": "none",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "last"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "text": {},
                    "textMode": "value",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "count(count by (node) (kube_node_info{cluster=\"$cluster\"}))",
                        "interval": "",
                        "legendFormat": "",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Nodes",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 12,
                    "w": 10,
                    "x": 14,
                    "y": 1
                },
                "id": 52,
                "options": {
                    "legend": {
                        "calcs": [
                            "min",
                            "max",
                            "mean"
                        ],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": true,
                        "sortBy": "Max",
                        "sortDesc": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "exemplar": true,
                        "expr": "sum(kube_namespace_labels{cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Namespaces",
                        "refId": "A"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "expr": "sum(kube_pod_container_status_running{cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Running Containers",
                        "refId": "B"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "expr": "sum(kube_pod_status_phase{phase=\"Running\", cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Running Pods",
                        "refId": "O"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "expr": "sum(kube_service_info{cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Services",
                        "refId": "C"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "expr": "sum(kube_endpoint_info{cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Endpoints",
                        "refId": "D"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "expr": "sum(kube_ingress_info{cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Ingresses",
                        "refId": "E"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "expr": "sum(kube_deployment_labels{cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Deployments",
                        "refId": "F"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "expr": "sum(kube_statefulset_labels{cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Statefulsets",
                        "refId": "G"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "expr": "sum(kube_daemonset_labels{cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Daemonsets",
                        "refId": "H"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "expr": "sum(kube_persistentvolumeclaim_info{cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Persistent Volume Claims",
                        "refId": "I"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "expr": "sum(kube_hpa_labels{cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Horizontal Pod Autoscalers",
                        "refId": "J"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "expr": "sum(kube_configmap_info{cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Configmaps",
                        "refId": "K"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "expr": "sum(kube_secret_info{cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Secrets",
                        "refId": "L"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "expr": "sum(kube_networkpolicy_labels{cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Network Policies",
                        "refId": "M"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "exemplar": true,
                        "expr": "count(count by (node) (kube_node_info{cluster=\"$cluster\"}))",
                        "hide": false,
                        "interval": "",
                        "legendFormat": "Nodes",
                        "refId": "N"
                    }
                ],
                "title": "Kubernetes Resource Count",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "mappings": [],
                        "noValue": "0",
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "blue",
                                    "value": null
                                }
                            ]
                        }
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 4,
                    "w": 2,
                    "x": 12,
                    "y": 5
                },
                "id": 59,
                "options": {
                    "colorMode": "value",
                    "graphMode": "none",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "last"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "text": {},
                    "textMode": "value",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "expr": "count(kube_namespace_created{cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "",
                        "refId": "A"
                    }
                ],
                "title": "Namespaces",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "mappings": [],
                        "noValue": "0",
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "rgb(255, 255, 255)",
                                    "value": null
                                }
                            ]
                        },
                        "unit": "none"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 4,
                    "w": 6,
                    "x": 0,
                    "y": 9
                },
                "id": 37,
                "options": {
                    "colorMode": "none",
                    "graphMode": "none",
                    "justifyMode": "center",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "lastNotNull"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "text": {},
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(rate(node_cpu_seconds_total{mode!~\"idle|iowait|steal\", cluster=\"$cluster\", job=\"$job\"}[$__rate_interval]))",
                        "interval": "",
                        "legendFormat": "Real Linux",
                        "range": true,
                        "refId": "Real Linux"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(rate(windows_cpu_time_total{mode!=\"idle\", cluster=\"$cluster\"}[$__rate_interval]))",
                        "hide": false,
                        "interval": "",
                        "legendFormat": "Real Windows",
                        "range": true,
                        "refId": "Real Windows"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "sum(kube_pod_container_resource_requests{resource=\"cpu\", cluster=\"$cluster\"})",
                        "hide": false,
                        "legendFormat": "Requests",
                        "range": true,
                        "refId": "Requests"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "sum(kube_pod_container_resource_limits{resource=\"cpu\", cluster=\"$cluster\"})",
                        "hide": false,
                        "legendFormat": "Limits",
                        "range": true,
                        "refId": "Limits"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "sum(machine_cpu_cores{cluster=\"$cluster\"})",
                        "hide": false,
                        "legendFormat": "Total",
                        "range": true,
                        "refId": "Total"
                    }
                ],
                "title": "CPU Usage",
                "transformations": [
                    {
                        "id": "calculateField",
                        "options": {
                            "alias": "Real",
                            "mode": "reduceRow",
                            "reduce": {
                                "include": [
                                    "Real Linux",
                                    "Real Windows"
                                ],
                                "reducer": "sum"
                            }
                        }
                    },
                    {
                        "id": "organize",
                        "options": {
                            "excludeByName": {
                                "Real Linux": true,
                                "Real Windows": true,
                                "Time": true,
                                "Total Linux": true,
                                "Total Windows": true
                            },
                            "indexByName": {
                                "Limits": 5,
                                "Real": 3,
                                "Real Linux": 1,
                                "Real Windows": 2,
                                "Requests": 4,
                                "Time": 0,
                                "Total": 8,
                                "Total Linux": 6,
                                "Total Windows": 7
                            },
                            "renameByName": {}
                        }
                    }
                ],
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "mappings": [],
                        "noValue": "0",
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "rgb(255, 255, 255)",
                                    "value": null
                                }
                            ]
                        },
                        "unit": "bytes"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 4,
                    "w": 6,
                    "x": 6,
                    "y": 9
                },
                "id": 39,
                "options": {
                    "colorMode": "none",
                    "graphMode": "none",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "lastNotNull"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "text": {},
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(node_memory_MemTotal_bytes{cluster=\"$cluster\", job=\"$job\"} - node_memory_MemAvailable_bytes{cluster=\"$cluster\", job=\"$job\"})",
                        "interval": "",
                        "legendFormat": "Real Linux",
                        "range": true,
                        "refId": "Real Linux"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(windows_os_visible_memory_bytes{cluster=\"$cluster\"} - windows_memory_available_bytes{cluster=\"$cluster\"} - windows_memory_cache_bytes{cluster=\"$cluster\"})",
                        "hide": false,
                        "interval": "",
                        "legendFormat": "Real Windows",
                        "range": true,
                        "refId": "Real Windows"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "sum(kube_pod_container_resource_requests{resource=\"memory\", cluster=\"$cluster\"})",
                        "hide": false,
                        "legendFormat": "Requests",
                        "range": true,
                        "refId": "Requests"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "sum(kube_pod_container_resource_limits{resource=\"memory\", cluster=\"$cluster\"})",
                        "hide": false,
                        "legendFormat": "Limits",
                        "range": true,
                        "refId": "Limits"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "sum(machine_memory_bytes{cluster=\"$cluster\"})",
                        "hide": false,
                        "legendFormat": "Total",
                        "range": true,
                        "refId": "Total"
                    }
                ],
                "title": "RAM Usage",
                "transformations": [
                    {
                        "id": "calculateField",
                        "options": {
                            "alias": "Real",
                            "mode": "reduceRow",
                            "reduce": {
                                "include": [
                                    "Real Linux",
                                    "Real Windows"
                                ],
                                "reducer": "mean"
                            }
                        }
                    },
                    {
                        "id": "organize",
                        "options": {
                            "excludeByName": {
                                "Real Linux": true,
                                "Real Windows": true,
                                "Time": true
                            },
                            "includeByName": {},
                            "indexByName": {
                                "Limits": 5,
                                "Real": 3,
                                "Real Linux": 1,
                                "Real Windows": 2,
                                "Requests": 4,
                                "Time": 0,
                                "Total": 6
                            },
                            "renameByName": {}
                        }
                    }
                ],
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "mappings": [],
                        "noValue": "0",
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "blue",
                                    "value": null
                                }
                            ]
                        }
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 4,
                    "w": 2,
                    "x": 12,
                    "y": 9
                },
                "id": 62,
                "options": {
                    "colorMode": "value",
                    "graphMode": "none",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "last"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "text": {},
                    "textMode": "value",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "expr": "sum(kube_pod_status_phase{phase=\"Running\", cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "",
                        "refId": "A"
                    }
                ],
                "title": "Running Pods",
                "type": "stat"
            },
            {
                "collapsed": false,
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 13
                },
                "id": 71,
                "panels": [],
                "title": "Resources",
                "type": "row"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "continuous-GrYlRd",
                            "seriesBy": "last"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "CPU %",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 10,
                            "gradientMode": "scheme",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineStyle": {
                                "fill": "solid"
                            },
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "decimals": 2,
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "yellow",
                                    "value": 0.5
                                },
                                {
                                    "color": "red",
                                    "value": 0.7
                                }
                            ]
                        },
                        "unit": "percentunit"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 14
                },
                "id": 72,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "hidden",
                        "placement": "right",
                        "showLegend": false
                    },
                    "tooltip": {
                        "mode": "single",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "avg(sum by (instance, cpu) (rate(node_cpu_seconds_total{mode!~\"idle|iowait|steal\", cluster=\"$cluster\", job=\"$job\"}[$__rate_interval])))",
                        "interval": "$resolution",
                        "legendFormat": "Linux",
                        "range": true,
                        "refId": "Linux"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "1 - avg(rate(windows_cpu_time_total{cluster=\"$cluster\",mode=\"idle\"}[$__rate_interval]))",
                        "hide": false,
                        "interval": "$resolution",
                        "legendFormat": "Windows",
                        "range": true,
                        "refId": "Windows"
                    }
                ],
                "title": "Cluster CPU Utilization",
                "transformations": [
                    {
                        "id": "calculateField",
                        "options": {
                            "alias": "CPU usage in %",
                            "mode": "reduceRow",
                            "reduce": {
                                "reducer": "mean"
                            },
                            "replaceFields": true
                        }
                    }
                ],
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "continuous-GrYlRd"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "MEMORY",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 10,
                            "gradientMode": "scheme",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "#EAB839",
                                    "value": 0.5
                                },
                                {
                                    "color": "red",
                                    "value": 0.7
                                }
                            ]
                        },
                        "unit": "percentunit"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 14
                },
                "id": 55,
                "options": {
                    "legend": {
                        "calcs": [
                            "mean",
                            "lastNotNull",
                            "max",
                            "min"
                        ],
                        "displayMode": "hidden",
                        "placement": "right",
                        "showLegend": false
                    },
                    "tooltip": {
                        "mode": "single",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(node_memory_MemTotal_bytes{cluster=\"$cluster\", job=\"$job\"} - node_memory_MemAvailable_bytes{cluster=\"$cluster\", job=\"$job\"}) / sum(node_memory_MemTotal_bytes{cluster=\"$cluster\", job=\"$job\"})",
                        "interval": "$resolution",
                        "legendFormat": "Linux",
                        "range": true,
                        "refId": "Linux"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(windows_os_visible_memory_bytes{cluster=\"$cluster\"} - windows_memory_available_bytes{cluster=\"$cluster\"}) / sum(windows_os_visible_memory_bytes{cluster=\"$cluster\"})",
                        "hide": false,
                        "interval": "$resolution",
                        "legendFormat": "Windows",
                        "range": true,
                        "refId": "Windows"
                    }
                ],
                "title": "Cluster Memory Utilization",
                "transformations": [
                    {
                        "id": "calculateField",
                        "options": {
                            "alias": "Memory usage in %",
                            "mode": "reduceRow",
                            "reduce": {
                                "reducer": "mean"
                            },
                            "replaceFields": true
                        }
                    }
                ],
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "CPU CORES",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineStyle": {
                                "fill": "solid"
                            },
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "decimals": 2,
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "none"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 22
                },
                "id": 46,
                "options": {
                    "legend": {
                        "calcs": [
                            "min",
                            "max",
                            "mean"
                        ],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": true,
                        "sortBy": "Max",
                        "sortDesc": true
                    },
                    "tooltip": {
                        "mode": "single",
                        "sort": "none"
                    }
                },
                "pluginVersion": "10.4.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(rate(container_cpu_usage_seconds_total{image!=\"\", cluster=\"$cluster\"}[$__rate_interval])) by (namespace)\n+ on (namespace)\n(sum(rate(windows_container_cpu_usage_seconds_total{container_id!=\"\", cluster=\"$cluster\"}[$__rate_interval]) * on (container_id) group_left (container, pod, namespace) max by ( container, container_id, pod, namespace) (kube_pod_container_info{container_id!=\"\", cluster=\"$cluster\"}) OR kube_namespace_created{cluster=\"$cluster\"} * 0) by (namespace))",
                        "format": "time_series",
                        "hide": false,
                        "interval": "$resolution",
                        "legendFormat": "{{ namespace }}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "CPU Utilization by namespace",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "bytes"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 22
                },
                "id": 50,
                "options": {
                    "legend": {
                        "calcs": [
                            "min",
                            "max",
                            "mean"
                        ],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": true,
                        "sortBy": "Max",
                        "sortDesc": true
                    },
                    "tooltip": {
                        "mode": "single",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(container_memory_working_set_bytes{image!=\"\", cluster=\"$cluster\"}) by (namespace)\n+ on (namespace)\n(sum(windows_container_memory_usage_commit_bytes{container_id!=\"\", cluster=\"$cluster\"} * on (container_id) group_left (container, pod, namespace) max by ( container, container_id, pod, namespace) (kube_pod_container_info{container_id!=\"\", cluster=\"$cluster\"}) OR kube_namespace_created{cluster=\"$cluster\"} * 0) by (namespace))",
                        "interval": "$resolution",
                        "legendFormat": "{{ namespace }}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Memory Utilization by namespace",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "CPU %",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "decimals": 2,
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "percentunit"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 30
                },
                "id": 54,
                "options": {
                    "legend": {
                        "calcs": [
                            "min",
                            "max",
                            "mean"
                        ],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": true,
                        "sortBy": "Max",
                        "sortDesc": true
                    },
                    "tooltip": {
                        "mode": "single",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "avg(sum by (instance, cpu) (rate(node_cpu_seconds_total{mode!~\"idle|iowait|steal\", cluster=\"$cluster\", job=\"$job\"}[$__rate_interval]))) by (instance)",
                        "interval": "$resolution",
                        "legendFormat": "{{ node }}",
                        "range": true,
                        "refId": "Linux"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "avg(sum by (instance,core) (rate(windows_cpu_time_total{mode!=\"idle\", cluster=\"$cluster\"}[$__rate_interval]))) by (instance)",
                        "hide": false,
                        "interval": "$resolution",
                        "legendFormat": "{{ node }}",
                        "range": true,
                        "refId": "Windows"
                    }
                ],
                "title": "CPU Utilization by instance",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "MEMORY",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "bytes"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 30
                },
                "id": 73,
                "options": {
                    "legend": {
                        "calcs": [
                            "min",
                            "max",
                            "mean"
                        ],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": true,
                        "sortBy": "Max",
                        "sortDesc": true
                    },
                    "tooltip": {
                        "mode": "single",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(node_memory_MemTotal_bytes{cluster=\"$cluster\", job=\"$job\"} - node_memory_MemAvailable_bytes{cluster=\"$cluster\", job=\"$job\"}) by (instance)",
                        "hide": false,
                        "interval": "$resolution",
                        "legendFormat": "{{ instance }}",
                        "range": true,
                        "refId": "Linux"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(windows_os_visible_memory_bytes{cluster=\"$cluster\"} - windows_memory_available_bytes{cluster=\"$cluster\"}) by (instance)",
                        "hide": false,
                        "interval": "$resolution",
                        "legendFormat": "{{ instance }}",
                        "range": true,
                        "refId": "Windows"
                    }
                ],
                "title": "Memory Utilization by instance",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "description": "No data is generally a good thing here.",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "SECONDS",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineStyle": {
                                "fill": "solid"
                            },
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "decimals": 2,
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "s"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 38
                },
                "id": 82,
                "options": {
                    "legend": {
                        "calcs": [
                            "min",
                            "max",
                            "mean"
                        ],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": true,
                        "sortBy": "Max",
                        "sortDesc": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(rate(container_cpu_cfs_throttled_seconds_total{image!=\"\", cluster=\"$cluster\"}[$__rate_interval])) by (namespace) > 0",
                        "interval": "$resolution",
                        "legendFormat": "{{ namespace }}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "CPU Throttled seconds by namespace",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "description": "No data is generally a good thing here.",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "NB",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineStyle": {
                                "fill": "solid"
                            },
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "decimals": 2,
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "none"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 38
                },
                "id": 83,
                "options": {
                    "legend": {
                        "calcs": [
                            "min",
                            "max",
                            "mean"
                        ],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": true,
                        "sortBy": "Max",
                        "sortDesc": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(rate(node_cpu_core_throttles_total{cluster=\"$cluster\", job=\"$job\"}[$__rate_interval])) by (instance)",
                        "interval": "$resolution",
                        "legendFormat": "{{ instance }}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "CPU Core Throttled by instance",
                "type": "timeseries"
            },
            {
                "collapsed": false,
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 46
                },
                "id": 86,
                "panels": [],
                "title": "Kubernetes",
                "type": "row"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 9,
                    "w": 12,
                    "x": 0,
                    "y": 47
                },
                "id": 84,
                "options": {
                    "legend": {
                        "calcs": [
                            "min",
                            "max",
                            "mean"
                        ],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": true,
                        "sortBy": "Max",
                        "sortDesc": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(kube_pod_status_qos_class{cluster=\"$cluster\"}) by (qos_class)",
                        "interval": "",
                        "legendFormat": "{{ qos_class }} pods",
                        "range": true,
                        "refId": "A"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "sum(kube_pod_info{cluster=\"$cluster\"})",
                        "hide": false,
                        "legendFormat": "Total pods",
                        "range": true,
                        "refId": "B"
                    }
                ],
                "title": "Kubernetes Pods QoS classes",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 9,
                    "w": 12,
                    "x": 12,
                    "y": 47
                },
                "id": 85,
                "options": {
                    "legend": {
                        "calcs": [
                            "min",
                            "max",
                            "mean"
                        ],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": true,
                        "sortBy": "Max",
                        "sortDesc": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(kube_pod_status_reason{cluster=\"$cluster\"}) by (reason)",
                        "interval": "",
                        "legendFormat": "{{ reason }}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Kubernetes Pods Status Reason",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "description": "No data is generally a good thing here.",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "points",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 9,
                    "w": 12,
                    "x": 0,
                    "y": 56
                },
                "id": 87,
                "options": {
                    "legend": {
                        "calcs": [
                            "min",
                            "max",
                            "mean"
                        ],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": true,
                        "sortBy": "Max",
                        "sortDesc": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(increase(container_oom_events_total{cluster=\"$cluster\"}[$__rate_interval])) by (namespace) > 0",
                        "interval": "",
                        "legendFormat": "{{ namespace }}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "OOM Events by namespace",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "description": "No data is generally a good thing here.",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "points",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 9,
                    "w": 12,
                    "x": 12,
                    "y": 56
                },
                "id": 88,
                "options": {
                    "legend": {
                        "calcs": [
                            "min",
                            "max",
                            "mean"
                        ],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": true,
                        "sortBy": "Max",
                        "sortDesc": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(increase(kube_pod_container_status_restarts_total{cluster=\"$cluster\"}[$__rate_interval])) by (namespace) > 0",
                        "interval": "",
                        "legendFormat": "{{ namespace }}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Container Restarts by namespace",
                "type": "timeseries"
            },
            {
                "collapsed": false,
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 65
                },
                "id": 69,
                "panels": [],
                "title": "Network",
                "type": "row"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "description": "Dropped noisy virtual devices for readability.",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "BANDWIDTH",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "bytes"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 66
                },
                "id": 44,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "hidden",
                        "placement": "bottom",
                        "showLegend": false
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(rate(node_network_receive_bytes_total{device!~\"(veth|azv|lxc).*\", cluster=\"$cluster\", job=\"$job\"}[$__rate_interval])) by (device)",
                        "interval": "$resolution",
                        "legendFormat": "Received : {{ device }}",
                        "range": true,
                        "refId": "Linux Received"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "- sum(rate(node_network_transmit_bytes_total{device!~\"(veth|azv|lxc).*\", cluster=\"$cluster\", job=\"$job\"}[$__rate_interval])) by (device)",
                        "interval": "$resolution",
                        "legendFormat": "Transmitted : {{ device }}",
                        "range": true,
                        "refId": "Linux Transmitted"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(rate(windows_net_bytes_received_total{cluster=\"$cluster\"}[$__rate_interval])) by (nic)",
                        "hide": false,
                        "interval": "$resolution",
                        "legendFormat": "Received : {{ nic }}",
                        "range": true,
                        "refId": "Windows Received"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "- sum(rate(windows_net_bytes_sent_total{cluster=\"$cluster\"}[$__rate_interval])) by (nic)",
                        "hide": false,
                        "interval": "$resolution",
                        "legendFormat": "Transmitted : {{ device }}",
                        "range": true,
                        "refId": "Windows Transmitted"
                    }
                ],
                "title": "Global Network Utilization by device",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "DROPPED PACKETS",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "none"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 66
                },
                "id": 53,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "hidden",
                        "placement": "bottom",
                        "showLegend": false
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(rate(node_network_receive_drop_total{cluster=\"$cluster\", job=\"$job\"}[$__rate_interval]))",
                        "interval": "$resolution",
                        "legendFormat": "Linux Packets dropped (receive)",
                        "range": true,
                        "refId": "Linux Packets dropped (receive)"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "- sum(rate(node_network_transmit_drop_total{cluster=\"$cluster\", job=\"$job\"}[$__rate_interval]))",
                        "interval": "$resolution",
                        "legendFormat": "Linux Packets dropped (transmit)",
                        "range": true,
                        "refId": "Linux Packets dropped (transmit)"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(rate(windows_net_packets_received_discarded_total{cluster=\"$cluster\"}[$__rate_interval]))",
                        "hide": false,
                        "interval": "$resolution",
                        "legendFormat": "Windows Packets dropped (receive)",
                        "range": true,
                        "refId": "Windows Packets dropped (receive)"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "- sum(rate(windows_net_packets_outbound_discarded_total{cluster=\"$cluster\"}[$__rate_interval]))",
                        "hide": false,
                        "interval": "$resolution",
                        "legendFormat": "Windows Packets dropped (transmit)",
                        "range": true,
                        "refId": "Windows Packets dropped (transmit)"
                    }
                ],
                "title": "Network Saturation - Packets dropped",
                "transformations": [
                    {
                        "id": "calculateField",
                        "options": {
                            "alias": "Packets dropped (receive)",
                            "mode": "reduceRow",
                            "reduce": {
                                "include": [
                                    "Linux Packets dropped (receive)",
                                    "Windows Packets dropped (receive)"
                                ],
                                "reducer": "mean"
                            }
                        }
                    },
                    {
                        "id": "calculateField",
                        "options": {
                            "alias": "Packets dropped (transmit)",
                            "mode": "reduceRow",
                            "reduce": {
                                "include": [
                                    "Linux Packets dropped (transmit)",
                                    "Windows Packets dropped (transmit)"
                                ],
                                "reducer": "mean"
                            }
                        }
                    },
                    {
                        "id": "organize",
                        "options": {
                            "excludeByName": {
                                "Linux Packets dropped (receive)": true,
                                "Linux Packets dropped (transmit)": true,
                                "Time": false,
                                "Windows Packets dropped (receive)": true,
                                "Windows Packets dropped (transmit)": true
                            },
                            "includeByName": {},
                            "indexByName": {},
                            "renameByName": {}
                        }
                    }
                ],
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "BANDWIDTH",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "bytes"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 74
                },
                "id": 79,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "hidden",
                        "placement": "bottom",
                        "showLegend": false
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(rate(container_network_receive_bytes_total{cluster=\"$cluster\"}[$__rate_interval])) by (namespace)\n+ on (namespace)\n(sum(rate(windows_container_network_receive_bytes_total{container_id!=\"\", cluster=\"$cluster\"}[$__rate_interval]) * on (container_id) group_left (container, pod, namespace) max by ( container, container_id, pod, namespace) (kube_pod_container_info{container_id!=\"\", cluster=\"$cluster\"}) OR kube_namespace_created{cluster=\"$cluster\"} * 0) by (namespace))",
                        "interval": "$resolution",
                        "legendFormat": "Received : {{ namespace }}",
                        "range": true,
                        "refId": "A"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "- (sum(rate(container_network_transmit_bytes_total{cluster=\"$cluster\"}[$__rate_interval])) by (namespace)\n+ on (namespace)\n(sum(rate(windows_container_network_transmit_bytes_total{container_id!=\"\", cluster=\"$cluster\"}[$__rate_interval]) * on (container_id) group_left (container, pod, namespace) max by ( container, container_id, pod, namespace) (kube_pod_container_info{container_id!=\"\", cluster=\"$cluster\"}) OR kube_namespace_created{cluster=\"$cluster\"} * 0) by (namespace)))",
                        "hide": false,
                        "interval": "$resolution",
                        "legendFormat": "Transmitted : {{ namespace }}",
                        "range": true,
                        "refId": "B"
                    }
                ],
                "title": "Network Received by namespace",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "BANDWIDTH",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "bytes"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 74
                },
                "id": 80,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "hidden",
                        "placement": "bottom",
                        "showLegend": false
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(rate(node_network_receive_bytes_total{cluster=\"$cluster\", job=\"$job\"}[$__rate_interval])) by (instance)",
                        "interval": "$resolution",
                        "legendFormat": "Received bytes in {{ instance }}",
                        "range": true,
                        "refId": "Linux Received bytes"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "- sum(rate(node_network_transmit_bytes_total{cluster=\"$cluster\", job=\"$job\"}[$__rate_interval])) by (instance)",
                        "hide": false,
                        "interval": "$resolution",
                        "legendFormat": "Transmitted bytes in {{ instance }}",
                        "range": true,
                        "refId": "Linux Transmitted bytes"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(rate(windows_net_bytes_received_total{cluster=\"$cluster\"}[$__rate_interval])) by (instance)",
                        "hide": false,
                        "interval": "$resolution",
                        "legendFormat": "Received bytes in {{ instance }}",
                        "range": true,
                        "refId": "Windows Received bytes"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "- sum(rate(windows_net_bytes_sent_total{cluster=\"$cluster\"}[$__rate_interval])) by (instance)",
                        "hide": false,
                        "interval": "$resolution",
                        "legendFormat": "Transmitted bytes in {{ instance }}",
                        "range": true,
                        "refId": "Windows Transmitted bytes"
                    }
                ],
                "title": "Total Network Received (with all virtual devices) by instance",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "description": "Dropped noisy virtual devices for readability.",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "BANDWIDTH",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "bytes"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 82
                },
                "id": 56,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "hidden",
                        "placement": "bottom",
                        "showLegend": false
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(rate(node_network_receive_bytes_total{device!~\"(veth|azv|lxc|lo).*\", cluster=\"$cluster\", job=\"$job\"}[$__rate_interval])) by (instance)",
                        "interval": "$resolution",
                        "legendFormat": "Received bytes in {{ instance }}",
                        "range": true,
                        "refId": "A"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "- sum(rate(node_network_transmit_bytes_total{device!~\"(veth|azv|lxc|lo).*\", cluster=\"$cluster\", job=\"$job\"}[$__rate_interval])) by (instance)",
                        "hide": false,
                        "interval": "$resolution",
                        "legendFormat": "Transmitted bytes in {{ instance }}",
                        "range": true,
                        "refId": "B"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(rate(windows_net_bytes_received_total{nic!~\".*Virtual.*\",cluster=\"$cluster\"}[$__rate_interval])) by (instance)",
                        "hide": false,
                        "interval": "$resolution",
                        "legendFormat": "Received bytes in {{ instance }}",
                        "range": true,
                        "refId": "C"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "- sum(rate(windows_net_bytes_sent_total{nic!~\".*Virtual.*\",cluster=\"$cluster\"}[$__rate_interval])) by (instance)",
                        "hide": false,
                        "interval": "$resolution",
                        "legendFormat": "Transmitted bytes in {{ instance }}",
                        "range": true,
                        "refId": "D"
                    }
                ],
                "title": "Network Received (without loopback)  by instance",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "description": "Dropped noisy virtual devices for readability.",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "BANDWIDTH",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "bytes"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 82
                },
                "id": 81,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "hidden",
                        "placement": "bottom",
                        "showLegend": false
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(rate(node_network_receive_bytes_total{device=\"lo\", cluster=\"$cluster\", job=\"$job\"}[$__rate_interval])) by (instance)",
                        "interval": "$resolution",
                        "legendFormat": "Received bytes in {{ instance }}",
                        "range": true,
                        "refId": "A"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "- sum(rate(node_network_transmit_bytes_total{device=\"lo\", cluster=\"$cluster\", job=\"$job\"}[$__rate_interval])) by (instance)",
                        "hide": false,
                        "interval": "$resolution",
                        "legendFormat": "Transmitted bytes in {{ instance }}",
                        "range": true,
                        "refId": "B"
                    }
                ],
                "title": "Network Received (loopback only) by instance",
                "type": "timeseries"
            }
        ],
        "refresh": "30s",
        "schemaVersion": 39,
        "tags": [
            "Kubernetes",
            "Prometheus",
            "vm-k8s-stack"
        ],
        "templating": {
            "list": [
                {
                    "current": {
                        "selected": false,
                        "text": "",
                        "value": ""
                    },
                    "hide": 0,
                    "includeAll": false,
                    "multi": false,
                    "name": "datasource",
                    "options": [

                    ],
                    "query": "prometheus",
                    "queryValue": "",
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "type": "datasource"
                },
                {
                    "current": {

                    },
                    "datasource": {
                        "type": "prometheus",
                        "uid": "${datasource}"
                    },
                    "definition": "label_values(kube_node_info,cluster)",
                    "hide": 2,
                    "includeAll": false,
                    "multi": false,
                    "name": "cluster",
                    "options": [

                    ],
                    "query": {
                        "qryType": 1,
                        "query": "label_values(kube_node_info,cluster)",
                        "refId": "PrometheusVariableQueryEditor-VariableQuery"
                    },
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": 1,
                    "type": "query"
                },
                {
                    "current": {
                        "selected": false,
                        "text": "30s",
                        "value": "30s"
                    },
                    "hide": 0,
                    "includeAll": false,
                    "multi": false,
                    "name": "resolution",
                    "options": [
                        {
                            "selected": false,
                            "text": "1s",
                            "value": "1s"
                        },
                        {
                            "selected": false,
                            "text": "15s",
                            "value": "15s"
                        },
                        {
                            "selected": true,
                            "text": "30s",
                            "value": "30s"
                        },
                        {
                            "selected": false,
                            "text": "1m",
                            "value": "1m"
                        },
                        {
                            "selected": false,
                            "text": "3m",
                            "value": "3m"
                        },
                        {
                            "selected": false,
                            "text": "5m",
                            "value": "5m"
                        }
                    ],
                    "query": "1s, 15s, 30s, 1m, 3m, 5m",
                    "queryValue": "",
                    "skipUrlSync": false,
                    "type": "custom"
                },
                {
                    "current": {
                        "selected": false,
                        "text": "",
                        "value": ""
                    },
                    "datasource": {
                        "type": "prometheus",
                        "uid": "${datasource}"
                    },
                    "definition": "label_values(node_cpu_seconds_total{cluster=\"$cluster\"},job)",
                    "hide": 0,
                    "includeAll": false,
                    "multi": true,
                    "name": "job",
                    "options": [

                    ],
                    "query": {
                        "qryType": 1,
                        "query": "label_values(node_cpu_seconds_total{cluster=\"$cluster\"},job)",
                        "refId": "PrometheusVariableQueryEditor-VariableQuery"
                    },
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": 1,
                    "type": "query"
                }
            ]
        },
        "time": {
            "from": "now-1h",
            "to": "now"
        },
        "timepicker": {

        },
        "timezone": "utc",
        "title": "Kubernetes / Views / Global",
        "uid": "k8s_views_global",
        "version": 39,
        "weekStart": ""
    }
---
# Source: victoria-metrics-k8s-stack/templates/grafana/dashboards/k8s-views-namespaces.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-k8s-views-namespaces
  labels:
    grafana_dashboard: "1"
    app: victoria-metrics-k8s-stack-grafana
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
data:
  k8s-views-namespaces.json:  |-
    {
        "__inputs": [
            {
                "name": "DS_PROMETHEUS",
                "label": "Prometheus",
                "description": "",
                "type": "datasource",
                "pluginId": "prometheus",
                "pluginName": "Prometheus"
            }
        ],
        "__elements": {},
        "__requires": [
            {
                "type": "panel",
                "id": "gauge",
                "name": "Gauge",
                "version": ""
            },
            {
                "type": "grafana",
                "id": "grafana",
                "name": "Grafana",
                "version": "10.3.1"
            },
            {
                "type": "datasource",
                "id": "prometheus",
                "name": "Prometheus",
                "version": "1.0.0"
            },
            {
                "type": "panel",
                "id": "stat",
                "name": "Stat",
                "version": ""
            },
            {
                "type": "panel",
                "id": "timeseries",
                "name": "Time series",
                "version": ""
            }
        ],
        "annotations": {
            "list": [
                {
                    "builtIn": 1,
                    "datasource": {
                        "type": "datasource",
                        "uid": "grafana"
                    },
                    "enable": true,
                    "hide": true,
                    "iconColor": "rgba(0, 211, 255, 1)",
                    "name": "Annotations & Alerts",
                    "target": {
                        "limit": 100,
                        "matchAny": false,
                        "tags": [],
                        "type": "dashboard"
                    },
                    "type": "dashboard"
                }
            ]
        },
        "description": "This is a modern 'Namespaces View' dashboard for your Kubernetes cluster(s). Made for kube-prometheus-stack and take advantage of the latest Grafana features. GitHub repository: https://github.com/dotdc/grafana-dashboards-kubernetes",
        "editable": false,
        "fiscalYearStartMonth": 0,
        "graphTooltip": 1,
        "links": [],
        "liveNow": false,
        "panels": [
            {
                "collapsed": false,
                "datasource": {
                    "type": "prometheus",
                    "uid": "grafana"
                },
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 0
                },
                "id": 38,
                "panels": [],
                "title": "Overview",
                "type": "row"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "decimals": 2,
                        "mappings": [],
                        "max": 1,
                        "min": 0,
                        "thresholds": {
                            "mode": "percentage",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "orange",
                                    "value": 50
                                },
                                {
                                    "color": "red",
                                    "value": 70
                                }
                            ]
                        },
                        "unit": "percentunit",
                        "unitScale": true
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 7,
                    "w": 6,
                    "x": 0,
                    "y": 1
                },
                "id": 46,
                "options": {
                    "minVizHeight": 75,
                    "minVizWidth": 75,
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "lastNotNull"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showThresholdLabels": false,
                    "showThresholdMarkers": true,
                    "sizing": "auto",
                    "text": {}
                },
                "pluginVersion": "10.3.1",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "sum(rate(container_cpu_usage_seconds_total{namespace=~\"$namespace\", image!=\"\", cluster=\"$cluster\"}[$__rate_interval])) / sum(machine_cpu_cores{cluster=\"$cluster\"})",
                        "instant": true,
                        "interval": "",
                        "legendFormat": "",
                        "range": false,
                        "refId": "A"
                    }
                ],
                "title": "Namespace(s) usage on total cluster CPU in %",
                "type": "gauge"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "decimals": 2,
                        "mappings": [],
                        "max": 1,
                        "min": 0,
                        "thresholds": {
                            "mode": "percentage",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "orange",
                                    "value": 50
                                },
                                {
                                    "color": "red",
                                    "value": 70
                                }
                            ]
                        },
                        "unit": "percentunit",
                        "unitScale": true
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 7,
                    "w": 6,
                    "x": 6,
                    "y": 1
                },
                "id": 48,
                "options": {
                    "minVizHeight": 75,
                    "minVizWidth": 75,
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "lastNotNull"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showThresholdLabels": false,
                    "showThresholdMarkers": true,
                    "sizing": "auto",
                    "text": {}
                },
                "pluginVersion": "10.3.1",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "exemplar": true,
                        "expr": "sum(container_memory_working_set_bytes{namespace=~\"$namespace\", image!=\"\", cluster=\"$cluster\"}) / sum(machine_memory_bytes{cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "",
                        "refId": "A"
                    }
                ],
                "title": "Namespace(s) usage on total cluster RAM in %",
                "type": "gauge"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short",
                        "unitScale": true
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 11,
                    "w": 12,
                    "x": 12,
                    "y": 1
                },
                "id": 32,
                "options": {
                    "legend": {
                        "calcs": [
                            "min",
                            "max",
                            "mean"
                        ],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": true,
                        "sortBy": "Max",
                        "sortDesc": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "expr": "sum(kube_pod_info{namespace=~\"$namespace\", cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Running Pods",
                        "refId": "A"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "expr": "sum(kube_service_info{namespace=~\"$namespace\", cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Services",
                        "refId": "B"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "expr": "sum(kube_ingress_info{namespace=~\"$namespace\", cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Ingresses",
                        "refId": "C"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "expr": "sum(kube_deployment_labels{namespace=~\"$namespace\", cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Deployments",
                        "refId": "D"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "expr": "sum(kube_statefulset_labels{namespace=~\"$namespace\", cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Statefulsets",
                        "refId": "E"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "expr": "sum(kube_daemonset_labels{namespace=~\"$namespace\", cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Daemonsets",
                        "refId": "F"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "expr": "sum(kube_persistentvolumeclaim_info{namespace=~\"$namespace\", cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Persistent Volume Claims",
                        "refId": "G"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "expr": "sum(kube_hpa_labels{namespace=~\"$namespace\", cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Horizontal Pod Autoscalers",
                        "refId": "H"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "expr": "sum(kube_configmap_info{namespace=~\"$namespace\", cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Configmaps",
                        "refId": "I"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "expr": "sum(kube_secret_info{namespace=~\"$namespace\", cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Secrets",
                        "refId": "J"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "expr": "sum(kube_networkpolicy_labels{namespace=~\"$namespace\", cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Network Policies",
                        "refId": "K"
                    }
                ],
                "title": "Kubernetes Resource Count",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "mappings": [],
                        "noValue": "0",
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "rgb(255, 255, 255)",
                                    "value": null
                                }
                            ]
                        },
                        "unit": "none",
                        "unitScale": true
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 4,
                    "w": 6,
                    "x": 0,
                    "y": 8
                },
                "id": 62,
                "options": {
                    "colorMode": "none",
                    "graphMode": "none",
                    "justifyMode": "center",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "lastNotNull"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "text": {},
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.3.1",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(rate(container_cpu_usage_seconds_total{namespace=~\"$namespace\", image!=\"\", cluster=\"$cluster\"}[$__rate_interval]))",
                        "interval": "",
                        "legendFormat": "Real",
                        "range": true,
                        "refId": "A"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "sum(kube_pod_container_resource_requests{namespace=~\"$namespace\", resource=\"cpu\", cluster=\"$cluster\"})",
                        "hide": false,
                        "legendFormat": "Requests",
                        "range": true,
                        "refId": "B"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "sum(kube_pod_container_resource_limits{namespace=~\"$namespace\", resource=\"cpu\", cluster=\"$cluster\"})",
                        "hide": false,
                        "legendFormat": "Limits",
                        "range": true,
                        "refId": "C"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "sum(machine_cpu_cores{cluster=\"$cluster\"})",
                        "hide": false,
                        "legendFormat": "Cluster Total",
                        "range": true,
                        "refId": "D"
                    }
                ],
                "title": "Namespace(s) CPU Usage in cores",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "mappings": [],
                        "noValue": "0",
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "rgb(255, 255, 255)",
                                    "value": null
                                }
                            ]
                        },
                        "unit": "bytes",
                        "unitScale": true
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 4,
                    "w": 6,
                    "x": 6,
                    "y": 8
                },
                "id": 64,
                "options": {
                    "colorMode": "none",
                    "graphMode": "none",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "lastNotNull"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "text": {},
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.3.1",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(container_memory_working_set_bytes{namespace=~\"$namespace\", image!=\"\", cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Real",
                        "range": true,
                        "refId": "A"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "sum(kube_pod_container_resource_requests{namespace=~\"$namespace\", resource=\"memory\", cluster=\"$cluster\"})",
                        "hide": false,
                        "legendFormat": "Requests",
                        "range": true,
                        "refId": "B"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "sum(kube_pod_container_resource_limits{namespace=~\"$namespace\", resource=\"memory\", cluster=\"$cluster\"})",
                        "hide": false,
                        "legendFormat": "Limits",
                        "range": true,
                        "refId": "C"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "sum(machine_memory_bytes{cluster=\"$cluster\"})",
                        "hide": false,
                        "legendFormat": "Cluster Total",
                        "range": true,
                        "refId": "D"
                    }
                ],
                "title": "Namespace(s) RAM Usage in bytes",
                "type": "stat"
            },
            {
                "collapsed": false,
                "datasource": {
                    "type": "prometheus",
                    "uid": "grafana"
                },
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 12
                },
                "id": 40,
                "panels": [],
                "title": "Resources",
                "type": "row"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "CPU CORES",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "none",
                        "unitScale": true
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 13
                },
                "id": 29,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "single",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(rate(container_cpu_usage_seconds_total{namespace=~\"$namespace\", image!=\"\", pod=~\"${created_by}.*\", cluster=\"$cluster\"}[$__rate_interval])) by (pod)",
                        "interval": "$resolution",
                        "legendFormat": "{{ pod }}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "CPU usage by Pod",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "bytes",
                        "unitScale": true
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 13
                },
                "id": 30,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "single",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(container_memory_working_set_bytes{namespace=~\"$namespace\", image!=\"\", pod=~\"${created_by}.*\", cluster=\"$cluster\"}) by (pod)",
                        "interval": "$resolution",
                        "legendFormat": "{{ pod }}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Memory usage by Pod",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "description": "",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "SECONDS",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineStyle": {
                                "fill": "solid"
                            },
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "decimals": 2,
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green"
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "s"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 21
                },
                "id": 68,
                "options": {
                    "legend": {
                        "calcs": [
                            "min",
                            "max",
                            "mean"
                        ],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": true,
                        "sortBy": "Max",
                        "sortDesc": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(rate(container_cpu_cfs_throttled_seconds_total{namespace=~\"$namespace\", image!=\"\", pod=~\"${created_by}.*\", cluster=\"$cluster\"}[$__rate_interval])) by (pod) > 0",
                        "interval": "$resolution",
                        "legendFormat": "{{ pod }}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "CPU Throttled seconds by pod",
                "type": "timeseries"
            },
            {
                "collapsed": false,
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 29
                },
                "id": 73,
                "panels": [],
                "title": "Kubernetes",
                "type": "row"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green"
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 9,
                    "w": 12,
                    "x": 0,
                    "y": 30
                },
                "id": 70,
                "options": {
                    "legend": {
                        "calcs": [
                            "min",
                            "max",
                            "mean"
                        ],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": true,
                        "sortBy": "Max",
                        "sortDesc": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(kube_pod_status_qos_class{namespace=~\"$namespace\", cluster=\"$cluster\"}) by (qos_class)",
                        "interval": "",
                        "legendFormat": "{{ qos_class }} pods",
                        "range": true,
                        "refId": "A"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "sum(kube_pod_info{namespace=~\"$namespace\", cluster=\"$cluster\"})",
                        "hide": false,
                        "legendFormat": "Total pods",
                        "range": true,
                        "refId": "B"
                    }
                ],
                "title": "Kubernetes Pods QoS classes",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green"
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 9,
                    "w": 12,
                    "x": 12,
                    "y": 30
                },
                "id": 72,
                "options": {
                    "legend": {
                        "calcs": [
                            "min",
                            "max",
                            "mean"
                        ],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": true,
                        "sortBy": "Max",
                        "sortDesc": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(kube_pod_status_reason{cluster=\"$cluster\"}) by (reason)",
                        "interval": "",
                        "legendFormat": "{{ reason }}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Kubernetes Pods Status Reason",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "description": "No data is generally a good thing here.",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "points",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green"
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 9,
                    "w": 12,
                    "x": 0,
                    "y": 39
                },
                "id": 74,
                "options": {
                    "legend": {
                        "calcs": [
                            "min",
                            "max",
                            "mean"
                        ],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": true,
                        "sortBy": "Max",
                        "sortDesc": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(increase(container_oom_events_total{namespace=~\"${namespace}\", cluster=\"$cluster\"}[$__rate_interval])) by (namespace, pod) > 0",
                        "interval": "",
                        "legendFormat": "namespace: {{ namespace }} - pod: {{ pod }}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "OOM Events by namespace, pod",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "description": "No data is generally a good thing here.",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "points",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green"
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 9,
                    "w": 12,
                    "x": 12,
                    "y": 39
                },
                "id": 75,
                "options": {
                    "legend": {
                        "calcs": [
                            "min",
                            "max",
                            "mean"
                        ],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": true,
                        "sortBy": "Max",
                        "sortDesc": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(increase(kube_pod_container_status_restarts_total{namespace=~\"${namespace}\", cluster=\"$cluster\"}[$__rate_interval])) by (namespace, pod) > 0",
                        "interval": "",
                        "legendFormat": "namespace: {{ namespace }} - pod: {{ pod }}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Container Restarts by namespace, pod",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "decimals": 0,
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green"
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "none"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 48
                },
                "id": 5,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "sum(kube_pod_container_status_ready{namespace=~\"$namespace\", pod=~\"${created_by}.*\", cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Ready",
                        "range": true,
                        "refId": "A"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "sum(kube_pod_container_status_running{namespace=~\"$namespace\", pod=~\"${created_by}.*\", cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Running",
                        "range": true,
                        "refId": "B"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "expr": "sum(kube_pod_container_status_waiting{namespace=~\"$namespace\", cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Waiting",
                        "refId": "C"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "expr": "sum(kube_pod_container_status_restarts_total{namespace=~\"$namespace\", cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Restarts Total",
                        "refId": "D"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "expr": "sum(kube_pod_container_status_terminated{namespace=~\"$namespace\", cluster=\"$cluster\"})",
                        "interval": "",
                        "legendFormat": "Terminated",
                        "refId": "E"
                    }
                ],
                "title": "Nb of pods by state",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "decimals": 0,
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green"
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "none"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 48
                },
                "id": 2,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "hidden",
                        "placement": "right",
                        "showLegend": false
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "sum(kube_pod_container_info{namespace=~\"$namespace\", pod=~\"${created_by}.*\", cluster=\"$cluster\"}) by (pod)",
                        "interval": "",
                        "legendFormat": "{{ pod }}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Nb of containers by pod",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green"
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 56
                },
                "id": 7,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": false
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(kube_deployment_status_replicas_available{namespace=~\"$namespace\", cluster=\"$cluster\"}) by (deployment)",
                        "interval": "",
                        "legendFormat": "{{ deployment }}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Replicas available by deployment",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green"
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 56
                },
                "id": 8,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": false
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "sum(kube_deployment_status_replicas_unavailable{namespace=~\"$namespace\", pod=~\"${created_by}.*\", cluster=\"$cluster\"}) by (deployment)",
                        "interval": "",
                        "legendFormat": "{{ deployment }}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Replicas unavailable by deployment",
                "type": "timeseries"
            },
            {
                "collapsed": false,
                "datasource": {
                    "type": "prometheus",
                    "uid": "grafana"
                },
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 64
                },
                "id": 42,
                "panels": [],
                "title": "Kubernetes Storage",
                "type": "row"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "decimals": 2,
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green"
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "percentunit"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 65
                },
                "id": 65,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": false
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "exemplar": true,
                        "expr": "sum(kubelet_volume_stats_used_bytes{namespace=~\"$namespace\", cluster=\"$cluster\"}) by (persistentvolumeclaim) / sum(kubelet_volume_stats_capacity_bytes{namespace=~\"$namespace\", cluster=\"$cluster\"}) by (persistentvolumeclaim)",
                        "interval": "",
                        "legendFormat": "{{ persistentvolumeclaim }}",
                        "refId": "A"
                    }
                ],
                "title": "Persistent Volumes - Capacity and usage in %",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "decimals": 2,
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green"
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "bytes"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 65
                },
                "id": 66,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": false
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "exemplar": true,
                        "expr": "sum(kubelet_volume_stats_used_bytes{namespace=~\"$namespace\", cluster=\"$cluster\"}) by (persistentvolumeclaim)",
                        "interval": "",
                        "legendFormat": "{{ persistentvolumeclaim }} - Used",
                        "refId": "A"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "exemplar": true,
                        "expr": "sum(kubelet_volume_stats_capacity_bytes{namespace=~\"$namespace\", cluster=\"$cluster\"}) by (persistentvolumeclaim)",
                        "hide": false,
                        "interval": "",
                        "legendFormat": "{{ persistentvolumeclaim }} - Capacity",
                        "refId": "B"
                    }
                ],
                "title": "Persistent Volumes - Capacity and usage in bytes",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "decimals": 2,
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green"
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "percentunit"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 73
                },
                "id": 27,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": false
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "exemplar": true,
                        "expr": "1 - sum(kubelet_volume_stats_inodes_used{namespace=~\"$namespace\", cluster=\"$cluster\"}) by (persistentvolumeclaim) / sum(kubelet_volume_stats_inodes{namespace=~\"$namespace\", cluster=\"$cluster\"}) by (persistentvolumeclaim)",
                        "interval": "",
                        "legendFormat": "{{ persistentvolumeclaim }}",
                        "refId": "A"
                    }
                ],
                "title": "Persistent Volumes - Inodes",
                "type": "timeseries"
            }
        ],
        "refresh": "30s",
        "schemaVersion": 39,
        "tags": [
            "Kubernetes",
            "Prometheus",
            "vm-k8s-stack"
        ],
        "templating": {
            "list": [
                {
                    "current": {

                    },
                    "hide": 0,
                    "includeAll": false,
                    "multi": false,
                    "name": "datasource",
                    "options": [

                    ],
                    "query": "prometheus",
                    "queryValue": "",
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "type": "datasource"
                },
                {
                    "current": {

                    },
                    "datasource": {
                        "type": "prometheus",
                        "uid": "${datasource}"
                    },
                    "definition": "label_values(kube_node_info,cluster)",
                    "hide": 2,
                    "includeAll": false,
                    "multi": false,
                    "name": "cluster",
                    "options": [

                    ],
                    "query": {
                        "qryType": 1,
                        "query": "label_values(kube_node_info,cluster)",
                        "refId": "PrometheusVariableQueryEditor-VariableQuery"
                    },
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": 1,
                    "type": "query"
                },
                {
                    "current": {

                    },
                    "datasource": {
                        "type": "prometheus",
                        "uid": "${datasource}"
                    },
                    "definition": "label_values(kube_pod_info{cluster=\"$cluster\"}, namespace)",
                    "hide": 0,
                    "includeAll": true,
                    "multi": true,
                    "name": "namespace",
                    "options": [

                    ],
                    "query": {
                        "query": "label_values(kube_pod_info{cluster=\"$cluster\"}, namespace)",
                        "refId": "StandardVariableQuery"
                    },
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": 1,
                    "tagValuesQuery": "",
                    "tagsQuery": "",
                    "type": "query",
                    "useTags": false
                },
                {
                    "current": {
                        "selected": false,
                        "text": "30s",
                        "value": "30s"
                    },
                    "hide": 0,
                    "includeAll": false,
                    "multi": false,
                    "name": "resolution",
                    "options": [
                        {
                            "selected": false,
                            "text": "1s",
                            "value": "1s"
                        },
                        {
                            "selected": false,
                            "text": "15s",
                            "value": "15s"
                        },
                        {
                            "selected": true,
                            "text": "30s",
                            "value": "30s"
                        },
                        {
                            "selected": false,
                            "text": "1m",
                            "value": "1m"
                        },
                        {
                            "selected": false,
                            "text": "3m",
                            "value": "3m"
                        },
                        {
                            "selected": false,
                            "text": "5m",
                            "value": "5m"
                        }
                    ],
                    "query": "1s, 15s, 30s, 1m, 3m, 5m",
                    "queryValue": "",
                    "skipUrlSync": false,
                    "type": "custom"
                },
                {
                    "current": {

                    },
                    "datasource": {
                        "type": "prometheus",
                        "uid": "${datasource}"
                    },
                    "definition": "label_values(kube_pod_info{namespace=~\"$namespace\", container!=\"\", cluster=\"$cluster\"},created_by_name)",
                    "description": "Can be used to filter on a specific deployment, statefulset or deamonset (only relevant panels).",
                    "hide": 0,
                    "includeAll": true,
                    "multi": true,
                    "name": "created_by",
                    "options": [

                    ],
                    "query": {
                        "query": "label_values(kube_pod_info{namespace=~\"$namespace\", container!=\"\", cluster=\"$cluster\"},created_by_name)",
                        "refId": "PrometheusVariableQueryEditor-VariableQuery"
                    },
                    "refresh": 2,
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": 1,
                    "type": "query"
                }
            ]
        },
        "time": {
            "from": "now-1h",
            "to": "now"
        },
        "timepicker": {

        },
        "timezone": "utc",
        "title": "Kubernetes / Views / Namespaces",
        "uid": "k8s_views_ns",
        "version": 34,
        "weekStart": ""
    }
---
# Source: victoria-metrics-k8s-stack/templates/grafana/dashboards/k8s-views-pods.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-k8s-views-pods
  labels:
    grafana_dashboard: "1"
    app: victoria-metrics-k8s-stack-grafana
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
data:
  k8s-views-pods.json:  |-
    {
        "__inputs": [
            {
                "name": "DS_PROMETHEUS",
                "label": "Prometheus",
                "description": "",
                "type": "datasource",
                "pluginId": "prometheus",
                "pluginName": "Prometheus"
            }
        ],
        "__elements": [],
        "__requires": [
            {
                "type": "grafana",
                "id": "grafana",
                "name": "Grafana",
                "version": "8.3.4"
            },
            {
                "type": "datasource",
                "id": "prometheus",
                "name": "Prometheus",
                "version": "5.0.0"
            },
            {
                "type": "panel",
                "id": "timeseries",
                "name": "Time series",
                "version": ""
            },
            {
                "type": "panel",
                "id": "stat",
                "name": "Stat",
                "version": ""
            },
            {
                "type": "panel",
                "id": "gauge",
                "name": "Gauge",
                "version": ""
            },
            {
                "type": "panel",
                "id": "table",
                "name": "Table",
                "version": ""
            }
        ],
        "annotations": {
            "list": [
                {
                    "builtIn": 1,
                    "datasource": {
                        "type": "datasource",
                        "uid": "grafana"
                    },
                    "enable": true,
                    "hide": true,
                    "iconColor": "rgba(0, 211, 255, 1)",
                    "name": "Annotations & Alerts",
                    "target": {
                        "limit": 100,
                        "matchAny": false,
                        "tags": [],
                        "type": "dashboard"
                    },
                    "type": "dashboard"
                }
            ]
        },
        "description": "This is a modern 'Pods View' dashboard for your Kubernetes cluster(s). Made for kube-prometheus-stack and take advantage of the latest Grafana features. GitHub repository: https://github.com/dotdc/grafana-dashboards-kubernetes",
        "editable": false,
        "fiscalYearStartMonth": 0,
        "graphTooltip": 1,
        "links": [],
        "liveNow": false,
        "panels": [
            {
                "collapsed": false,
                "datasource": {
                    "type": "prometheus",
                    "uid": "grafana"
                },
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 0
                },
                "id": 43,
                "panels": [],
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "grafana"
                        },
                        "refId": "A"
                    }
                ],
                "title": "Information",
                "type": "row"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "description": "Panel only works when a single pod is selected.",
                "fieldConfig": {
                    "defaults": {
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "rgb(255, 255, 255)",
                                    "value": null
                                }
                            ]
                        },
                        "unit": "none"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 2,
                    "w": 12,
                    "x": 0,
                    "y": 1
                },
                "id": 2,
                "options": {
                    "colorMode": "none",
                    "graphMode": "none",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "mean"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "textMode": "name",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.1",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "kube_pod_info{namespace=\"$namespace\", pod=\"$pod\", cluster=\"$cluster\"}",
                        "instant": true,
                        "interval": "",
                        "legendFormat": "{{ created_by_kind }}: {{ created_by_name }}",
                        "refId": "A"
                    }
                ],
                "title": "Created by",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "description": "Panel only works when a single pod is selected.",
                "fieldConfig": {
                    "defaults": {
                        "links": [
                            {
                                "title": "",
                                "url": "/d/k8s_views_nodes/kubernetes-views-nodes?var-datasource=${datasource}&var-node=${__data.fields.node}"
                            }
                        ],
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "rgb(255, 255, 255)",
                                    "value": null
                                }
                            ]
                        },
                        "unit": "none"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 2,
                    "w": 6,
                    "x": 12,
                    "y": 1
                },
                "id": 33,
                "options": {
                    "colorMode": "none",
                    "graphMode": "none",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "mean"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "textMode": "name",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.1",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "kube_pod_info{namespace=\"$namespace\", pod=\"$pod\", cluster=\"$cluster\"}",
                        "instant": true,
                        "interval": "",
                        "legendFormat": "{{ node }}",
                        "refId": "A"
                    }
                ],
                "title": "Running on",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "description": "Panel only works when a single pod is selected.",
                "fieldConfig": {
                    "defaults": {
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "rgb(255, 255, 255)",
                                    "value": null
                                }
                            ]
                        },
                        "unit": "none"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 2,
                    "w": 6,
                    "x": 18,
                    "y": 1
                },
                "id": 41,
                "options": {
                    "colorMode": "none",
                    "graphMode": "none",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "mean"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "textMode": "name",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.1",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "kube_pod_info{namespace=\"$namespace\", pod=\"$pod\", cluster=\"$cluster\"}",
                        "instant": true,
                        "interval": "",
                        "legendFormat": "{{ pod_ip }}",
                        "refId": "A"
                    }
                ],
                "title": "Pod IP",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "description": "Panel only works when a single pod is selected.",
                "fieldConfig": {
                    "defaults": {
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "rgb(255, 255, 255)",
                                    "value": null
                                }
                            ]
                        },
                        "unit": "none"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 2,
                    "w": 5,
                    "x": 0,
                    "y": 3
                },
                "id": 52,
                "options": {
                    "colorMode": "none",
                    "graphMode": "none",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "mean"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "textMode": "name",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.1",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "kube_pod_info{namespace=\"$namespace\", pod=\"$pod\", priority_class!=\"\", cluster=\"$cluster\"}",
                        "format": "time_series",
                        "instant": true,
                        "interval": "",
                        "legendFormat": "{{ priority_class }}",
                        "range": false,
                        "refId": "A"
                    }
                ],
                "title": "Priority Class",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "description": "Panel only works when a single pod is selected.",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "thresholds"
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                }
                            ]
                        },
                        "unit": "none"
                    },
                    "overrides": [
                        {
                            "matcher": {
                                "id": "byName",
                                "options": "Burstable"
                            },
                            "properties": [
                                {
                                    "id": "color",
                                    "value": {
                                        "fixedColor": "red",
                                        "mode": "fixed"
                                    }
                                }
                            ]
                        },
                        {
                            "matcher": {
                                "id": "byName",
                                "options": "BestEffort"
                            },
                            "properties": [
                                {
                                    "id": "color",
                                    "value": {
                                        "fixedColor": "orange",
                                        "mode": "fixed"
                                    }
                                }
                            ]
                        }
                    ]
                },
                "gridPos": {
                    "h": 2,
                    "w": 7,
                    "x": 5,
                    "y": 3
                },
                "id": 53,
                "options": {
                    "colorMode": "value",
                    "graphMode": "none",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "textMode": "name",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.1",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "kube_pod_status_qos_class{namespace=\"$namespace\", pod=\"$pod\", cluster=\"$cluster\"} > 0",
                        "instant": true,
                        "interval": "",
                        "legendFormat": "{{ qos_class }}",
                        "refId": "A"
                    }
                ],
                "title": "QOS Class",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "description": "Panel only works when a single pod is selected.",
                "fieldConfig": {
                    "defaults": {
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "text",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 1
                                }
                            ]
                        },
                        "unit": "none"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 2,
                    "w": 6,
                    "x": 12,
                    "y": 3
                },
                "id": 56,
                "options": {
                    "colorMode": "value",
                    "graphMode": "none",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "textMode": "name",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.1",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "kube_pod_container_status_last_terminated_reason{namespace=\"$namespace\", pod=\"$pod\", cluster=\"$cluster\"}",
                        "instant": true,
                        "interval": "",
                        "legendFormat": "{{ reason }}",
                        "refId": "A"
                    }
                ],
                "title": "Last Terminated Reason",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "description": "Panel only works when a single pod is selected.",
                "fieldConfig": {
                    "defaults": {
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "text",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 1
                                },
                                {
                                    "color": "#EAB839",
                                    "value": 2
                                }
                            ]
                        },
                        "unit": "none"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 2,
                    "w": 6,
                    "x": 18,
                    "y": 3
                },
                "id": 57,
                "options": {
                    "colorMode": "value",
                    "graphMode": "none",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [],
                        "fields": "",
                        "values": true
                    },
                    "showPercentChange": false,
                    "textMode": "value",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.1",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "kube_pod_container_status_last_terminated_exitcode{namespace=\"$namespace\", pod=\"$pod\", cluster=\"$cluster\"}",
                        "instant": true,
                        "interval": "",
                        "legendFormat": "__auto",
                        "range": false,
                        "refId": "A"
                    }
                ],
                "title": "Last Terminated Exit Code",
                "type": "stat"
            },
            {
                "collapsed": false,
                "datasource": {
                    "type": "prometheus",
                    "uid": "grafana"
                },
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 5
                },
                "id": 47,
                "panels": [],
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "grafana"
                        },
                        "refId": "A"
                    }
                ],
                "title": "Resources",
                "type": "row"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "fixedColor": "blue",
                            "mode": "fixed"
                        },
                        "decimals": 2,
                        "mappings": [],
                        "max": 1,
                        "min": 0,
                        "thresholds": {
                            "mode": "percentage",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "#EAB839",
                                    "value": 60
                                },
                                {
                                    "color": "red",
                                    "value": 75
                                }
                            ]
                        },
                        "unit": "percentunit"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 3,
                    "x": 0,
                    "y": 6
                },
                "id": 39,
                "options": {
                    "minVizHeight": 75,
                    "minVizWidth": 75,
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "last"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showThresholdLabels": false,
                    "showThresholdMarkers": true,
                    "sizing": "auto"
                },
                "pluginVersion": "10.4.1",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "sum(rate(container_cpu_usage_seconds_total{namespace=\"$namespace\", pod=~\"$pod\", image!=\"\", cluster=\"$cluster\"}[$__rate_interval])) / sum(kube_pod_container_resource_requests{namespace=\"$namespace\", pod=~\"$pod\", resource=\"cpu\", job=~\"$job\", cluster=\"$cluster\"})",
                        "instant": true,
                        "interval": "$resolution",
                        "legendFormat": "Requests",
                        "refId": "A"
                    }
                ],
                "title": "Total pod CPU Requests usage",
                "type": "gauge"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "decimals": 2,
                        "mappings": [],
                        "max": 1,
                        "min": 0,
                        "thresholds": {
                            "mode": "percentage",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "#EAB839",
                                    "value": 60
                                },
                                {
                                    "color": "red",
                                    "value": 75
                                }
                            ]
                        },
                        "unit": "percentunit"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 3,
                    "x": 3,
                    "y": 6
                },
                "id": 48,
                "options": {
                    "minVizHeight": 75,
                    "minVizWidth": 75,
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "last"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showThresholdLabels": false,
                    "showThresholdMarkers": true,
                    "sizing": "auto"
                },
                "pluginVersion": "10.4.1",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "sum(rate(container_cpu_usage_seconds_total{namespace=\"$namespace\", pod=~\"$pod\", image!=\"\", cluster=\"$cluster\"}[$__rate_interval])) / sum(kube_pod_container_resource_limits{namespace=\"$namespace\", pod=~\"$pod\", resource=\"cpu\", job=~\"$job\", cluster=\"$cluster\"})",
                        "instant": true,
                        "interval": "$resolution",
                        "legendFormat": "Limits",
                        "refId": "A"
                    }
                ],
                "title": "Total pod CPU Limits usage",
                "type": "gauge"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "fixedColor": "blue",
                            "mode": "fixed"
                        },
                        "decimals": 2,
                        "mappings": [],
                        "max": 1,
                        "min": 0,
                        "thresholds": {
                            "mode": "percentage",
                            "steps": [
                                {
                                    "color": "blue",
                                    "value": null
                                },
                                {
                                    "color": "#EAB839",
                                    "value": 80
                                },
                                {
                                    "color": "red",
                                    "value": 99
                                }
                            ]
                        },
                        "unit": "percentunit"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 3,
                    "x": 6,
                    "y": 6
                },
                "id": 40,
                "options": {
                    "minVizHeight": 75,
                    "minVizWidth": 75,
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "last"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showThresholdLabels": false,
                    "showThresholdMarkers": true,
                    "sizing": "auto"
                },
                "pluginVersion": "10.4.1",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "sum(container_memory_working_set_bytes{namespace=\"$namespace\", pod=~\"$pod\", image!=\"\", cluster=\"$cluster\"}) / sum(kube_pod_container_resource_requests{namespace=\"$namespace\", pod=~\"$pod\", resource=\"memory\", job=~\"$job\", cluster=\"$cluster\"})",
                        "instant": true,
                        "interval": "$resolution",
                        "legendFormat": "Requests",
                        "refId": "A"
                    }
                ],
                "title": "Total pod RAM Requests usage",
                "type": "gauge"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "decimals": 2,
                        "mappings": [],
                        "max": 1,
                        "min": 0,
                        "thresholds": {
                            "mode": "percentage",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "#EAB839",
                                    "value": 60
                                },
                                {
                                    "color": "red",
                                    "value": 75
                                }
                            ]
                        },
                        "unit": "percentunit"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 3,
                    "x": 9,
                    "y": 6
                },
                "id": 49,
                "options": {
                    "minVizHeight": 75,
                    "minVizWidth": 75,
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "last"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showThresholdLabels": false,
                    "showThresholdMarkers": true,
                    "sizing": "auto"
                },
                "pluginVersion": "10.4.1",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "sum(container_memory_working_set_bytes{namespace=\"$namespace\", pod=~\"$pod\", image!=\"\", cluster=\"$cluster\"}) / sum(kube_pod_container_resource_limits{namespace=\"$namespace\", pod=~\"$pod\", resource=\"memory\", job=~\"$job\", cluster=\"$cluster\"}) ",
                        "instant": true,
                        "interval": "$resolution",
                        "legendFormat": "Limits",
                        "refId": "B"
                    }
                ],
                "title": "Total pod RAM Limits usage",
                "type": "gauge"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "custom": {
                            "align": "auto",
                            "cellOptions": {
                                "type": "auto"
                            },
                            "filterable": false,
                            "inspect": false,
                            "minWidth": 100
                        },
                        "decimals": 4,
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "blue",
                                    "value": null
                                }
                            ]
                        },
                        "unit": "none"
                    },
                    "overrides": [
                        {
                            "matcher": {
                                "id": "byName",
                                "options": "Memory Requests"
                            },
                            "properties": [
                                {
                                    "id": "unit",
                                    "value": "bytes"
                                },
                                {
                                    "id": "decimals",
                                    "value": 2
                                }
                            ]
                        },
                        {
                            "matcher": {
                                "id": "byName",
                                "options": "Memory Limits"
                            },
                            "properties": [
                                {
                                    "id": "unit",
                                    "value": "bytes"
                                },
                                {
                                    "id": "decimals",
                                    "value": 2
                                }
                            ]
                        },
                        {
                            "matcher": {
                                "id": "byName",
                                "options": "Memory Used"
                            },
                            "properties": [
                                {
                                    "id": "unit",
                                    "value": "bytes"
                                },
                                {
                                    "id": "decimals",
                                    "value": 2
                                }
                            ]
                        }
                    ]
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 6
                },
                "id": 38,
                "options": {
                    "cellHeight": "sm",
                    "footer": {
                        "countRows": false,
                        "fields": "",
                        "reducer": [
                            "sum"
                        ],
                        "show": false
                    },
                    "showHeader": true,
                    "sortBy": []
                },
                "pluginVersion": "10.4.1",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "sum(kube_pod_container_resource_requests{namespace=\"$namespace\", pod=~\"$pod\", resource=\"cpu\", job=~\"$job\", cluster=\"$cluster\"}) by (container)",
                        "format": "table",
                        "instant": true,
                        "interval": "",
                        "intervalFactor": 1,
                        "legendFormat": "",
                        "refId": "A"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "sum(kube_pod_container_resource_limits{namespace=\"$namespace\", pod=~\"$pod\", resource=\"cpu\", job=~\"$job\", cluster=\"$cluster\"}) by (container)",
                        "format": "table",
                        "instant": true,
                        "interval": "",
                        "intervalFactor": 1,
                        "legendFormat": "",
                        "refId": "B"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "sum(kube_pod_container_resource_requests{namespace=\"$namespace\", pod=~\"$pod\", resource=\"memory\", job=~\"$job\", cluster=\"$cluster\"}) by (container)",
                        "format": "table",
                        "instant": true,
                        "interval": "",
                        "legendFormat": "",
                        "refId": "C"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "sum(kube_pod_container_resource_limits{namespace=\"$namespace\", pod=~\"$pod\", resource=\"memory\", job=~\"$job\", cluster=\"$cluster\"}) by (container)",
                        "format": "table",
                        "instant": true,
                        "interval": "",
                        "legendFormat": "",
                        "refId": "D"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "sum(rate(container_cpu_usage_seconds_total{namespace=\"$namespace\", pod=~\"$pod\", image!=\"\", container!=\"\", cluster=\"$cluster\"}[$__rate_interval])) by (container)",
                        "format": "table",
                        "hide": false,
                        "instant": true,
                        "legendFormat": "__auto",
                        "range": false,
                        "refId": "E"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "sum(container_memory_working_set_bytes{namespace=\"$namespace\", pod=~\"$pod\", image!=\"\", container!=\"\", cluster=\"$cluster\"}) by (container)",
                        "format": "table",
                        "hide": false,
                        "instant": true,
                        "range": false,
                        "refId": "F"
                    }
                ],
                "title": "Resources by container",
                "transformations": [
                    {
                        "id": "seriesToColumns",
                        "options": {
                            "byField": "container"
                        }
                    },
                    {
                        "id": "organize",
                        "options": {
                            "excludeByName": {
                                "Time": true,
                                "Time 1": true,
                                "Time 2": true,
                                "Time 4": true,
                                "__name__": true,
                                "__name__ 1": true,
                                "__name__ 2": true,
                                "__name__ 3": true,
                                "__name__ 4": true,
                                "container": false,
                                "endpoint": true,
                                "endpoint 2": true,
                                "endpoint 3": true,
                                "endpoint 4": true,
                                "instance": true,
                                "instance 2": true,
                                "instance 3": true,
                                "instance 4": true,
                                "job": true,
                                "job 2": true,
                                "job 3": true,
                                "job 4": true,
                                "namespace": true,
                                "namespace 2": true,
                                "namespace 3": true,
                                "namespace 4": true,
                                "node": true,
                                "node 2": true,
                                "node 3": true,
                                "node 4": true,
                                "pod": true,
                                "pod 2": true,
                                "pod 3": true,
                                "pod 4": true,
                                "resource 1": true,
                                "resource 2": true,
                                "resource 3": true,
                                "resource 4": true,
                                "service": true,
                                "service 2": true,
                                "service 3": true,
                                "service 4": true,
                                "uid 1": true,
                                "uid 2": true,
                                "uid 3": true,
                                "uid 4": true,
                                "unit 1": true,
                                "unit 2": true,
                                "unit 3": true,
                                "unit 4": true
                            },
                            "indexByName": {
                                "Time 1": 7,
                                "Time 2": 8,
                                "Time 3": 9,
                                "Time 4": 10,
                                "Time 5": 11,
                                "Time 6": 12,
                                "Value #A": 2,
                                "Value #B": 3,
                                "Value #C": 5,
                                "Value #D": 6,
                                "Value #E": 1,
                                "Value #F": 4,
                                "container": 0
                            },
                            "renameByName": {
                                "Value #A": "CPU Requests",
                                "Value #B": "CPU Limits",
                                "Value #C": "Memory Requests",
                                "Value #D": "Memory Limits",
                                "Value #E": "CPU Used",
                                "Value #F": "Memory Used",
                                "container": "Container"
                            }
                        }
                    }
                ],
                "type": "table"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "thresholds"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "Percent",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "area"
                            }
                        },
                        "mappings": [],
                        "max": 1,
                        "min": 0,
                        "thresholds": {
                            "mode": "percentage",
                            "steps": [
                                {
                                    "color": "red",
                                    "value": null
                                },
                                {
                                    "color": "yellow",
                                    "value": 20
                                },
                                {
                                    "color": "green",
                                    "value": 30
                                },
                                {
                                    "color": "yellow",
                                    "value": 70
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "percentunit"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 14
                },
                "id": 50,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(rate(container_cpu_usage_seconds_total{namespace=\"$namespace\", pod=~\"$pod\", image!=\"\", cluster=\"$cluster\"}[$__rate_interval])) by (container) / sum(kube_pod_container_resource_requests{namespace=\"$namespace\", pod=~\"$pod\", resource=\"cpu\", job=~\"$job\", cluster=\"$cluster\"}) by (container)",
                        "interval": "$resolution",
                        "legendFormat": "{{ container }}  REQUESTS",
                        "range": true,
                        "refId": "A"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "sum(rate(container_cpu_usage_seconds_total{namespace=\"$namespace\", pod=~\"$pod\", image!=\"\", cluster=\"$cluster\"}[$__rate_interval])) by (container) / sum(kube_pod_container_resource_limits{namespace=\"$namespace\", pod=~\"$pod\", resource=\"cpu\", job=~\"$job\", cluster=\"$cluster\"}) by (container)",
                        "hide": false,
                        "legendFormat": "{{ container }}  LIMITS",
                        "range": true,
                        "refId": "B"
                    }
                ],
                "title": "CPU Usage / Requests & Limits by container",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "fixedColor": "blue",
                            "mode": "thresholds"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "Percent",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineStyle": {
                                "fill": "solid"
                            },
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "area"
                            }
                        },
                        "mappings": [],
                        "max": 1,
                        "min": 0,
                        "thresholds": {
                            "mode": "percentage",
                            "steps": [
                                {
                                    "color": "red",
                                    "value": null
                                },
                                {
                                    "color": "yellow",
                                    "value": 20
                                },
                                {
                                    "color": "green",
                                    "value": 30
                                },
                                {
                                    "color": "#EAB839",
                                    "value": 70
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "percentunit"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 14
                },
                "id": 30,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(container_memory_working_set_bytes{namespace=\"$namespace\", pod=~\"$pod\", image!=\"\", cluster=\"$cluster\"}) by (container) / sum(kube_pod_container_resource_requests{namespace=\"$namespace\", pod=~\"$pod\", resource=\"memory\", job=~\"$job\", cluster=\"$cluster\"}) by (container)",
                        "interval": "",
                        "legendFormat": "{{ container }} REQUESTS",
                        "range": true,
                        "refId": "A"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "expr": "sum(container_memory_working_set_bytes{namespace=\"$namespace\", pod=~\"$pod\", image!=\"\", cluster=\"$cluster\"}) by (container) / sum(kube_pod_container_resource_limits{namespace=\"$namespace\", pod=~\"$pod\", resource=\"memory\", job=~\"$job\", cluster=\"$cluster\"}) by (container)",
                        "hide": false,
                        "legendFormat": "{{ container }} LIMITS",
                        "range": true,
                        "refId": "B"
                    }
                ],
                "title": "Memory Usage / Requests & Limits by container",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "CPU Cores",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "decimals": 4,
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "none"
                    },
                    "overrides": [
                        {
                            "matcher": {
                                "id": "byName",
                                "options": "limit"
                            },
                            "properties": [
                                {
                                    "id": "color",
                                    "value": {
                                        "fixedColor": "#F2495C",
                                        "mode": "fixed"
                                    }
                                },
                                {
                                    "id": "custom.fillOpacity",
                                    "value": 0
                                }
                            ]
                        }
                    ]
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 22
                },
                "id": 29,
                "options": {
                    "legend": {
                        "calcs": [
                            "min",
                            "max",
                            "mean"
                        ],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(rate(container_cpu_usage_seconds_total{namespace=\"$namespace\", pod=~\"$pod\", image!=\"\", container!=\"\", cluster=\"$cluster\"}[$__rate_interval])) by (container)",
                        "interval": "$resolution",
                        "legendFormat": "{{ container }}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "CPU Usage by container",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "Bytes",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineStyle": {
                                "fill": "solid"
                            },
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "decimals": 2,
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "bytes"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 22
                },
                "id": 51,
                "options": {
                    "legend": {
                        "calcs": [
                            "min",
                            "max",
                            "mean"
                        ],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(container_memory_working_set_bytes{namespace=\"$namespace\", pod=~\"$pod\", image!=\"\", container!=\"\", cluster=\"$cluster\"}) by (container)",
                        "interval": "",
                        "legendFormat": "{{ container }}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Memory Usage by container",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "description": "",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "SECONDS",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineStyle": {
                                "fill": "solid"
                            },
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "decimals": 2,
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "s"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 30
                },
                "id": 59,
                "options": {
                    "legend": {
                        "calcs": [
                            "min",
                            "max",
                            "mean"
                        ],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": true,
                        "sortBy": "Max",
                        "sortDesc": true
                    },
                    "tooltip": {
                        "mode": "single",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(rate(container_cpu_cfs_throttled_seconds_total{namespace=~\"$namespace\", pod=~\"$pod\", image!=\"\", container!=\"\", cluster=\"$cluster\"}[$__rate_interval])) by (container)",
                        "interval": "$resolution",
                        "legendFormat": "{{ container }}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "CPU Throttled seconds by container",
                "type": "timeseries"
            },
            {
                "collapsed": false,
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 38
                },
                "id": 62,
                "panels": [],
                "title": "Kubernetes",
                "type": "row"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "fixedColor": "blue",
                            "mode": "thresholds"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "Percent",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineStyle": {
                                "fill": "solid"
                            },
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "area"
                            }
                        },
                        "mappings": [],
                        "max": 1,
                        "min": 0,
                        "thresholds": {
                            "mode": "percentage",
                            "steps": [
                                {
                                    "color": "red",
                                    "value": null
                                },
                                {
                                    "color": "yellow",
                                    "value": 20
                                },
                                {
                                    "color": "green",
                                    "value": 30
                                },
                                {
                                    "color": "#EAB839",
                                    "value": 70
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "none"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 39
                },
                "id": 60,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(increase(container_oom_events_total{namespace=\"${namespace}\", pod=\"${pod}\", container!=\"\", cluster=\"$cluster\"}[$__rate_interval])) by (container)",
                        "interval": "",
                        "legendFormat": "{{ container }}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "OOM Events by container",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "fixedColor": "blue",
                            "mode": "thresholds"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "Percent",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineStyle": {
                                "fill": "solid"
                            },
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "area"
                            }
                        },
                        "mappings": [],
                        "max": 1,
                        "min": 0,
                        "thresholds": {
                            "mode": "percentage",
                            "steps": [
                                {
                                    "color": "red",
                                    "value": null
                                },
                                {
                                    "color": "yellow",
                                    "value": 20
                                },
                                {
                                    "color": "green",
                                    "value": 30
                                },
                                {
                                    "color": "#EAB839",
                                    "value": 70
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "none"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 39
                },
                "id": 61,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(increase(kube_pod_container_status_restarts_total{namespace=~\"${namespace}\", pod=\"${pod}\", container!=\"\", job=~\"$job\", cluster=\"$cluster\"}[$__rate_interval])) by (container)",
                        "interval": "",
                        "legendFormat": "{{ container }}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Container Restarts by container",
                "type": "timeseries"
            },
            {
                "collapsed": false,
                "datasource": {
                    "type": "prometheus",
                    "uid": "grafana"
                },
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 47
                },
                "id": 45,
                "panels": [],
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "grafana"
                        },
                        "refId": "A"
                    }
                ],
                "title": "Network",
                "type": "row"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "bytes"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 48
                },
                "id": 31,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "list",
                        "placement": "bottom",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "exemplar": true,
                        "expr": "sum(rate(container_network_receive_bytes_total{namespace=\"$namespace\", pod=~\"$pod\", cluster=\"$cluster\"}[$__rate_interval]))",
                        "interval": "$resolution",
                        "legendFormat": "Received",
                        "refId": "A"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "exemplar": true,
                        "expr": "- sum(rate(container_network_transmit_bytes_total{namespace=\"$namespace\", pod=~\"$pod\", cluster=\"$cluster\"}[$__rate_interval]))",
                        "interval": "$resolution",
                        "legendFormat": "Transmitted",
                        "refId": "B"
                    }
                ],
                "title": "Network - Bandwidth",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "pps"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 48
                },
                "id": 34,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "list",
                        "placement": "bottom",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "exemplar": true,
                        "expr": "sum(rate(container_network_receive_packets_total{namespace=\"$namespace\", pod=~\"$pod\", cluster=\"$cluster\"}[$__rate_interval]))",
                        "interval": "$resolution",
                        "legendFormat": "Received",
                        "refId": "A"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "exemplar": true,
                        "expr": "- sum(rate(container_network_transmit_packets_total{namespace=\"$namespace\", pod=~\"$pod\", cluster=\"$cluster\"}[$__rate_interval]))",
                        "interval": "$resolution",
                        "legendFormat": "Transmitted",
                        "refId": "B"
                    }
                ],
                "title": "Network - Packets Rate",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "pps"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 56
                },
                "id": 36,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "list",
                        "placement": "bottom",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "exemplar": true,
                        "expr": "sum(rate(container_network_receive_packets_dropped_total{namespace=\"$namespace\", pod=~\"$pod\", cluster=\"$cluster\"}[$__rate_interval]))",
                        "interval": "$resolution",
                        "legendFormat": "Received",
                        "refId": "A"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "exemplar": true,
                        "expr": "- sum(rate(container_network_transmit_packets_dropped_total{namespace=\"$namespace\", pod=~\"$pod\", cluster=\"$cluster\"}[$__rate_interval]))",
                        "interval": "$resolution",
                        "legendFormat": "Transmitted",
                        "refId": "B"
                    }
                ],
                "title": "Network - Packets Dropped",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "${datasource}"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 25,
                            "gradientMode": "opacity",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "smooth",
                            "lineWidth": 2,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "pps"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 56
                },
                "id": 37,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "list",
                        "placement": "bottom",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "8.3.3",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "exemplar": true,
                        "expr": "sum(rate(container_network_receive_errors_total{namespace=\"$namespace\", pod=~\"$pod\", cluster=\"$cluster\"}[$__rate_interval]))",
                        "interval": "$resolution",
                        "legendFormat": "Received",
                        "refId": "A"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "${datasource}"
                        },
                        "exemplar": true,
                        "expr": "- sum(rate(container_network_transmit_errors_total{namespace=\"$namespace\", pod=~\"$pod\", cluster=\"$cluster\"}[$__rate_interval]))",
                        "interval": "$resolution",
                        "legendFormat": "Transmitted",
                        "refId": "B"
                    }
                ],
                "title": "Network - Errors",
                "type": "timeseries"
            }
        ],
        "refresh": "30s",
        "schemaVersion": 39,
        "tags": [
            "Kubernetes",
            "Prometheus",
            "vm-k8s-stack"
        ],
        "templating": {
            "list": [
                {
                    "current": {
                        "selected": false,
                        "text": "",
                        "value": ""
                    },
                    "hide": 0,
                    "includeAll": false,
                    "multi": false,
                    "name": "datasource",
                    "options": [

                    ],
                    "query": "prometheus",
                    "queryValue": "",
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "type": "datasource"
                },
                {
                    "current": {
                        "isNone": true,
                        "selected": false,
                        "text": "None",
                        "value": ""
                    },
                    "datasource": {
                        "type": "prometheus",
                        "uid": "${datasource}"
                    },
                    "definition": "label_values(kube_node_info,cluster)",
                    "hide": 2,
                    "includeAll": false,
                    "multi": false,
                    "name": "cluster",
                    "options": [

                    ],
                    "query": {
                        "qryType": 1,
                        "query": "label_values(kube_node_info,cluster)",
                        "refId": "PrometheusVariableQueryEditor-VariableQuery"
                    },
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": 1,
                    "type": "query"
                },
                {
                    "current": {
                        "selected": false,
                        "text": "monitoring",
                        "value": "monitoring"
                    },
                    "datasource": {
                        "type": "prometheus",
                        "uid": "${datasource}"
                    },
                    "definition": "label_values(kube_pod_info{cluster=\"$cluster\"}, namespace)",
                    "hide": 0,
                    "includeAll": false,
                    "multi": false,
                    "name": "namespace",
                    "options": [

                    ],
                    "query": {
                        "query": "label_values(kube_pod_info{cluster=\"$cluster\"}, namespace)",
                        "refId": "Prometheus-namespace-Variable-Query"
                    },
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": 1,
                    "tagValuesQuery": "",
                    "tagsQuery": "",
                    "type": "query",
                    "useTags": false
                },
                {
                    "current": {
                        "selected": false,
                        "text": "",
                        "value": ""
                    },
                    "datasource": {
                        "type": "prometheus",
                        "uid": "${datasource}"
                    },
                    "definition": "label_values(kube_pod_info{namespace=\"$namespace\", cluster=\"$cluster\"}, pod)",
                    "hide": 0,
                    "includeAll": true,
                    "multi": true,
                    "name": "pod",
                    "options": [

                    ],
                    "query": {
                        "query": "label_values(kube_pod_info{namespace=\"$namespace\", cluster=\"$cluster\"}, pod)",
                        "refId": "Prometheus-pod-Variable-Query"
                    },
                    "refresh": 2,
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": 1,
                    "tagValuesQuery": "",
                    "tagsQuery": "",
                    "type": "query",
                    "useTags": false
                },
                {
                    "current": {
                        "selected": false,
                        "text": "30s",
                        "value": "30s"
                    },
                    "hide": 0,
                    "includeAll": false,
                    "multi": false,
                    "name": "resolution",
                    "options": [
                        {
                            "selected": false,
                            "text": "1s",
                            "value": "1s"
                        },
                        {
                            "selected": false,
                            "text": "15s",
                            "value": "15s"
                        },
                        {
                            "selected": true,
                            "text": "30s",
                            "value": "30s"
                        },
                        {
                            "selected": false,
                            "text": "1m",
                            "value": "1m"
                        },
                        {
                            "selected": false,
                            "text": "3m",
                            "value": "3m"
                        },
                        {
                            "selected": false,
                            "text": "5m",
                            "value": "5m"
                        }
                    ],
                    "query": "1s, 15s, 30s, 1m, 3m, 5m",
                    "queryValue": "",
                    "skipUrlSync": false,
                    "type": "custom"
                },
                {
                    "current": {
                        "selected": false,
                        "text": "kube-state-metrics",
                        "value": "kube-state-metrics"
                    },
                    "datasource": {
                        "type": "prometheus",
                        "uid": "${datasource}"
                    },
                    "definition": "label_values(kube_pod_info{namespace=\"$namespace\", cluster=\"$cluster\"},job)",
                    "hide": 0,
                    "includeAll": false,
                    "multi": true,
                    "name": "job",
                    "options": [

                    ],
                    "query": {
                        "qryType": 1,
                        "query": "label_values(kube_pod_info{namespace=\"$namespace\", cluster=\"$cluster\"},job)",
                        "refId": "PrometheusVariableQueryEditor-VariableQuery"
                    },
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": 1,
                    "type": "query"
                }
            ]
        },
        "time": {
            "from": "now-1h",
            "to": "now"
        },
        "timepicker": {

        },
        "timezone": "utc",
        "title": "Kubernetes / Views / Pods",
        "uid": "k8s_views_pods",
        "version": 28,
        "weekStart": ""
    }
---
# Source: victoria-metrics-k8s-stack/templates/grafana/dashboards/operator.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-operator
  labels:
    grafana_dashboard: "1"
    app: victoria-metrics-k8s-stack-grafana
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
data:
  operator.json:  |-
    {
        "__inputs": [],
        "__elements": {},
        "__requires": [
            {
                "type": "grafana",
                "id": "grafana",
                "name": "Grafana",
                "version": "10.4.0"
            },
            {
                "type": "datasource",
                "id": "prometheus",
                "name": "Prometheus",
                "version": "1.0.0"
            },
            {
                "type": "panel",
                "id": "stat",
                "name": "Stat",
                "version": ""
            },
            {
                "type": "panel",
                "id": "text",
                "name": "Text",
                "version": ""
            },
            {
                "type": "panel",
                "id": "timeseries",
                "name": "Time series",
                "version": ""
            }
        ],
        "annotations": {
            "list": [
                {
                    "builtIn": 1,
                    "datasource": {
                        "type": "datasource",
                        "uid": "grafana"
                    },
                    "enable": true,
                    "hide": true,
                    "iconColor": "rgba(0, 211, 255, 1)",
                    "name": "Annotations & Alerts",
                    "target": {
                        "limit": 100,
                        "matchAny": false,
                        "tags": [],
                        "type": "dashboard"
                    },
                    "type": "dashboard"
                }
            ]
        },
        "description": "Overview for operator VictoriaMetrics v0.25.0 or higher",
        "editable": false,
        "fiscalYearStartMonth": 0,
        "graphTooltip": 0,
        "id": null,
        "links": [],
        "liveNow": false,
        "panels": [
            {
                "collapsed": false,
                "datasource": {
                    "type": "prometheus",
                    "uid": "PB894574A363DF0AF"
                },
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 0
                },
                "id": 8,
                "panels": [],
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "PB894574A363DF0AF"
                        },
                        "refId": "A"
                    }
                ],
                "title": "Overview",
                "type": "row"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "gridPos": {
                    "h": 3,
                    "w": 4,
                    "x": 0,
                    "y": 1
                },
                "id": 24,
                "options": {
                    "code": {
                        "language": "plaintext",
                        "showLineNumbers": false,
                        "showMiniMap": false
                    },
                    "content": "<div style=\"text-align: center;\">$version</div>",
                    "mode": "markdown"
                },
                "pluginVersion": "10.4.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "refId": "A"
                    }
                ],
                "title": "Version",
                "type": "text"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Number of objects at kubernetes cluster per each controller",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "thresholds"
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        }
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 7,
                    "w": 20,
                    "x": 4,
                    "y": 1
                },
                "id": 14,
                "options": {
                    "colorMode": "none",
                    "graphMode": "area",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "lastNotNull"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "text": {},
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "max(operator_controller_objects_count{job=~\"$job\",instance=~\"$instance\"}) by (controller)",
                        "legendFormat": "{{controller}}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "CRD Objects count by controller",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "thresholds"
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "red",
                                    "value": null
                                },
                                {
                                    "color": "green",
                                    "value": 1800
                                }
                            ]
                        },
                        "unit": "s"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 4,
                    "w": 4,
                    "x": 0,
                    "y": 4
                },
                "id": 22,
                "options": {
                    "colorMode": "value",
                    "graphMode": "area",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "lastNotNull"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "vm_app_uptime_seconds{job=~\"$job\",instance=~\"$instance\"}",
                        "format": "table",
                        "instant": true,
                        "interval": "",
                        "legendFormat": "{{instance}}",
                        "range": false,
                        "refId": "A"
                    }
                ],
                "title": "Uptime",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 0,
                            "gradientMode": "none",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "linear",
                            "lineWidth": 1,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 13,
                    "w": 12,
                    "x": 0,
                    "y": 8
                },
                "id": 12,
                "options": {
                    "legend": {
                        "calcs": [
                            "mean",
                            "max"
                        ],
                        "displayMode": "table",
                        "placement": "bottom",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "10.4.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(rate(controller_runtime_reconcile_total{job=~\"$job\",instance=~\"$instance\",result=~\"requeue_after|requeue|success\"}[$__rate_interval])) by(controller) > 0",
                        "legendFormat": "{{controller}}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Reconciliation rate by controller",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 10,
                            "gradientMode": "none",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "linear",
                            "lineWidth": 1,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 13,
                    "w": 12,
                    "x": 12,
                    "y": 8
                },
                "id": 16,
                "options": {
                    "legend": {
                        "calcs": [
                            "mean",
                            "max"
                        ],
                        "displayMode": "table",
                        "placement": "bottom",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "10.4.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(rate(operator_log_messages_total{job=~\"$job\",instance=~\"$instance\"}[$__rate_interval])) by (level)",
                        "legendFormat": "{{label_name}}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Log message rate",
                "type": "timeseries"
            },
            {
                "collapsed": true,
                "datasource": {
                    "type": "prometheus",
                    "uid": "PB894574A363DF0AF"
                },
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 21
                },
                "id": 6,
                "panels": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Non zero metrics indicates about error with CR object definition (typos or incorrect values) or errors with kubernetes API connection.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 10,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green",
                                            "value": null
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 2
                        },
                        "id": 10,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "10.4.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": false,
                                "expr": "sum(rate(controller_runtime_reconcile_errors_total{job=~\"$job\",instance=~\"$instance\"}[$__rate_interval])) by(controller) > 0 ",
                                "instant": false,
                                "legendFormat": "{{controller}}",
                                "range": true,
                                "refId": "A"
                            },
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(rate(controller_runtime_reconcile_total{job=~\"$job\",instance=~\"$instance\",result=\"error\"}[$__rate_interval])) by(controller) > 0",
                                "hide": false,
                                "legendFormat": "{{label_name}}",
                                "range": true,
                                "refId": "B"
                            }
                        ],
                        "title": "reconcile errors by controller",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Operator limits number of reconcilation events to 5 events per 2 seconds.\n For now, this limit is applied only for vmalert and vmagent controllers.\n It should reduce load at kubernetes cluster and increase operator performance.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 10,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green",
                                            "value": null
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 2
                        },
                        "id": 18,
                        "options": {
                            "legend": {
                                "calcs": [],
                                "displayMode": "list",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "10.4.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(rate(operator_reconcile_throttled_events_total[$__rate_interval])) by(controller)",
                                "legendFormat": "{{controller}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "throttled reconcilation events",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Number of objects waiting in the queue for reconciliation. Non-zero values indicate that operator cannot process CR objects changes with the given resources.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 10,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green",
                                            "value": null
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 11,
                            "w": 12,
                            "x": 0,
                            "y": 10
                        },
                        "id": 20,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "10.4.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "max(workqueue_depth{job=~\"$job\",instance=~\"$instance\"}) by (name)",
                                "legendFormat": "{{label_name}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Wokring queue depth",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": " For controllers with StatefulSet it's ok to see latency greater then 3 seconds. It could be vmalertmanager,vmcluster or vmagent in statefulMode.\n\n For other controllers, latency greater then 1 second may indicate issues with kubernetes cluster or operator's performance.\n ",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 10,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green",
                                            "value": null
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "s"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 11,
                            "w": 12,
                            "x": 12,
                            "y": 10
                        },
                        "id": 26,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "10.4.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "histogram_quantile(0.99, sum(rate(controller_runtime_reconcile_time_seconds_bucket[$__rate_interval])) by(le,controller))",
                                "legendFormat": "q.99 {{controller}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Reconcilation latency by controller",
                        "type": "timeseries"
                    }
                ],
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "PB894574A363DF0AF"
                        },
                        "refId": "A"
                    }
                ],
                "title": "Troubleshooting",
                "type": "row"
            },
            {
                "collapsed": false,
                "datasource": {
                    "type": "prometheus",
                    "uid": "PB894574A363DF0AF"
                },
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 22
                },
                "id": 4,
                "panels": [],
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "PB894574A363DF0AF"
                        },
                        "refId": "A"
                    }
                ],
                "title": "resources",
                "type": "row"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 10,
                            "gradientMode": "none",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "linear",
                            "lineWidth": 1,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "bytes"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 23
                },
                "id": 28,
                "options": {
                    "legend": {
                        "calcs": [
                            "mean",
                            "lastNotNull",
                            "max"
                        ],
                        "displayMode": "table",
                        "placement": "bottom",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "10.4.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(go_memstats_sys_bytes{job=~\"$job\", instance=~\"$instance\"}) ",
                        "legendFormat": "requested from system",
                        "range": true,
                        "refId": "A"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(go_memstats_heap_inuse_bytes{job=~\"$job\", instance=~\"$instance\"}) ",
                        "hide": false,
                        "legendFormat": "heap inuse",
                        "range": true,
                        "refId": "B"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(go_memstats_stack_inuse_bytes{job=~\"$job\", instance=~\"$instance\"})",
                        "hide": false,
                        "legendFormat": "stack inuse",
                        "range": true,
                        "refId": "C"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(process_resident_memory_bytes{job=~\"$job\", instance=~\"$instance\"})",
                        "hide": false,
                        "legendFormat": "resident",
                        "range": true,
                        "refId": "D"
                    }
                ],
                "title": "Memory usage ($instance)",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "axisSoftMin": 0,
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 10,
                            "gradientMode": "none",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "linear",
                            "lineWidth": 1,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 23
                },
                "id": 30,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "list",
                        "placement": "bottom",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "10.4.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "rate(process_cpu_seconds_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])",
                        "legendFormat": "CPU cores used",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "CPU ($instance)",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 10,
                            "gradientMode": "none",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "linear",
                            "lineWidth": 1,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 31
                },
                "id": 32,
                "options": {
                    "legend": {
                        "calcs": [],
                        "displayMode": "list",
                        "placement": "bottom",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "10.4.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(go_goroutines{job=~\"$job\", instance=~\"$instance\"})",
                        "legendFormat": "goroutines",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Goroutines ($instance)",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 10,
                            "gradientMode": "none",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "linear",
                            "lineWidth": 1,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "s"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 31
                },
                "id": 34,
                "options": {
                    "legend": {
                        "calcs": [
                            "mean",
                            "max"
                        ],
                        "displayMode": "table",
                        "placement": "bottom",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "10.4.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(rate(go_gc_duration_seconds_sum{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval]))\n/\nsum(rate(go_gc_duration_seconds_count{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval]))",
                        "legendFormat": "avg gc duration",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "GC duration ($instance)",
                "type": "timeseries"
            }
        ],
        "refresh": "",
        "schemaVersion": 39,
        "tags": [
            "operator",
            "VictoriaMetrics",
            "vm-k8s-stack"
        ],
        "templating": {
            "list": [
                {
                    "current": {
                        "selected": true,
                        "text": "VictoriaMetrics",
                        "value": "PF64AB64142051B50"
                    },
                    "hide": 0,
                    "includeAll": false,
                    "multi": false,
                    "name": "ds",
                    "options": [

                    ],
                    "query": "prometheus",
                    "queryValue": "",
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "type": "datasource"
                },
                {
                    "current": {

                    },
                    "datasource": {
                        "type": "prometheus",
                        "uid": "$ds"
                    },
                    "definition": "label_values(operator_log_messages_total,job)",
                    "hide": 0,
                    "includeAll": false,
                    "multi": false,
                    "name": "job",
                    "options": [

                    ],
                    "query": {
                        "query": "label_values(operator_log_messages_total,job)",
                        "refId": "StandardVariableQuery"
                    },
                    "refresh": 2,
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": 0,
                    "type": "query"
                },
                {
                    "current": {

                    },
                    "datasource": {
                        "type": "prometheus",
                        "uid": "$ds"
                    },
                    "definition": "label_values(operator_log_messages_total{job=~\"$job\"},instance)",
                    "hide": 0,
                    "includeAll": true,
                    "multi": false,
                    "name": "instance",
                    "options": [

                    ],
                    "query": {
                        "query": "label_values(operator_log_messages_total{job=~\"$job\"},instance)",
                        "refId": "StandardVariableQuery"
                    },
                    "refresh": 2,
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": 0,
                    "type": "query"
                },
                {
                    "current": {

                    },
                    "datasource": {
                        "type": "prometheus",
                        "uid": "$ds"
                    },
                    "definition": "label_values(vm_app_version{job=\"$job\", instance=~\"$instance\"},version)",
                    "hide": 2,
                    "includeAll": false,
                    "multi": false,
                    "name": "version",
                    "options": [

                    ],
                    "query": {
                        "qryType": 1,
                        "query": "label_values(vm_app_version{job=\"$job\", instance=~\"$instance\"},version)",
                        "refId": "PrometheusVariableQueryEditor-VariableQuery"
                    },
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": 2,
                    "type": "query"
                }
            ]
        },
        "time": {
            "from": "now-15m",
            "to": "now"
        },
        "timepicker": {

        },
        "timezone": "utc",
        "title": "VictoriaMetrics - operator",
        "uid": "1H179hunk",
        "version": 1,
        "weekStart": ""
    }
---
# Source: victoria-metrics-k8s-stack/templates/grafana/dashboards/victoriametrics.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-victoriametrics
  labels:
    grafana_dashboard: "1"
    app: victoria-metrics-k8s-stack-grafana
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
data:
  victoriametrics.json:  |-
    {
        "__inputs": [],
        "__elements": {},
        "__requires": [
            {
                "type": "grafana",
                "id": "grafana",
                "name": "Grafana",
                "version": "10.4.2"
            },
            {
                "type": "datasource",
                "id": "prometheus",
                "name": "Prometheus",
                "version": "1.0.0"
            },
            {
                "type": "panel",
                "id": "stat",
                "name": "Stat",
                "version": ""
            },
            {
                "type": "panel",
                "id": "table",
                "name": "Table",
                "version": ""
            },
            {
                "type": "panel",
                "id": "text",
                "name": "Text",
                "version": ""
            },
            {
                "type": "panel",
                "id": "timeseries",
                "name": "Time series",
                "version": ""
            }
        ],
        "annotations": {
            "list": [
                {
                    "builtIn": 1,
                    "datasource": {
                        "type": "datasource",
                        "uid": "grafana"
                    },
                    "enable": true,
                    "hide": true,
                    "iconColor": "rgba(0, 211, 255, 1)",
                    "name": "Annotations & Alerts",
                    "target": {
                        "limit": 100,
                        "matchAny": false,
                        "tags": [],
                        "type": "dashboard"
                    },
                    "type": "dashboard"
                },
                {
                    "datasource": {
                        "type": "prometheus",
                        "uid": "$ds"
                    },
                    "enable": true,
                    "expr": "sum(ALERTS{job=~\"$job\", instance=~\"$instance\", alertgroup=\"vmsingle\",alertstate=\"firing\",show_at=\"dashboard\"}) by(alertname)",
                    "iconColor": "red",
                    "name": "alerts",
                    "titleFormat": "{{alertname}}"
                },
                {
                    "datasource": {
                        "type": "prometheus",
                        "uid": "$ds"
                    },
                    "enable": true,
                    "expr": "sum(vm_app_version{job=~\"$job\", instance=~\"$instance\"}) by(version) unless (sum(vm_app_version{job=~\"$job\", instance=~\"$instance\"} offset $__interval) by(version))",
                    "hide": true,
                    "iconColor": "dark-blue",
                    "name": "version",
                    "textFormat": "{{version}}",
                    "titleFormat": "Version change"
                }
            ]
        },
        "description": "Overview for single-node VictoriaMetrics v1.83.0 or higher",
        "editable": false,
        "fiscalYearStartMonth": 0,
        "gnetId": 10229,
        "graphTooltip": 1,
        "id": null,
        "links": [
            {
                "icon": "doc",
                "tags": [],
                "targetBlank": true,
                "title": "Single server Wiki",
                "type": "link",
                "url": "https://docs.victoriametrics.com/"
            },
            {
                "icon": "external link",
                "tags": [],
                "targetBlank": true,
                "title": "Found a bug?",
                "type": "link",
                "url": "https://github.com/VictoriaMetrics/VictoriaMetrics/issues"
            },
            {
                "icon": "external link",
                "tags": [],
                "targetBlank": true,
                "title": "New releases",
                "tooltip": "",
                "type": "link",
                "url": "https://github.com/VictoriaMetrics/VictoriaMetrics/releases"
            }
        ],
        "liveNow": false,
        "panels": [
            {
                "collapsed": false,
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 0
                },
                "id": 6,
                "panels": [],
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "refId": "A"
                    }
                ],
                "title": "Stats",
                "type": "row"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "",
                "gridPos": {
                    "h": 2,
                    "w": 4,
                    "x": 0,
                    "y": 1
                },
                "id": 85,
                "options": {
                    "code": {
                        "language": "plaintext",
                        "showLineNumbers": false,
                        "showMiniMap": false
                    },
                    "content": "<div style=\"text-align: center;\">$version</div>",
                    "mode": "markdown"
                },
                "pluginVersion": "10.4.2",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "refId": "A"
                    }
                ],
                "title": "Version",
                "type": "text"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "How many datapoints are in storage",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "thresholds"
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 2,
                    "w": 5,
                    "x": 4,
                    "y": 1
                },
                "id": 26,
                "maxDataPoints": 100,
                "options": {
                    "colorMode": "value",
                    "graphMode": "area",
                    "justifyMode": "auto",
                    "orientation": "horizontal",
                    "reduceOptions": {
                        "calcs": [
                            "lastNotNull"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "text": {},
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.2",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "sum(vm_rows{job=~\"$job\", instance=~\"$instance\", type!~\"indexdb.*\"})",
                        "format": "time_series",
                        "instant": true,
                        "interval": "",
                        "intervalFactor": 1,
                        "legendFormat": "",
                        "refId": "A"
                    }
                ],
                "title": "Total datapoints",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Shows the datapoints ingestion rate.",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "thresholds"
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 2,
                    "w": 5,
                    "x": 9,
                    "y": 1
                },
                "id": 107,
                "maxDataPoints": 100,
                "options": {
                    "colorMode": "value",
                    "graphMode": "area",
                    "justifyMode": "auto",
                    "orientation": "horizontal",
                    "reduceOptions": {
                        "calcs": [
                            "lastNotNull"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "text": {},
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.2",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "sum(rate(vm_rows_inserted_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval]))",
                        "format": "time_series",
                        "instant": true,
                        "interval": "",
                        "intervalFactor": 1,
                        "legendFormat": "",
                        "refId": "A"
                    }
                ],
                "title": "Ingestion rate",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Shows the rate of HTTP read requests.",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "thresholds"
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 2,
                    "w": 5,
                    "x": 14,
                    "y": 1
                },
                "id": 108,
                "maxDataPoints": 100,
                "options": {
                    "colorMode": "value",
                    "graphMode": "area",
                    "justifyMode": "auto",
                    "orientation": "horizontal",
                    "reduceOptions": {
                        "calcs": [
                            "lastNotNull"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "text": {},
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.2",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "sum(rate(vm_http_requests_total{job=~\"$job\", instance=~\"$instance\", path!~\".*(/write|/metrics)\"}[$__rate_interval]))",
                        "format": "time_series",
                        "instant": true,
                        "interval": "",
                        "intervalFactor": 1,
                        "legendFormat": "",
                        "refId": "A"
                    }
                ],
                "title": "Read requests",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Total number of available CPUs for VM process",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "thresholds"
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 2,
                    "w": 5,
                    "x": 19,
                    "y": 1
                },
                "id": 77,
                "maxDataPoints": 100,
                "options": {
                    "colorMode": "value",
                    "graphMode": "area",
                    "justifyMode": "auto",
                    "orientation": "horizontal",
                    "reduceOptions": {
                        "calcs": [
                            "lastNotNull"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "text": {},
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.2",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "exemplar": false,
                        "expr": "sum(vm_available_cpu_cores{job=~\"$job\", instance=~\"$instance\"})",
                        "format": "time_series",
                        "instant": true,
                        "interval": "",
                        "intervalFactor": 1,
                        "legendFormat": "",
                        "refId": "A"
                    }
                ],
                "title": "Available CPU",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "thresholds"
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "red",
                                    "value": null
                                },
                                {
                                    "color": "green",
                                    "value": 1800
                                }
                            ]
                        },
                        "unit": "s"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 2,
                    "w": 4,
                    "x": 0,
                    "y": 3
                },
                "id": 87,
                "options": {
                    "colorMode": "value",
                    "graphMode": "area",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "lastNotNull"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "text": {},
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.2",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "min(vm_app_uptime_seconds{job=~\"$job\", instance=~\"$instance\"})",
                        "instant": true,
                        "interval": "",
                        "legendFormat": "",
                        "refId": "A"
                    }
                ],
                "title": "Uptime",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Shows the number of [active time series](https://docs.victoriametrics.com/faq/#what-is-an-active-time-series) with new data points inserted during the last hour. High value may result in ingestion slowdown.",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "thresholds"
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 2,
                    "w": 5,
                    "x": 4,
                    "y": 3
                },
                "id": 38,
                "maxDataPoints": 100,
                "options": {
                    "colorMode": "value",
                    "graphMode": "area",
                    "justifyMode": "auto",
                    "orientation": "horizontal",
                    "reduceOptions": {
                        "calcs": [
                            "lastNotNull"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "text": {},
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.2",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "sum(vm_cache_entries{job=~\"$job\", instance=~\"$instance\", type=\"storage/hour_metric_ids\"})",
                        "format": "time_series",
                        "instant": true,
                        "interval": "",
                        "intervalFactor": 1,
                        "legendFormat": "",
                        "refId": "A"
                    }
                ],
                "title": "Active series",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Total amount of used disk space",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "thresholds"
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                }
                            ]
                        },
                        "unit": "bytes"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 2,
                    "w": 5,
                    "x": 9,
                    "y": 3
                },
                "id": 81,
                "maxDataPoints": 100,
                "options": {
                    "colorMode": "value",
                    "graphMode": "area",
                    "justifyMode": "auto",
                    "orientation": "horizontal",
                    "reduceOptions": {
                        "calcs": [
                            "lastNotNull"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "text": {},
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.2",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "sum(vm_data_size_bytes{job=~\"$job\", instance=~\"$instance\"})",
                        "format": "time_series",
                        "instant": true,
                        "interval": "",
                        "intervalFactor": 1,
                        "legendFormat": "",
                        "refId": "A"
                    }
                ],
                "title": "Disk space usage",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Average disk usage per datapoint.",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "thresholds"
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                }
                            ]
                        },
                        "unit": "bytes"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 2,
                    "w": 5,
                    "x": 14,
                    "y": 3
                },
                "id": 82,
                "maxDataPoints": 100,
                "options": {
                    "colorMode": "value",
                    "graphMode": "area",
                    "justifyMode": "auto",
                    "orientation": "horizontal",
                    "reduceOptions": {
                        "calcs": [
                            "lastNotNull"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "text": {},
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.2",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "max(sum(vm_data_size_bytes{job=~\"$job\", instance=~\"$instance\"}) / sum(vm_rows{job=~\"$job\", instance=~\"$instance\"}))",
                        "format": "time_series",
                        "instant": true,
                        "interval": "",
                        "intervalFactor": 1,
                        "legendFormat": "",
                        "refId": "A"
                    }
                ],
                "title": "Bytes per point",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Total size of available memory for VM process",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "thresholds"
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                }
                            ]
                        },
                        "unit": "bytes"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 2,
                    "w": 5,
                    "x": 19,
                    "y": 3
                },
                "id": 78,
                "maxDataPoints": 100,
                "options": {
                    "colorMode": "value",
                    "graphMode": "area",
                    "justifyMode": "auto",
                    "orientation": "horizontal",
                    "reduceOptions": {
                        "calcs": [
                            "lastNotNull"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "text": {},
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.2",
                "targets": [
                    {
                        "datasource": {
                            "uid": "$ds"
                        },
                        "exemplar": false,
                        "expr": "sum(vm_available_memory_bytes{job=~\"$job\", instance=~\"$instance\"})",
                        "format": "time_series",
                        "instant": true,
                        "interval": "",
                        "intervalFactor": 1,
                        "legendFormat": "",
                        "refId": "A"
                    }
                ],
                "title": "Available memory",
                "type": "stat"
            },
            {
                "collapsed": false,
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 5
                },
                "id": 24,
                "panels": [],
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "refId": "A"
                    }
                ],
                "title": "Overview",
                "type": "row"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "How many datapoints are inserted into storage per second",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 10,
                            "gradientMode": "none",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "linear",
                            "lineWidth": 1,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "links": [],
                        "mappings": [],
                        "min": 0,
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 6
                },
                "id": 106,
                "options": {
                    "legend": {
                        "calcs": [
                            "mean",
                            "lastNotNull"
                        ],
                        "displayMode": "table",
                        "placement": "bottom",
                        "showLegend": true,
                        "sortBy": "Last *",
                        "sortDesc": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "9.1.0",
                "targets": [
                    {
                        "datasource": {
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(rate(vm_rows_inserted_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by (type, instance) > 0",
                        "format": "time_series",
                        "hide": false,
                        "intervalFactor": 1,
                        "legendFormat": "{{instance}} - {{type}}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Datapoints ingestion rate",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "* `*` - unsupported query path\n* `/write` - insert into VM\n* `/metrics` - query VM system metrics\n* `/query` - query instant values\n* `/query_range` - query over a range of time\n* `/series` - match a certain label set\n* `/label/{}/values` - query a list of label values (variables mostly)",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 0,
                            "gradientMode": "none",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "linear",
                            "lineWidth": 1,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "links": [],
                        "mappings": [],
                        "min": 0,
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 6
                },
                "id": 12,
                "options": {
                    "legend": {
                        "calcs": [
                            "mean",
                            "lastNotNull",
                            "max"
                        ],
                        "displayMode": "table",
                        "placement": "bottom",
                        "showLegend": true,
                        "sortBy": "Last *",
                        "sortDesc": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "9.1.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(rate(vm_http_requests_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by (path, instance) > 0",
                        "format": "time_series",
                        "interval": "",
                        "intervalFactor": 1,
                        "legendFormat": "{{instance}} - {{path}}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Requests rate",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Shows the number of [active time series](https://docs.victoriametrics.com/faq/#what-is-an-active-time-series) with new data points inserted during the last hour. High value may result in ingestion slowdown. \n\nSee following link for details:",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 10,
                            "gradientMode": "none",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "linear",
                            "lineWidth": 1,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "links": [],
                        "mappings": [],
                        "min": 0,
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 14
                },
                "id": 51,
                "links": [
                    {
                        "targetBlank": true,
                        "title": "troubleshooting",
                        "url": "https://docs.victoriametrics.com/troubleshooting"
                    }
                ],
                "options": {
                    "legend": {
                        "calcs": [
                            "mean",
                            "lastNotNull",
                            "max"
                        ],
                        "displayMode": "table",
                        "placement": "bottom",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "9.1.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "vm_cache_entries{job=~\"$job\", instance=~\"$instance\", type=\"storage/hour_metric_ids\"}",
                        "format": "time_series",
                        "intervalFactor": 1,
                        "legendFormat": "{{instance}}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Active time series",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "The less time it takes is better.\n* `*` - unsupported query path\n* `/write` - insert into VM\n* `/metrics` - query VM system metrics\n* `/query` - query instant values\n* `/query_range` - query over a range of time\n* `/series` - match a certain label set\n* `/label/{}/values` - query a list of label values (variables mostly)",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 10,
                            "gradientMode": "none",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "linear",
                            "lineWidth": 1,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "links": [],
                        "mappings": [],
                        "min": 0,
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "s"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 14
                },
                "id": 22,
                "options": {
                    "legend": {
                        "calcs": [
                            "mean",
                            "lastNotNull",
                            "max"
                        ],
                        "displayMode": "table",
                        "placement": "bottom",
                        "showLegend": true,
                        "sortBy": "Last *",
                        "sortDesc": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "9.1.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "max(vm_request_duration_seconds{job=~\"$job\", instance=~\"$instance\", quantile=\"0.99\"}) by (instance, path) > 0",
                        "format": "time_series",
                        "intervalFactor": 1,
                        "legendFormat": "{{instance}} - {{path}}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Query duration 0.99 quantile",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "* `*` - unsupported query path\n* `/write` - insert into VM\n* `/metrics` - query VM system metrics\n* `/query` - query instant values\n* `/query_range` - query over a range of time\n* `/series` - match a certain label set\n* `/label/{}/values` - query a list of label values (variables mostly)",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 10,
                            "gradientMode": "none",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "linear",
                            "lineWidth": 1,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "links": [],
                        "mappings": [],
                        "min": 0,
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 22
                },
                "id": 35,
                "options": {
                    "legend": {
                        "calcs": [
                            "mean",
                            "lastNotNull"
                        ],
                        "displayMode": "table",
                        "placement": "bottom",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "9.1.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "sum(rate(vm_http_request_errors_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by (instance, path) > 0",
                        "format": "time_series",
                        "interval": "",
                        "intervalFactor": 1,
                        "legendFormat": "{{instance}} - {{path}}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Requests error rate",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Shows the rate of logging the messages by their level. Unexpected spike in rate is a good reason to check logs.",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "bars",
                            "fillOpacity": 100,
                            "gradientMode": "none",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "linear",
                            "lineWidth": 1,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "auto",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        }
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 22
                },
                "id": 110,
                "options": {
                    "legend": {
                        "calcs": [
                            "lastNotNull",
                            "mean",
                            "max"
                        ],
                        "displayMode": "table",
                        "placement": "bottom",
                        "showLegend": true,
                        "sortBy": "Last *",
                        "sortDesc": true
                    },
                    "tooltip": {
                        "mode": "single",
                        "sort": "none"
                    }
                },
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(rate(vm_log_messages_total{job=~\"$job\", instance=~\"$instance\", level!=\"info\"}[$__rate_interval])) by (instance, level, location) > 0",
                        "interval": "5m",
                        "legendFormat": "{{instance}} - {{level}}: {{location}}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Logging rate",
                "type": "timeseries"
            },
            {
                "collapsed": true,
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 30
                },
                "id": 46,
                "panels": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Percentage of used RSS memory (resident).\nThe RSS memory shows the amount of memory recently accessed by the application. It includes anonymous memory and data from recently accessed files (aka page cache).\nThe application's performance will significantly degrade when memory usage is close to 100%.\n\nClick on the line and choose Drilldown to show memory usage per instance",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "percentunit",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 31
                        },
                        "id": 112,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": false,
                                "expr": "max(\n    max_over_time(process_resident_memory_bytes{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])\n    /\n    vm_available_memory_bytes{job=~\"$job\", instance=~\"$instance\"}\n) by(instance)",
                                "interval": "",
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "RSS memory % usage",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "bytes",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 31
                        },
                        "id": 44,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(go_memstats_sys_bytes{job=~\"$job\", instance=~\"$instance\"}) by (instance) + sum(vm_cache_size_bytes{job=~\"$job\", instance=~\"$instance\"}) by (instance)",
                                "format": "time_series",
                                "hide": false,
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}} - requested from system",
                                "range": true,
                                "refId": "A"
                            },
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(go_memstats_heap_inuse_bytes{job=~\"$job\", instance=~\"$instance\"}) by (instance) + sum(vm_cache_size_bytes{job=~\"$job\", instance=~\"$instance\"}) by (instance)",
                                "format": "time_series",
                                "hide": false,
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}} - heap inuse",
                                "range": true,
                                "refId": "B"
                            },
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(go_memstats_stack_inuse_bytes{job=~\"$job\", instance=~\"$instance\"}) by (instance)",
                                "format": "time_series",
                                "hide": false,
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}} - stack inuse",
                                "range": true,
                                "refId": "C"
                            },
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(process_resident_memory_bytes{job=~\"$job\", instance=~\"$instance\"}) by (instance)",
                                "format": "time_series",
                                "hide": false,
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}} - resident",
                                "range": true,
                                "refId": "D"
                            },
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": false,
                                "expr": "sum(process_resident_memory_anon_bytes{job=~\"$job\", instance=~\"$instance\"}) by (instance)",
                                "format": "time_series",
                                "hide": false,
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}} - resident anonymous",
                                "range": true,
                                "refId": "E"
                            }
                        ],
                        "title": "Memory usage",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Share for memory allocated by the process itself. When memory usage reaches 100% it will be likely OOM-killed.\nSafe memory usage % considered to be below 80%\n\nClick on the line and choose Drilldown to show memory usage per instance",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "percentunit",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 39
                        },
                        "id": 123,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": false,
                                "expr": "max(\n    max_over_time(process_resident_memory_anon_bytes{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])\n    /\n    vm_available_memory_bytes{job=~\"$job\", instance=~\"$instance\"}\n) by(instance)",
                                "interval": "",
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "RSS anonymous memory % usage",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "percentunit",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 39
                        },
                        "id": 114,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": false,
                                "expr": "max(\n    rate(process_cpu_seconds_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])\n    /\n    vm_available_cpu_cores{job=~\"$job\", instance=~\"$instance\"}\n) by(instance)",
                                "format": "time_series",
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "CPU % usage",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the percentage of open file descriptors compared to the limit set in the OS.\nReaching the limit of open files can cause various issues and must be prevented.\n\nSee how to change limits here https://medium.com/@muhammadtriwibowo/set-permanently-ulimit-n-open-files-in-ubuntu-4d61064429a",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "decimals": 2,
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "percentunit",
                                "unitScale": true
                            },
                            "overrides": [
                                {
                                    "matcher": {
                                        "id": "byName",
                                        "options": "max"
                                    },
                                    "properties": [
                                        {
                                            "id": "color",
                                            "value": {
                                                "fixedColor": "#C4162A",
                                                "mode": "fixed"
                                            }
                                        }
                                    ]
                                }
                            ]
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 47
                        },
                        "id": 75,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "max_over_time(process_open_fds{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])\n/\nprocess_max_fds{job=~\"$job\", instance=~\"$instance\"}",
                                "format": "time_series",
                                "hide": false,
                                "interval": "",
                                "intervalFactor": 2,
                                "legendFormat": "{{instance}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Open FDs",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "CPU cores used by instance",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short",
                                "unitScale": true
                            },
                            "overrides": [
                                {
                                    "matcher": {
                                        "id": "byName",
                                        "options": "Limit"
                                    },
                                    "properties": [
                                        {
                                            "id": "color",
                                            "value": {
                                                "fixedColor": "#F2495C",
                                                "mode": "fixed"
                                            }
                                        }
                                    ]
                                }
                            ]
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 47
                        },
                        "id": 57,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "rate(process_cpu_seconds_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])",
                                "format": "time_series",
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}}",
                                "range": true,
                                "refId": "A"
                            },
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": false,
                                "expr": "min(process_cpu_cores_available{job=~\"$job\", instance=~\"$instance\"})",
                                "format": "time_series",
                                "hide": false,
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "Limit",
                                "range": true,
                                "refId": "B"
                            }
                        ],
                        "title": "CPU",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 10,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "decimals": 0,
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 55
                        },
                        "id": 47,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(go_goroutines{job=~\"$job\", instance=~\"$instance\"}) by(instance)",
                                "format": "time_series",
                                "intervalFactor": 2,
                                "legendFormat": "{{instance}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Goroutines",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the number of bytes read/write from the storage layer.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 10,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "bytes",
                                "unitScale": true
                            },
                            "overrides": [
                                {
                                    "matcher": {
                                        "id": "byRegexp",
                                        "options": "/.*read/"
                                    },
                                    "properties": [
                                        {
                                            "id": "custom.transform",
                                            "value": "negative-Y"
                                        }
                                    ]
                                }
                            ]
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 55
                        },
                        "id": 76,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(rate(process_io_storage_read_bytes_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by (instance)",
                                "format": "time_series",
                                "hide": false,
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}} - read",
                                "range": true,
                                "refId": "A"
                            },
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(rate(process_io_storage_written_bytes_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by (instance)",
                                "format": "time_series",
                                "hide": false,
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}} - write",
                                "range": true,
                                "refId": "B"
                            }
                        ],
                        "title": "Disk writes/reads",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 10,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "decimals": 0,
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 63
                        },
                        "id": 48,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(process_num_threads{job=~\"$job\", instance=~\"$instance\"}) by(instance)",
                                "format": "time_series",
                                "intervalFactor": 2,
                                "legendFormat": "{{instance}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Threads",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the number of read/write syscalls such as read, pread, write, pwrite.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 10,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short",
                                "unitScale": true
                            },
                            "overrides": [
                                {
                                    "matcher": {
                                        "id": "byRegexp",
                                        "options": "/.*read.*/"
                                    },
                                    "properties": [
                                        {
                                            "id": "custom.transform",
                                            "value": "negative-Y"
                                        }
                                    ]
                                }
                            ]
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 63
                        },
                        "id": 124,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(rate(process_io_read_syscalls_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by (instance)",
                                "format": "time_series",
                                "hide": false,
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}} - read calls",
                                "range": true,
                                "refId": "A"
                            },
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(rate(process_io_write_syscalls_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by (instance)",
                                "format": "time_series",
                                "hide": false,
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}} - write calls",
                                "range": true,
                                "refId": "B"
                            }
                        ],
                        "title": "Disk write/read calls",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 10,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 71
                        },
                        "id": 49,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(rate(vm_tcplistener_accepts_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(instance)",
                                "format": "time_series",
                                "hide": false,
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "TCP connections rate",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 10,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 71
                        },
                        "id": 37,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(vm_tcplistener_conns{job=~\"$job\", instance=~\"$instance\"}) by(instance)",
                                "format": "time_series",
                                "hide": false,
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "TCP connections",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows network usage by VM:\n* Writes show traffic sent to clients\n* Reads show traffic received from clients",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 10,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "decbits",
                                "unitScale": true
                            },
                            "overrides": [
                                {
                                    "matcher": {
                                        "id": "byRegexp",
                                        "options": "/read.*/"
                                    },
                                    "properties": [
                                        {
                                            "id": "custom.transform",
                                            "value": "negative-Y"
                                        }
                                    ]
                                }
                            ]
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 79
                        },
                        "id": 127,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(rate(vm_tcplistener_read_bytes_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(name) * 8 > 0",
                                "format": "time_series",
                                "hide": false,
                                "intervalFactor": 1,
                                "legendFormat": "read via {{name}}",
                                "range": true,
                                "refId": "A"
                            },
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(rate(vm_tcplistener_written_bytes_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(name) * 8 > 0",
                                "format": "time_series",
                                "hide": false,
                                "intervalFactor": 1,
                                "legendFormat": "write via {{name}}",
                                "range": true,
                                "refId": "B"
                            }
                        ],
                        "title": "Network usage",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the percent of CPU spent on garbage collection.\n\nIf % is high, then CPU usage can be decreased by changing GOGC to higher values. Increasing GOGC value will increase memory usage, and decrease CPU usage.\n\nTry searching for keyword `GOGC` at https://docs.victoriametrics.com/troubleshooting/ ",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "decimals": 0,
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "percentunit",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 79
                        },
                        "id": 125,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "max(\n  rate(go_gc_cpu_seconds_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval]) \n / rate(process_cpu_seconds_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])\n ) by(instance)",
                                "format": "time_series",
                                "interval": "",
                                "intervalFactor": 2,
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "CPU spent on GC",
                        "type": "timeseries"
                    }
                ],
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "refId": "A"
                    }
                ],
                "title": "Resource usage",
                "type": "row"
            },
            {
                "collapsed": true,
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 31
                },
                "id": 71,
                "panels": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the rate and total number of new series created over last 24h.\n\nHigh [churn rate](https://docs.victoriametrics.com/faq/#what-is-high-churn-rate) tightly connected with database performance and may result in unexpected OOM's or slow queries. It is recommended to always keep an eye on this metric to avoid unexpected [cardinality](https://docs.victoriametrics.com/keyconcepts/#cardinality) \"explosions\".\n\nThe higher churn rate is, the more resources required to handle it. Consider to keep the churn rate as low as possible.\n\nGood references to read:\n* https://www.robustperception.io/cardinality-is-key\n* https://www.robustperception.io/using-tsdb-analyze-to-investigate-churn-and-cardinality",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 4
                        },
                        "id": 66,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(rate(vm_new_timeseries_created_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by (instance)",
                                "interval": "",
                                "legendFormat": "{{instance}} - churn rate",
                                "range": true,
                                "refId": "A"
                            },
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(increase(vm_new_timeseries_created_total{job=~\"$job\", instance=~\"$instance\"}[24h])) by (instance)",
                                "interval": "",
                                "legendFormat": "{{instance}} - new series over 24h",
                                "range": true,
                                "refId": "B"
                            }
                        ],
                        "title": "Churn rate",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "The percentage of slow inserts comparing to total insertion rate during the last 5 minutes. \n\nThe less value is better. If percentage remains high (>10%) during extended periods of time, then it is likely more RAM is needed for optimal handling of the current number of [active time series](https://docs.victoriametrics.com/faq/#what-is-an-active-time-series). \n\nIn general, VictoriaMetrics requires ~1KB or RAM per active time series, so it should be easy calculating the required amounts of RAM for the current workload according to capacity planning docs. But the resulting number may be far from the real number because the required amounts of memory depends on many other factors such as the number of labels per time series and the length of label values. See also [this issue](https://github.com/VictoriaMetrics/VictoriaMetrics/issues/3976#issuecomment-1476883183) for details.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 10,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "line+area"
                                    }
                                },
                                "decimals": 2,
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "transparent"
                                        },
                                        {
                                            "color": "red",
                                            "value": 0.1
                                        }
                                    ]
                                },
                                "unit": "percentunit",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 4
                        },
                        "id": 68,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "max(\n    rate(vm_slow_row_inserts_total{job=~\"$job\"}[$__rate_interval]) \n    / rate(vm_rows_added_to_storage_total{job=~\"$job\"}[$__rate_interval])\n) by (instance)",
                                "format": "time_series",
                                "hide": false,
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Slow inserts %",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Merge assist happens when storage can't keep up with merging parts. This is usually a sign of overload for storage.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "bars",
                                    "fillOpacity": 100,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 12
                        },
                        "id": 116,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": false,
                                "expr": "sum(increase(vm_assisted_merges_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(instance, type) > 0",
                                "format": "time_series",
                                "interval": "5m",
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}} - {{type}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Assisted merges",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Slow queries rate according to `search.logSlowQueryDuration` flag, which is `5s` by default.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 10,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 12
                        },
                        "id": 60,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(rate(vm_slow_queries_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by (instance)",
                                "format": "time_series",
                                "hide": false,
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Slow queries rate",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the percentage of used cache size from the allowed size by type. \nValues close to 100% show the maximum potential utilization.\nValues close to 0% show that cache is underutilized.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "percentunit",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 9,
                            "w": 12,
                            "x": 0,
                            "y": 20
                        },
                        "id": 90,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "lastNotNull",
                                    "mean",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": false,
                                "expr": "vm_cache_size_bytes{job=~\"$job\", instance=~\"$instance\"} / vm_cache_size_max_bytes{job=~\"$job\", instance=~\"$instance\"}",
                                "interval": "",
                                "legendFormat": "{{instance}} - {{type}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Cache usage % by type",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows cache miss ratio. Lower is better.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "max": 1,
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "percentunit",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 9,
                            "w": 12,
                            "x": 12,
                            "y": 20
                        },
                        "id": 118,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": false,
                                "expr": "(\n    rate(vm_cache_misses_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])\n    /\n    rate(vm_cache_requests_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])\n) > 0",
                                "format": "time_series",
                                "hide": false,
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}} - {{type}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Cache miss ratio",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Flags explicitly set to non-default values",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "thresholds"
                                },
                                "custom": {
                                    "align": "auto",
                                    "cellOptions": {
                                        "type": "auto"
                                    },
                                    "inspect": false
                                },
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unitScale": true
                            },
                            "overrides": [
                                {
                                    "matcher": {
                                        "id": "byName",
                                        "options": "Time"
                                    },
                                    "properties": [
                                        {
                                            "id": "custom.hidden",
                                            "value": true
                                        }
                                    ]
                                },
                                {
                                    "matcher": {
                                        "id": "byName",
                                        "options": "Value"
                                    },
                                    "properties": [
                                        {
                                            "id": "custom.hidden",
                                            "value": true
                                        }
                                    ]
                                },
                                {
                                    "matcher": {
                                        "id": "byName",
                                        "options": "job"
                                    },
                                    "properties": [
                                        {
                                            "id": "custom.hidden",
                                            "value": true
                                        }
                                    ]
                                }
                            ]
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 29
                        },
                        "id": 126,
                        "options": {
                            "cellHeight": "sm",
                            "footer": {
                                "countRows": false,
                                "fields": "",
                                "reducer": [
                                    "sum"
                                ],
                                "show": false
                            },
                            "showHeader": true
                        },
                        "pluginVersion": "10.3.1",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": false,
                                "expr": "sum(flag{is_set=\"true\", job=~\"$job\", instance=~\"$instance\"}) by(job, instance, name, value)",
                                "format": "table",
                                "instant": true,
                                "legendFormat": "__auto",
                                "range": false,
                                "refId": "A"
                            }
                        ],
                        "title": "Non-default flags",
                        "type": "table"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "VictoriaMetrics limits the number of labels per each metric with `-maxLabelsPerTimeseries` command-line flag.\n\nThis prevents from ingesting metrics with too many labels. The value of `maxLabelsPerTimeseries` must be adjusted for your workload.\n\nWhen limit is exceeded (graph is > 0) - extra labels are dropped, which could result in unexpected identical time series. See more details about dropped labels in logs.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 10,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "decimals": 2,
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 29
                        },
                        "id": 74,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "list",
                                "placement": "bottom",
                                "showLegend": false
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "exemplar": false,
                                "expr": "sum(increase(vm_metrics_with_dropped_labels_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by (instance)",
                                "format": "time_series",
                                "hide": false,
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}} - limit exceeded",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Labels limit exceeded",
                        "type": "timeseries"
                    }
                ],
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "refId": "A"
                    }
                ],
                "title": "Troubleshooting",
                "type": "row"
            },
            {
                "collapsed": true,
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 32
                },
                "id": 14,
                "panels": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "How many datapoints are inserted into storage per second",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 10,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 5
                        },
                        "id": 10,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(rate(vm_rows_inserted_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by (instance, type) > 0",
                                "format": "time_series",
                                "hide": false,
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}} - {{type}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Datapoints ingestion rate",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the approx time needed to reach 100% of disk capacity based on the following params:\n* free disk space;\n* row ingestion rate;\n* compression.\n\nNote: this panel doesn't account for deduplication process.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "s",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 5
                        },
                        "id": 73,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "min"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "vm_free_disk_space_bytes{job=~\"$job\", instance=~\"$instance\"} \n/ ignoring(path) (\n  rate(vm_rows_added_to_storage_total{job=~\"$job\", instance=~\"$instance\"}[1d]) \n  * scalar(\n    sum(vm_data_size_bytes{job=~\"$job\", instance=~\"$instance\", type!~\"indexdb.*\"}) \n    / sum(vm_rows{job=~\"$job\", instance=~\"$instance\", type!~\"indexdb.*\"})\n    )\n  )",
                                "format": "time_series",
                                "hide": false,
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Storage full ETA",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows amount of on-disk space occupied by data points and the remaining disk space at `-storageDataPath`",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "bytes",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 13
                        },
                        "id": 53,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(vm_data_size_bytes{job=~\"$job\", instance=~\"$instance\", type!~\"indexdb.*\"}) by (instance)",
                                "format": "time_series",
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}} - Used (datapoints)",
                                "range": true,
                                "refId": "A"
                            },
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "expr": "vm_free_disk_space_bytes{job=~\"$job\", instance=~\"$instance\"}",
                                "format": "time_series",
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}} - Free",
                                "range": true,
                                "refId": "B"
                            },
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(vm_data_size_bytes{job=~\"$job\", instance=~\"$instance\", type=~\"indexdb.*\"}) by (instance)",
                                "format": "time_series",
                                "hide": false,
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}} - Used (index)",
                                "range": true,
                                "refId": "C"
                            }
                        ],
                        "title": "Disk space usage - datapoints",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "How many datapoints are in RAM queue waiting to be written into storage. The number of pending data points should be in the range from 0 to `2*<ingestion_rate>`, since VictoriaMetrics pushes pending data to persistent storage every second.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 10,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short",
                                "unitScale": true
                            },
                            "overrides": [
                                {
                                    "matcher": {
                                        "id": "byName",
                                        "options": "pending index entries"
                                    },
                                    "properties": [
                                        {
                                            "id": "unit",
                                            "value": "none"
                                        },
                                        {
                                            "id": "decimals",
                                            "value": 3
                                        }
                                    ]
                                }
                            ]
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 13
                        },
                        "id": 34,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "expr": "vm_pending_rows{job=~\"$job\", instance=~\"$instance\", type=\"storage\"}",
                                "format": "time_series",
                                "hide": false,
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}} - pending datapoints",
                                "range": true,
                                "refId": "A"
                            },
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "expr": "vm_pending_rows{job=~\"$job\", instance=~\"$instance\", type=\"indexdb\"}",
                                "format": "time_series",
                                "hide": false,
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}} - pending index entries",
                                "range": true,
                                "refId": "B"
                            }
                        ],
                        "title": "Pending datapoints",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows how many datapoints are in the storage and what is average disk usage per datapoint.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short",
                                "unitScale": true
                            },
                            "overrides": [
                                {
                                    "matcher": {
                                        "id": "byName",
                                        "options": "bytes-per-datapoint"
                                    },
                                    "properties": [
                                        {
                                            "id": "unit",
                                            "value": "bytes"
                                        },
                                        {
                                            "id": "decimals",
                                            "value": 2
                                        }
                                    ]
                                }
                            ]
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 21
                        },
                        "id": 30,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(vm_rows{job=~\"$job\", instance=~\"$instance\", type!~\"indexdb.*\"}) by (instance)",
                                "format": "time_series",
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}} - total datapoints",
                                "range": true,
                                "refId": "A"
                            },
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(vm_data_size_bytes{job=~\"$job\", instance=~\"$instance\"}) by (instance)\n/ sum(vm_rows{job=~\"$job\", instance=~\"$instance\", type!~\"indexdb.*\"}) by (instance)",
                                "format": "time_series",
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}} - bytes-per-datapoint",
                                "range": true,
                                "refId": "B"
                            }
                        ],
                        "title": "Datapoints",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "uid": "$ds"
                        },
                        "description": "Data parts of LSM tree.\nHigh number of parts could be an evidence of slow merge performance - check the resource utilization.\n* `indexdb` - inverted index\n* `storage/small` - recently added parts of data ingested into storage(hot data)\n* `storage/big` -  small parts gradually merged into big parts (cold data)",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 21
                        },
                        "id": 36,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(vm_parts{job=~\"$job\", instance=~\"$instance\"}) by (instance, type)",
                                "format": "time_series",
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}} - {{type}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "LSM parts",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows how many rows were ignored on insertion due to corrupted or out of retention timestamps.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 10,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 29
                        },
                        "id": 58,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": false,
                                "expr": "sum(increase(vm_rows_ignored_total{job=~\"$job\", instance=~\"$instance\"}[1h])) by (instance, reason)",
                                "format": "time_series",
                                "hide": false,
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}} - {{reason}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Rows ignored for last 1h",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "The number of on-going merges in storage nodes.  It is expected to have high numbers for `storage/small` metric.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "decimals": 0,
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 29
                        },
                        "id": 62,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(vm_active_merges{job=~\"$job\", instance=~\"$instance\"}) by(instance, type)",
                                "legendFormat": "{{instance}} - {{type}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Active merges",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows how many ongoing insertions (not API /write calls) on disk are taking place, where:\n* `max` - equal to number of CPUs;\n* `current` - current number of goroutines busy with inserting rows into underlying storage.\n\nEvery successful API /write call results into flush on disk. However, these two actions are separated and controlled via different concurrency limiters. The `max` on this panel can't be changed and always equal to number of CPUs. \n\nWhen `current` hits `max` constantly, it means storage is overloaded and requires more CPU.\n\n",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "decimals": 0,
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short",
                                "unitScale": true
                            },
                            "overrides": [
                                {
                                    "matcher": {
                                        "id": "byName",
                                        "options": "max"
                                    },
                                    "properties": [
                                        {
                                            "id": "color",
                                            "value": {
                                                "fixedColor": "#C4162A",
                                                "mode": "fixed"
                                            }
                                        }
                                    ]
                                }
                            ]
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 37
                        },
                        "id": 59,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "max_over_time(vm_concurrent_insert_capacity{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])",
                                "format": "time_series",
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}} - max",
                                "range": true,
                                "refId": "A"
                            },
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(vm_concurrent_insert_current{job=~\"$job\", instance=~\"$instance\"}) by (instance)",
                                "format": "time_series",
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}} - current",
                                "range": true,
                                "refId": "B"
                            }
                        ],
                        "title": "Concurrent flushes on disk",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "The number of rows merged per second by storage nodes.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "decimals": 0,
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 37
                        },
                        "id": 64,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(rate(vm_rows_merged_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(instance, type)",
                                "legendFormat": "{{instance}} - {{type}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Merge speed",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "99th percentile of number of series read per query.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "decimals": 2,
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 45
                        },
                        "id": 99,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "histogram_quantile(0.99, sum(rate(vm_series_read_per_query_bucket{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by (instance, vmrange))",
                                "format": "time_series",
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Series read per query",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "99th percentile of number of [data samples](https://docs.victoriametrics.com/keyconcepts/#raw-samples) read per queried series.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "decimals": 2,
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 45
                        },
                        "id": 103,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "histogram_quantile(0.99, sum(rate(vm_rows_read_per_series_bucket{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by (instance, vmrange))",
                                "format": "time_series",
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Datapoints read per series",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "99th percentile of number of [data samples](https://docs.victoriametrics.com/keyconcepts/#raw-samples) read per query.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "decimals": 2,
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 53
                        },
                        "id": 122,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "histogram_quantile(0.99, sum(rate(vm_rows_read_per_query_bucket{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by (instance, vmrange))",
                                "format": "time_series",
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Datapoints read per query",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "99th percentile of number of [data samples](https://docs.victoriametrics.com/keyconcepts/#raw-samples) scanner per query.\n\nThis number can exceed number of RowsReadPerQuery if `step` query arg passed to [/api/v1/query_range](https://prometheus.io/docs/prometheus/latest/querying/api/#range-queries) is smaller than the lookbehind window set in square brackets of [rollup function](https://docs.victoriametrics.com/metricsql/#rollup-functions). For example, if `increase(some_metric[1h])` is executed with the `step=5m`, then the same [data samples](https://docs.victoriametrics.com/keyconcepts/#raw-samples) on a hour time range are scanned `1h/5m=12` times. See [this article](https://valyala.medium.com/how-to-optimize-promql-and-metricsql-queries-85a1b75bf986) for details.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "decimals": 2,
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 53
                        },
                        "id": 105,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "histogram_quantile(0.99, sum(rate(vm_rows_scanned_per_query_bucket{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by (instance, vmrange))",
                                "format": "time_series",
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Datapoints scanned per query",
                        "type": "timeseries"
                    }
                ],
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "refId": "A"
                    }
                ],
                "title": "Storage",
                "type": "row"
            }
        ],
        "refresh": "",
        "schemaVersion": 39,
        "tags": [
            "victoriametrics",
            "vmsingle",
            "vm-k8s-stack"
        ],
        "templating": {
            "list": [
                {
                    "current": {
                        "selected": false,
                        "text": "VictoriaMetrics",
                        "value": "P4169E866C3094E38"
                    },
                    "hide": 0,
                    "includeAll": false,
                    "multi": false,
                    "name": "ds",
                    "options": [

                    ],
                    "query": "prometheus",
                    "queryValue": "",
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "type": "datasource"
                },
                {
                    "current": {

                    },
                    "datasource": {
                        "type": "prometheus",
                        "uid": "$ds"
                    },
                    "definition": "label_values(vm_app_version{version=~\"victoria-metrics-.*\"}, job)",
                    "hide": 0,
                    "includeAll": false,
                    "multi": false,
                    "name": "job",
                    "options": [

                    ],
                    "query": {
                        "query": "label_values(vm_app_version{version=~\"victoria-metrics-.*\"}, job)",
                        "refId": "VictoriaMetrics-job-Variable-Query"
                    },
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": 0,
                    "tagValuesQuery": "",
                    "tagsQuery": "",
                    "type": "query",
                    "useTags": false
                },
                {
                    "current": {

                    },
                    "datasource": {
                        "type": "prometheus",
                        "uid": "$ds"
                    },
                    "definition": "label_values(vm_app_version{job=~\"$job\", instance=~\"$instance\"},  version)",
                    "hide": 2,
                    "includeAll": false,
                    "multi": false,
                    "name": "version",
                    "options": [

                    ],
                    "query": {
                        "query": "label_values(vm_app_version{job=~\"$job\", instance=~\"$instance\"},  version)",
                        "refId": "VictoriaMetrics-version-Variable-Query"
                    },
                    "refresh": 1,
                    "regex": "/.*-(?:tags|heads)-(.*)-(?:0|dirty)-.*/",
                    "skipUrlSync": false,
                    "sort": 2,
                    "tagValuesQuery": "",
                    "tagsQuery": "",
                    "type": "query",
                    "useTags": false
                },
                {
                    "allValue": ".*",
                    "current": {

                    },
                    "datasource": {
                        "type": "prometheus",
                        "uid": "$ds"
                    },
                    "definition": "label_values(vm_app_version{job=~\"$job\"}, instance)",
                    "hide": 0,
                    "includeAll": true,
                    "multi": true,
                    "name": "instance",
                    "options": [

                    ],
                    "query": {
                        "query": "label_values(vm_app_version{job=~\"$job\"}, instance)",
                        "refId": "VictoriaMetrics-instance-Variable-Query"
                    },
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": 0,
                    "tagValuesQuery": "",
                    "tagsQuery": "",
                    "type": "query",
                    "useTags": false
                },
                {
                    "datasource": {
                        "type": "prometheus",
                        "uid": "$ds"
                    },
                    "filters": [

                    ],
                    "hide": 0,
                    "name": "adhoc",
                    "skipUrlSync": false,
                    "type": "adhoc"
                }
            ]
        },
        "time": {
            "from": "now-3h",
            "to": "now"
        },
        "timepicker": {
            "refresh_intervals": [
                "10s",
                "30s",
                "1m",
                "5m",
                "15m",
                "30m",
                "1h",
                "2h",
                "1d"
            ],
            "time_options": [
                "5m",
                "15m",
                "1h",
                "6h",
                "12h",
                "24h",
                "2d",
                "7d",
                "30d"
            ]
        },
        "timezone": "utc",
        "title": "VictoriaMetrics - single-node",
        "uid": "wNf0q_kZk",
        "version": 1,
        "weekStart": ""
    }
---
# Source: victoria-metrics-k8s-stack/templates/grafana/dashboards/vmagent.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-vmagent
  labels:
    grafana_dashboard: "1"
    app: victoria-metrics-k8s-stack-grafana
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
data:
  vmagent.json:  |-
    {
        "__inputs": [],
        "__elements": {},
        "__requires": [
            {
                "type": "grafana",
                "id": "grafana",
                "name": "Grafana",
                "version": "10.4.2"
            },
            {
                "type": "datasource",
                "id": "prometheus",
                "name": "Prometheus",
                "version": "1.0.0"
            },
            {
                "type": "panel",
                "id": "stat",
                "name": "Stat",
                "version": ""
            },
            {
                "type": "panel",
                "id": "table",
                "name": "Table",
                "version": ""
            },
            {
                "type": "panel",
                "id": "text",
                "name": "Text",
                "version": ""
            },
            {
                "type": "panel",
                "id": "timeseries",
                "name": "Time series",
                "version": ""
            }
        ],
        "annotations": {
            "list": [
                {
                    "builtIn": 1,
                    "datasource": {
                        "type": "datasource",
                        "uid": "grafana"
                    },
                    "enable": true,
                    "hide": true,
                    "iconColor": "rgba(0, 211, 255, 1)",
                    "name": "Annotations & Alerts",
                    "target": {
                        "limit": 100,
                        "matchAny": false,
                        "tags": [],
                        "type": "dashboard"
                    },
                    "type": "dashboard"
                },
                {
                    "datasource": {
                        "type": "prometheus",
                        "uid": "$ds"
                    },
                    "enable": true,
                    "expr": "sum(vm_app_version{job=~\"$job\", instance=~\"$instance\"}) by(short_version) unless (sum(vm_app_version{job=~\"$job\", instance=~\"$instance\"} offset $__interval) by(short_version))",
                    "hide": true,
                    "iconColor": "dark-blue",
                    "name": "version",
                    "textFormat": "{{short_version}}",
                    "titleFormat": "Version change"
                },
                {
                    "datasource": {
                        "type": "prometheus",
                        "uid": "$ds"
                    },
                    "enable": true,
                    "expr": "sum(changes(vm_app_start_timestamp{job=~\"$job\", instance=~\"$instance\"}[$__interval])) by(job, instance)",
                    "iconColor": "dark-yellow",
                    "name": "restarts",
                    "textFormat": "{{job}}:{{instance}} restarted"
                }
            ]
        },
        "description": "Overview for VictoriaMetrics vmagent v1.102.0 or higher",
        "editable": false,
        "fiscalYearStartMonth": 0,
        "graphTooltip": 1,
        "id": null,
        "links": [
            {
                "icon": "doc",
                "tags": [],
                "targetBlank": true,
                "title": "vmagent wiki",
                "tooltip": "",
                "type": "link",
                "url": "https://docs.victoriametrics.com/vmagent/"
            },
            {
                "icon": "external link",
                "tags": [],
                "targetBlank": true,
                "title": "Found a bug?",
                "type": "link",
                "url": "https://github.com/VictoriaMetrics/VictoriaMetrics/issues"
            },
            {
                "icon": "external link",
                "tags": [],
                "targetBlank": true,
                "title": "New releases",
                "type": "link",
                "url": "https://github.com/VictoriaMetrics/VictoriaMetrics/releases"
            }
        ],
        "liveNow": false,
        "panels": [
            {
                "collapsed": false,
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 0
                },
                "id": 105,
                "panels": [],
                "title": "Stats",
                "type": "row"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Shows the rate of [samples](https://docs.victoriametrics.com/keyconcepts/#raw-samples) scraped from configured targets.",
                "fieldConfig": {
                    "defaults": {
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                }
                            ]
                        }
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 3,
                    "w": 4,
                    "x": 0,
                    "y": 1
                },
                "id": 103,
                "links": [
                    {
                        "title": "Troubleshooting",
                        "url": "https://docs.victoriametrics.com/vmagent/#troubleshooting"
                    }
                ],
                "options": {
                    "colorMode": "value",
                    "graphMode": "area",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "last"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "text": {},
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.2",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(rate(vm_promscrape_scraped_samples_sum{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval]))",
                        "interval": "",
                        "legendFormat": "__auto",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Samples scraped/s",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Shows the rate of ingested [samples](https://docs.victoriametrics.com/keyconcepts/#raw-samples)",
                "fieldConfig": {
                    "defaults": {
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                }
                            ]
                        }
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 3,
                    "w": 4,
                    "x": 4,
                    "y": 1
                },
                "id": 102,
                "links": [
                    {
                        "title": "Troubleshooting",
                        "url": "https://docs.victoriametrics.com/vmagent/#troubleshooting"
                    }
                ],
                "options": {
                    "colorMode": "value",
                    "graphMode": "area",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "last"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "text": {},
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.2",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(rate(vmagent_rows_inserted_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval]))",
                        "interval": "",
                        "legendFormat": "__auto",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Samples ingested/s",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Shows the number of targets scraped per second.",
                "fieldConfig": {
                    "defaults": {
                        "decimals": 1,
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                }
                            ]
                        }
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 3,
                    "w": 4,
                    "x": 8,
                    "y": 1
                },
                "id": 134,
                "options": {
                    "colorMode": "value",
                    "graphMode": "none",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "last"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "text": {},
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.2",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(rate(vm_promscrape_scrapes_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) ",
                        "interval": "",
                        "legendFormat": "__auto",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Targets scraped/s",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Shows total number of all configured scrape targets in state `up` or `down`.\n\nSee `http://vmagent-host:8429/targets` to get list of all targets. \n",
                "fieldConfig": {
                    "defaults": {
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                }
                            ]
                        }
                    },
                    "overrides": [
                        {
                            "matcher": {
                                "id": "byName",
                                "options": "down"
                            },
                            "properties": [
                                {
                                    "id": "thresholds",
                                    "value": {
                                        "mode": "absolute",
                                        "steps": [
                                            {
                                                "color": "green",
                                                "value": null
                                            },
                                            {
                                                "color": "red",
                                                "value": 1
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    ]
                },
                "gridPos": {
                    "h": 3,
                    "w": 4,
                    "x": 12,
                    "y": 1
                },
                "id": 72,
                "links": [
                    {
                        "title": "Troubleshooting",
                        "url": "https://docs.victoriametrics.com/vmagent/#troubleshooting"
                    }
                ],
                "options": {
                    "colorMode": "value",
                    "graphMode": "area",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "last"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "text": {},
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.2",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(vm_promscrape_targets{job=~\"$job\", instance=~\"$instance\", status=\"up\"})",
                        "interval": "",
                        "legendFormat": "up",
                        "range": true,
                        "refId": "A"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(vm_promscrape_targets{job=~\"$job\", instance=~\"$instance\", status=\"down\"})",
                        "hide": false,
                        "interval": "",
                        "legendFormat": "down",
                        "range": true,
                        "refId": "B"
                    }
                ],
                "title": "Scrape targets",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Shows number of generated  error messages in  logs over last 30m. Non-zero value may be a sign of connectivity or missconfiguration errors.",
                "fieldConfig": {
                    "defaults": {
                        "mappings": [],
                        "min": 0,
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 1
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 3,
                    "w": 4,
                    "x": 16,
                    "y": 1
                },
                "id": 16,
                "links": [
                    {
                        "targetBlank": true,
                        "title": "Troubleshooting",
                        "url": "https://docs.victoriametrics.com/vmagent/#troubleshooting"
                    }
                ],
                "options": {
                    "colorMode": "value",
                    "graphMode": "area",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "last"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "text": {},
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.2",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "expr": "sum(increase(vm_log_messages_total{job=~\"$job\", instance=~\"$instance\", level!=\"info\"}[30m]))",
                        "interval": "",
                        "legendFormat": "",
                        "refId": "A"
                    }
                ],
                "title": "Log errors (30m)",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Persistent queue size shows size of pending samples in bytes which hasn't been flushed to remote storage yet. \nIncreasing of value might be a sign of connectivity issues. In such cases, vmagent starts to flush pending data on disk with attempt to send it later once connection is restored.",
                "fieldConfig": {
                    "defaults": {
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 10485760
                                }
                            ]
                        },
                        "unit": "bytes"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 3,
                    "w": 4,
                    "x": 20,
                    "y": 1
                },
                "id": 56,
                "options": {
                    "colorMode": "value",
                    "graphMode": "area",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "last"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "text": {},
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.2",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "expr": "sum(vm_persistentqueue_bytes_pending{job=~\"$job\", instance=~\"$instance\"})",
                        "interval": "",
                        "legendFormat": "",
                        "refId": "A"
                    }
                ],
                "title": "Persistent queue size",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "thresholds"
                        },
                        "custom": {
                            "align": "auto",
                            "cellOptions": {
                                "type": "auto"
                            },
                            "inspect": false,
                            "minWidth": 50
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        }
                    },
                    "overrides": [
                        {
                            "matcher": {
                                "id": "byName",
                                "options": "Time"
                            },
                            "properties": [
                                {
                                    "id": "custom.hidden",
                                    "value": true
                                }
                            ]
                        },
                        {
                            "matcher": {
                                "id": "byName",
                                "options": "Value"
                            },
                            "properties": [
                                {
                                    "id": "displayName",
                                    "value": "Count"
                                }
                            ]
                        }
                    ]
                },
                "gridPos": {
                    "h": 5,
                    "w": 8,
                    "x": 0,
                    "y": 4
                },
                "id": 101,
                "options": {
                    "cellHeight": "sm",
                    "footer": {
                        "countRows": false,
                        "fields": "",
                        "reducer": [
                            "sum"
                        ],
                        "show": false
                    },
                    "showHeader": true
                },
                "pluginVersion": "10.4.2",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "sum(vm_app_version{job=~\"$job\", instance=~\"$instance\"}) by(job, short_version)",
                        "format": "table",
                        "instant": true,
                        "range": false,
                        "refId": "A"
                    }
                ],
                "type": "table"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 0,
                            "gradientMode": "none",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "stepAfter",
                            "lineWidth": 1,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "decimals": 0,
                        "links": [],
                        "mappings": [],
                        "min": 0,
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 5,
                    "w": 16,
                    "x": 8,
                    "y": 4
                },
                "id": 13,
                "options": {
                    "legend": {
                        "calcs": [
                            "lastNotNull"
                        ],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": true,
                        "sortBy": "Last *",
                        "sortDesc": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "9.2.6",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(up{job=~\"$job\", instance=~\"$instance\"}) by (job)",
                        "format": "time_series",
                        "instant": false,
                        "interval": "",
                        "legendFormat": "__auto",
                        "refId": "A"
                    }
                ],
                "title": "Uptime",
                "type": "timeseries"
            },
            {
                "collapsed": false,
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 9
                },
                "id": 24,
                "panels": [],
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "refId": "A"
                    }
                ],
                "title": "Overview",
                "type": "row"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Shows in/out [samples](https://docs.victoriametrics.com/keyconcepts/#raw-samples) rate including push and pull models. \n\nThe out-rate could be different to in-rate because of replication or additional timeseries added by vmagent for every scraped target.\n\nClick on the line and choose Drilldown to show CPU usage per instance\n",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 0,
                            "gradientMode": "none",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "linear",
                            "lineWidth": 1,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "links": [
                            {
                                "title": "Drilldown",
                                "url": "/d/G7Z9GzMGz?viewPanel=123&var-job=${__field.labels.job}&var-ds=$ds&var-instance=$instance&${__url_time_range}"
                            }
                        ],
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": [
                        {
                            "matcher": {
                                "id": "byRegexp",
                                "options": "/out .*/"
                            },
                            "properties": [
                                {
                                    "id": "custom.transform",
                                    "value": "negative-Y"
                                }
                            ]
                        }
                    ]
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 10
                },
                "id": 5,
                "options": {
                    "legend": {
                        "calcs": [
                            "mean",
                            "lastNotNull",
                            "max"
                        ],
                        "displayMode": "table",
                        "placement": "bottom",
                        "showLegend": true,
                        "sortBy": "Last *",
                        "sortDesc": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "9.2.6",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(rate({__name__=~\"vmagent_rows_inserted_total|vm_promscrape_scraped_samples_sum\", job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job)",
                        "hide": false,
                        "interval": "",
                        "legendFormat": "in {{job}}",
                        "range": true,
                        "refId": "A"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(rate(vmagent_remotewrite_block_size_rows_sum{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job)",
                        "interval": "",
                        "legendFormat": "out {{job}}",
                        "range": true,
                        "refId": "B"
                    }
                ],
                "title": "Samples rate ($instance)",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Shows the persistent queue size of pending samples in bytes >2MB which hasn't been flushed to remote storage yet. \n\nIncreasing of value might be a sign of connectivity issues. In such cases, vmagent starts to flush pending data on disk with attempt to send it later once connection is restored.\n\nRemote write URLs are hidden by default but might be unveiled once `-remoteWrite.showURL` is set to true.\n\nClick on the line and choose Drilldown to show CPU usage per instance.\n",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 0,
                            "gradientMode": "none",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "linear",
                            "lineWidth": 1,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "links": [
                            {
                                "targetBlank": true,
                                "title": "Drilldown",
                                "url": "/d/G7Z9GzMGz?viewPanel=125&var-url=${__field.labels.url}&var-ds=$ds&var-instance=$instance&var-job=$job&${__url_time_range}"
                            }
                        ],
                        "mappings": [],
                        "min": 0,
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "bytes"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 10
                },
                "id": 17,
                "links": [
                    {
                        "title": "Troubleshooting",
                        "url": "https://docs.victoriametrics.com/vmagent/#troubleshooting"
                    }
                ],
                "options": {
                    "legend": {
                        "calcs": [
                            "mean",
                            "lastNotNull",
                            "max"
                        ],
                        "displayMode": "table",
                        "placement": "bottom",
                        "showLegend": true,
                        "sortBy": "Last *",
                        "sortDesc": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "9.2.6",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(vmagent_remotewrite_pending_data_bytes{job=~\"$job\", instance=~\"$instance\", url=~\"$url\"}) by (job, url) > 2e6",
                        "interval": "",
                        "legendFormat": "{{job}} => {{url}}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Persistent queue size  ($instance) to ($url)",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Shows the rate of logging the messages by their level. Unexpected spike in rate is a good reason to check logs.",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "bars",
                            "fillOpacity": 100,
                            "gradientMode": "none",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "linear",
                            "lineWidth": 1,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "normal"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "links": [],
                        "mappings": [],
                        "min": 0,
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 18
                },
                "id": 107,
                "options": {
                    "legend": {
                        "calcs": [
                            "mean",
                            "lastNotNull",
                            "max"
                        ],
                        "displayMode": "table",
                        "placement": "bottom",
                        "showLegend": true,
                        "sortBy": "Last *",
                        "sortDesc": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "9.1.0",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "exemplar": true,
                        "expr": "sum(rate(vm_log_messages_total{job=~\"$job\",instance=~\"$instance\", level!=\"info\"}[$__rate_interval])) by (job, level) > 0",
                        "format": "time_series",
                        "hide": false,
                        "interval": "5m",
                        "intervalFactor": 1,
                        "legendFormat": "{{job}} - {{level}}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Logging rate",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Shows rate of dropped [samples](https://docs.victoriametrics.com/keyconcepts/#raw-samples) from persistent queue. vmagent drops samples from queue if in-memory and on-disk queues are full and it is unable to flush them to remote storage.\nThe max size of on-disk queue is configured by `-remoteWrite.maxDiskUsagePerURL` flag.",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 0,
                            "gradientMode": "none",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "linear",
                            "lineWidth": 1,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "links": [],
                        "mappings": [],
                        "min": 0,
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "decbytes"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 18
                },
                "id": 49,
                "links": [
                    {
                        "targetBlank": true,
                        "title": "Troubleshooting",
                        "url": "https://docs.victoriametrics.com/vmagent/#troubleshooting"
                    }
                ],
                "options": {
                    "legend": {
                        "calcs": [
                            "mean",
                            "lastNotNull",
                            "max"
                        ],
                        "displayMode": "table",
                        "placement": "bottom",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "9.2.6",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(rate(vm_persistentqueue_bytes_dropped_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by (path) > 0",
                        "interval": "",
                        "legendFormat": "{{ path }}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Persistent queue dropped rate ($instance)",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Shows the rate of requests served by vmagent HTTP server.",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 0,
                            "gradientMode": "none",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "linear",
                            "lineWidth": 1,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "links": [],
                        "mappings": [],
                        "min": 0,
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 26
                },
                "id": 15,
                "options": {
                    "legend": {
                        "calcs": [
                            "mean",
                            "lastNotNull",
                            "max"
                        ],
                        "displayMode": "table",
                        "placement": "bottom",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "9.2.6",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(rate(vmagent_http_requests_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job, path) > 0",
                        "interval": "",
                        "legendFormat": "",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Requests rate  ($instance)",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Errors rate shows rate for multiple metrics that track possible errors in vmagent, such as network or parsing errors.",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 0,
                            "gradientMode": "none",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "linear",
                            "lineWidth": 1,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "links": [],
                        "mappings": [],
                        "min": 0,
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 26
                },
                "id": 69,
                "links": [
                    {
                        "targetBlank": true,
                        "title": "Troubleshooting",
                        "url": "https://docs.victoriametrics.com/vmagent/#troubleshooting"
                    }
                ],
                "options": {
                    "legend": {
                        "calcs": [
                            "mean",
                            "lastNotNull",
                            "max"
                        ],
                        "displayMode": "table",
                        "placement": "bottom",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "9.2.6",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(rate(vmagent_http_request_errors_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job, protocol) > 0",
                        "interval": "",
                        "legendFormat": "requests:{{protocol}} ({{job}})",
                        "range": true,
                        "refId": "A"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(rate(vm_protoparser_read_errors_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job, type) > 0",
                        "interval": "",
                        "legendFormat": "parse: {{type}} ({{job}})",
                        "range": true,
                        "refId": "B"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(rate(vm_ingestserver_request_errors_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job, type) > 0",
                        "interval": "",
                        "legendFormat": "ingest: {{type}} ({{job}})",
                        "range": true,
                        "refId": "C"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(rate(vm_protoparser_unmarshal_errors_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job, type) > 0",
                        "interval": "",
                        "legendFormat": "unmarshal: {{type}} ({{job}})",
                        "range": true,
                        "refId": "D"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "expr": "sum(rate(vm_promscrape_dial_errors_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job) > 0",
                        "interval": "",
                        "legendFormat": "scrape dial ({{job}})",
                        "range": true,
                        "refId": "E"
                    }
                ],
                "title": "Errors rate  ($instance)",
                "type": "timeseries"
            },
            {
                "collapsed": true,
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 34
                },
                "id": 45,
                "panels": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Click on the line and choose Drilldown to show CPU usage per instance",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [
                                    {
                                        "targetBlank": true,
                                        "title": "Drilldown",
                                        "url": "/d/G7Z9GzMGz?viewPanel=119&var-job=${__field.labels.job}&var-ds=$ds&var-instance=$instance&${__url_time_range}"
                                    }
                                ],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "percentunit"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 11
                        },
                        "id": 109,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": true,
                                "expr": "max(\n    rate(process_cpu_seconds_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])\n    /\n    vm_available_cpu_cores{job=~\"$job\", instance=~\"$instance\"}\n) by(job)",
                                "format": "time_series",
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "CPU ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Percentage of used RSS memory (resident).\nThe RSS memory shows the amount of memory recently accessed by the application. It includes anonymous memory and data from recently accessed files (aka page cache).\nThe application's performance will significantly degrade when memory usage is close to 100%.\n\nClick on the line and choose Drilldown to show memory usage per instance",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [
                                    {
                                        "targetBlank": true,
                                        "title": "Drilldown",
                                        "url": "/d/G7Z9GzMGz?viewPanel=117&var-job=${__field.labels.job}&var-ds=$ds&var-instance=$instance&${__url_time_range}"
                                    }
                                ],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "percentunit"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 11
                        },
                        "id": 111,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": true,
                                "expr": "max(\n    max_over_time(process_resident_memory_bytes{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])\n    /\n    vm_available_memory_bytes{job=~\"$job\", instance=~\"$instance\"}\n) by(job)",
                                "interval": "",
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "RSS memory % usage ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the number of bytes read/write from the storage layer when vmagent has to buffer data on disk or read already buffered data.\n\nClick on the line and choose Drilldown to show CPU usage per instance",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [
                                    {
                                        "targetBlank": true,
                                        "title": "Drilldown",
                                        "url": "/d/G7Z9GzMGz?viewPanel=121&var-job=${__field.labels.job}&var-ds=$ds&var-instance=$instance&${__url_time_range}"
                                    }
                                ],
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "bytes"
                            },
                            "overrides": [
                                {
                                    "matcher": {
                                        "id": "byName",
                                        "options": "read"
                                    },
                                    "properties": [
                                        {
                                            "id": "custom.transform",
                                            "value": "negative-Y"
                                        }
                                    ]
                                }
                            ]
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 19
                        },
                        "id": 81,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(rate(process_io_storage_read_bytes_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job) > 0",
                                "format": "time_series",
                                "hide": false,
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "read {{job}}",
                                "range": true,
                                "refId": "A"
                            },
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(rate(process_io_storage_written_bytes_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job) > 0",
                                "format": "time_series",
                                "hide": false,
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "write {{job}}",
                                "range": true,
                                "refId": "B"
                            }
                        ],
                        "title": "Disk writes/reads ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Network usage shows the bytes rate for data accepted by vmagent and pushed via remotewrite protocol.\nDiscrepancies are possible because of different protocols used for ingesting, scraping and writing data.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "bps"
                            },
                            "overrides": [
                                {
                                    "matcher": {
                                        "id": "byRegexp",
                                        "options": "/out.*/"
                                    },
                                    "properties": [
                                        {
                                            "id": "custom.transform",
                                            "value": "negative-Y"
                                        }
                                    ]
                                }
                            ]
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 19
                        },
                        "id": 7,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(rate(vm_tcplistener_read_bytes_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job) * 8 \n+ sum(rate(vm_promscrape_conn_bytes_read_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job) * 8",
                                "interval": "",
                                "legendFormat": "in {{job}}",
                                "range": true,
                                "refId": "A"
                            },
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(rate(vmagent_remotewrite_conn_bytes_written_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job) * 8",
                                "interval": "",
                                "legendFormat": "out {{job}}",
                                "range": true,
                                "refId": "B"
                            }
                        ],
                        "title": "Network  usage ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Panel shows the percentage of open file descriptors in the OS per instance.\nReaching the limit of open files (100%) can cause various issues and must be prevented.\n\nSee how to change limits here https://medium.com/@muhammadtriwibowo/set-permanently-ulimit-n-open-files-in-ubuntu-4d61064429a",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "decimals": 5,
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "percentunit"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 27
                        },
                        "id": 83,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "max(\n    max_over_time(process_open_fds{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])\n    /\n    process_max_fds{job=~\"$job\", instance=~\"$instance\"}\n) by(job)",
                                "format": "time_series",
                                "interval": "",
                                "intervalFactor": 2,
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Open FDs usage % ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "decimals": 0,
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 27
                        },
                        "id": 39,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(max_over_time(go_goroutines{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job)",
                                "format": "time_series",
                                "interval": "",
                                "intervalFactor": 2,
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Goroutines ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the percent of CPU spent on garbage collection.\n\nIf % is high, then CPU usage can be decreased by changing GOGC to higher values. Increasing GOGC value will increase memory usage, and decrease CPU usage.\n\nTry searching for keyword `GOGC` at https://docs.victoriametrics.com/troubleshooting/ ",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "decimals": 0,
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "percentunit"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 35
                        },
                        "id": 135,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "max(\n  rate(go_gc_cpu_seconds_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval]) \n / rate(process_cpu_seconds_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])\n ) by(job)",
                                "format": "time_series",
                                "interval": "",
                                "intervalFactor": 2,
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "CPU spent on GC ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "decimals": 0,
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 35
                        },
                        "id": 41,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(max_over_time(process_num_threads{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job)",
                                "format": "time_series",
                                "intervalFactor": 2,
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Threads ($instance)",
                        "type": "timeseries"
                    }
                ],
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "refId": "A"
                    }
                ],
                "title": "Resource usage",
                "type": "row"
            },
            {
                "collapsed": true,
                "datasource": {
                    "type": "prometheus",
                    "uid": "grafana"
                },
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 35
                },
                "id": 94,
                "panels": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows top 5 job by the number of new series registered by vmagent over the 5min range. These jobs generate the most of the churn rate.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 12
                        },
                        "id": 92,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": false,
                                "expr": "topk_max(5, sum(sum_over_time(scrape_series_added[5m])) by (job)) > 0",
                                "interval": "",
                                "legendFormat": "{{ job }}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Top 5 jobs by unique samples",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows top 5 instances by the number of new series registered by vmagent over the 5min range. These instances generate the most of the churn rate.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 12
                        },
                        "id": 95,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": false,
                                "expr": "topk(10, sum(sum_over_time(scrape_series_added[5m])) by (instance)) > 0",
                                "interval": "",
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Top 5 instances by unique samples",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows saturation persistent queue for writes. If the threshold of 0.9sec is reached, then persistent is saturated by more than 90% and vmagent won't be able to keep up with flushing data on disk. In this case, consider to decrease load on the vmagent or improve the disk throughput.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "axisSoftMax": 2,
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "line"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "transparent"
                                        },
                                        {
                                            "color": "red",
                                            "value": 0.9
                                        }
                                    ]
                                },
                                "unit": "s"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 20
                        },
                        "id": 98,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": true,
                                "expr": "max(rate(vm_persistentqueue_write_duration_seconds_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by (job)",
                                "interval": "",
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Persistent queue write saturation ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows saturation persistent queue for reads. If the threshold of 0.9sec is reached, then persistent is saturated by more than 90% and vmagent won't be able to keep up with reading data from the disk. In this case, consider to decrease load on the vmagent or improve the disk throughput.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "axisSoftMax": 2,
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "line"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "transparent"
                                        },
                                        {
                                            "color": "red",
                                            "value": 0.9
                                        }
                                    ]
                                },
                                "unit": "s"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 20
                        },
                        "id": 99,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": true,
                                "expr": "max(rate(vm_persistentqueue_read_duration_seconds_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by (job)",
                                "interval": "",
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Persistent queue read saturation ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the rate of dropped data blocks in cases when remote storage replies with `400 Bad Request` and `409 Conflict` HTTP responses.\n\nSee https://github.com/VictoriaMetrics/VictoriaMetrics/issues/1149",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "normal"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 28
                        },
                        "id": 79,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": true,
                                "expr": "sum(rate(vmagent_remotewrite_packets_dropped_total{job=~\"$job\", instance=~\"$instance\", url=~\"$url\"}[$__rate_interval])) by(job, url) > 0",
                                "interval": "",
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Data blocks dropped ($instance) to ($url)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the rate of dropped [samples](https://docs.victoriametrics.com/keyconcepts/#raw-samples) due to relabeling. \nMetric tracks drops for `-remoteWrite.relabelConfig` configuration only.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "normal"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 28
                        },
                        "id": 18,
                        "links": [
                            {
                                "targetBlank": true,
                                "title": "Relabeling",
                                "url": "https://docs.victoriametrics.com/vmagent/#relabeling"
                            }
                        ],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(rate(vmagent_remotewrite_relabel_metrics_dropped_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job, url) > 0",
                                "interval": "",
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "B"
                            }
                        ],
                        "title": "Rows dropped by relabeling ($instance) to ($url)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the rate of parsed datapoints from write or scrape requests.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 36
                        },
                        "id": 127,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": true,
                                "expr": "sum(rate(vm_protoparser_rows_read_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job, type) > 0",
                                "interval": "",
                                "legendFormat": "{{ type }} ({{job}})",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Datapoints rate ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Tracks the rate of dropped invalid rows because of errors while unmarshaling write requests. The exact errors messages will be printed in logs.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 36
                        },
                        "id": 50,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": true,
                                "expr": "sum(rate(vm_rows_invalid_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job, type) > 0",
                                "interval": "",
                                "legendFormat": "{{type}} ({{job}})",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Invalid datapoints rate ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "thresholds"
                                },
                                "custom": {
                                    "align": "auto",
                                    "cellOptions": {
                                        "type": "auto"
                                    },
                                    "inspect": false
                                },
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                }
                            },
                            "overrides": [
                                {
                                    "matcher": {
                                        "id": "byName",
                                        "options": "Value"
                                    },
                                    "properties": [
                                        {
                                            "id": "custom.hidden",
                                            "value": true
                                        }
                                    ]
                                },
                                {
                                    "matcher": {
                                        "id": "byName",
                                        "options": "Time"
                                    },
                                    "properties": [
                                        {
                                            "id": "custom.hidden",
                                            "value": true
                                        }
                                    ]
                                }
                            ]
                        },
                        "gridPos": {
                            "h": 7,
                            "w": 24,
                            "x": 0,
                            "y": 44
                        },
                        "id": 129,
                        "options": {
                            "footer": {
                                "fields": "",
                                "reducer": [
                                    "sum"
                                ],
                                "show": false
                            },
                            "showHeader": true,
                            "sortBy": [
                                {
                                    "desc": true,
                                    "displayName": "job"
                                }
                            ]
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": false,
                                "expr": "sum(flag{is_set=\"true\", job=~\"$job\", instance=~\"$instance\"}) by(job, instance, name, value)",
                                "format": "table",
                                "instant": true,
                                "legendFormat": "__auto",
                                "range": false,
                                "refId": "A"
                            }
                        ],
                        "title": "Non-default flags",
                        "transformations": [
                            {
                                "id": "groupBy",
                                "options": {
                                    "fields": {
                                        "instance": {
                                            "aggregations": []
                                        },
                                        "job": {
                                            "aggregations": [],
                                            "operation": "groupby"
                                        },
                                        "name": {
                                            "aggregations": [],
                                            "operation": "groupby"
                                        },
                                        "value": {
                                            "aggregations": [],
                                            "operation": "groupby"
                                        }
                                    }
                                }
                            }
                        ],
                        "type": "table"
                    }
                ],
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "grafana"
                        },
                        "refId": "A"
                    }
                ],
                "title": "Troubleshooting",
                "type": "row"
            },
            {
                "collapsed": true,
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 36
                },
                "id": 28,
                "panels": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 7,
                            "w": 12,
                            "x": 0,
                            "y": 13
                        },
                        "id": 48,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": true,
                                "expr": "sum(vm_promscrape_targets{job=~\"$job\", instance=~\"$instance\", status=\"up\"}) by(job, type) > 0",
                                "format": "time_series",
                                "interval": "",
                                "legendFormat": "{{type}} ({{job}})",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Scrape targets UP(By Type)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 10,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 7,
                            "w": 12,
                            "x": 12,
                            "y": 13
                        },
                        "id": 76,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": true,
                                "expr": "sum(vm_promscrape_targets{job=~\"$job\", instance=~\"$instance\", status=\"down\"}) by(job, type) > 0",
                                "format": "time_series",
                                "interval": "",
                                "legendFormat": "{{type}} ({{job}})",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Scrape targets DOWN(By Type)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 7,
                            "w": 12,
                            "x": 0,
                            "y": 20
                        },
                        "id": 132,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": true,
                                "expr": "sum(vm_promscrape_scrape_pool_targets{job=~\"$job\", instance=~\"$instance\", status=\"up\"}) by(job, scrape_job) > 0",
                                "format": "time_series",
                                "interval": "",
                                "legendFormat": "{{job}}: {{scrape_job}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Scrape targets UP(By Job)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 10,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 7,
                            "w": 12,
                            "x": 12,
                            "y": 20
                        },
                        "id": 133,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": true,
                                "expr": "sum(vm_promscrape_scrape_pool_targets{job=~\"$job\", instance=~\"$instance\", status=\"down\"}) by(job, scrape_job) > 0",
                                "format": "time_series",
                                "interval": "",
                                "legendFormat": "{{job}}: {{scrape_job}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Scrape targets DOWN(By Job)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the number of scrapes per second.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 27
                        },
                        "id": 20,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": true,
                                "expr": "sum(rate(vm_promscrape_scrapes_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job)",
                                "interval": "",
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Scrape rate  ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the number of datapoints scraped per second.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 27
                        },
                        "id": 126,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": true,
                                "expr": "sum(rate(vm_promscrape_scraped_samples_sum{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job)",
                                "interval": "",
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Scraped datapoints rate  ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "bytes"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 35
                        },
                        "id": 46,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "max(histogram_quantile(0.99, sum(rate(vm_promscrape_scrape_response_size_bytes_bucket{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job, vmrange))) by(job)",
                                "format": "time_series",
                                "interval": "",
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Scrape response size 0.99 quantile ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 10,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 35
                        },
                        "id": 31,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(rate(vm_promscrape_scrapes_failed_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job) > 0",
                                "interval": "",
                                "legendFormat": "scrapes failed ({{job}})",
                                "range": true,
                                "refId": "A"
                            },
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(rate(vm_promscrape_scrapes_timed_out_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job) > 0",
                                "interval": "",
                                "legendFormat": "timeouts ({{job}})",
                                "range": true,
                                "refId": "B"
                            },
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(rate(vm_promscrape_scrapes_gunzip_failed_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job) > 0",
                                "interval": "",
                                "legendFormat": "gunzip fails ({{job}})",
                                "range": true,
                                "refId": "C"
                            },
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(rate(vm_promscrape_dial_errors_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job) > 0",
                                "interval": "",
                                "legendFormat": "dial fails ({{job}})",
                                "range": true,
                                "refId": "D"
                            },
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(rate(vm_promscrape_max_scrape_size_exceeded_errors_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job) > 0",
                                "hide": false,
                                "interval": "",
                                "legendFormat": "max scrape size exceeded ({{job}})",
                                "range": true,
                                "refId": "E"
                            }
                        ],
                        "title": "Scrape fails  ($instance)",
                        "type": "timeseries"
                    }
                ],
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "refId": "A"
                    }
                ],
                "title": "Scraping",
                "type": "row"
            },
            {
                "collapsed": true,
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 37
                },
                "id": 71,
                "panels": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the rate of write requests served by ingestserver (UDP, TCP connections) and HTTP server.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 14
                        },
                        "id": 73,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": true,
                                "expr": "sum(rate(vm_ingestserver_requests_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job, type, net) > 0",
                                "interval": "",
                                "legendFormat": "{{net}}: {{ type }} ({{job}})",
                                "range": true,
                                "refId": "A"
                            },
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": true,
                                "expr": "sum(rate(vmagent_http_requests_total{job=~\"$job\", instance=~\"$instance\", protocol!=\"\"}[$__rate_interval])) by(job, protocol) > 0",
                                "interval": "",
                                "legendFormat": "{{ protocol }}: http ({{job}})",
                                "range": true,
                                "refId": "B"
                            }
                        ],
                        "title": "Requests rate  ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the rate of rows ingested in vmagent via push protocols.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 14
                        },
                        "id": 131,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": true,
                                "expr": "sum(rate(vmagent_rows_inserted_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job, type) > 0",
                                "interval": "",
                                "legendFormat": "{{ type }} ({{job}})",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Rows rate  ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows how many concurrent inserts are taking place.\n\nIf the number of concurrent inserts hitting the `limit` or is close to the `limit` constantly - it might be a sign of a resource shortage.\n\n If vmagent's CPU usage and remote write connection saturation are at normal level, it might be that `-maxConcurrentInserts` cmd-line flag need to be increased.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 22
                        },
                        "id": 130,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": true,
                                "expr": "max_over_time(vm_concurrent_insert_current{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])",
                                "interval": "",
                                "legendFormat": "{{instance}} ({{job}})",
                                "range": true,
                                "refId": "A"
                            },
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": true,
                                "expr": "min(vm_concurrent_insert_capacity{job=~\"$job\", instance=~\"$instance\"}) by(job)",
                                "interval": "",
                                "legendFormat": "limit ({{job}})",
                                "range": true,
                                "refId": "B"
                            }
                        ],
                        "title": "Concurrent inserts ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the rate of write errors in ingestserver (UDP, TCP connections) and HTTP server.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 22
                        },
                        "id": 77,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "exemplar": true,
                                "expr": "sum(rate(vm_ingestserver_request_errors_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(type, net) > 0",
                                "interval": "",
                                "legendFormat": "{{ type }} ({{net}})",
                                "refId": "A"
                            },
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "exemplar": true,
                                "expr": "sum(rate(vmagent_http_request_errors_total{job=~\"$job\", instance=~\"$instance\", protocol!=\"\"}[$__rate_interval])) by(protocol) > 0",
                                "interval": "",
                                "legendFormat": "{{ protocol }} (http)",
                                "refId": "B"
                            }
                        ],
                        "title": "Error rate  ($instance)",
                        "type": "timeseries"
                    }
                ],
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "refId": "A"
                    }
                ],
                "title": "Ingestion",
                "type": "row"
            },
            {
                "collapsed": true,
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 38
                },
                "id": 136,
                "panels": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "The 99th percentile of avg flush duration for the aggregated data. \n\nSmaller is better.\n\nAggregation can produce incorrect results ff flush duration exceeds configured deduplication interval. See \"Flush Timeouts\" panel.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "axisSoftMin": 0,
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "auto",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green",
                                            "value": null
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "s"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 7
                        },
                        "id": 137,
                        "options": {
                            "legend": {
                                "calcs": [],
                                "displayMode": "list",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "single",
                                "sort": "none"
                            }
                        },
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "histogram_quantile(0.99, vm_streamaggr_dedup_flush_duration_seconds_bucket{job=~\"$job\",instance=~\"$instance\"}[$__rate_interval])",
                                "instant": false,
                                "legendFormat": "{{instance}} ({{job}})",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Dedup flush duration (0.99)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Amount of ignored samples during aggregation. \nStream aggregation will drop samples with NaN values, or samples with too old timestamps. See https://docs.victoriametrics.com/stream-aggregation/#ignoring-old-samples ",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "axisSoftMin": 0,
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "auto",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green",
                                            "value": null
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                }
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 7
                        },
                        "id": 143,
                        "options": {
                            "legend": {
                                "calcs": [],
                                "displayMode": "list",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "single",
                                "sort": "none"
                            }
                        },
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "increase(vm_streamaggr_ignored_samples_total[5m]) > 0",
                                "instant": false,
                                "legendFormat": "{{reason}}: {{instance}} ({{job}})",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Ignored samples",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows events when deduplication or aggregation couldn't be finished in the configured interval. Such events may result into bad accuracy of produced data.\n\nPossible solutions:\n* increase interval; \n* use match filter matching smaller number of series;\n* reduce samples ingestion rate to stream aggregation",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "axisSoftMin": 0,
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "auto",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "mappings": [],
                                "min": -5,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green",
                                            "value": null
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                }
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 15
                        },
                        "id": 139,
                        "options": {
                            "legend": {
                                "calcs": [],
                                "displayMode": "list",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "single",
                                "sort": "none"
                            }
                        },
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "increase(vm_streamaggr_flush_timeouts_total{job=~\"$job\",instance=~\"$instance\"}[$__rate_interval]) > 0",
                                "instant": false,
                                "legendFormat": "aggregate: {{instance}} ({{job}})",
                                "range": true,
                                "refId": "A"
                            },
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "increase(vm_streamaggr_dedup_flush_timeouts_total{job=~\"$job\",instance=~\"$instance\"}[$__rate_interval]) > 0",
                                "hide": false,
                                "instant": false,
                                "legendFormat": "dedup: {{instance}} ({{job}})",
                                "range": true,
                                "refId": "B"
                            }
                        ],
                        "title": "Flush timeouts",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the lag between average samples timestamp and aggregation interval.\n\nLower is better.\n\nToo high lag or lag exceeding the interval might be a sign of data delay before aggregation or resource insufficiency on aggregator. Samples with high lag may affect accuracy of aggregation.\n\nSee https://docs.victoriametrics.com/stream-aggregation/#ignoring-old-samples",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "axisSoftMin": 0,
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "auto",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green",
                                            "value": null
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "s"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 15
                        },
                        "id": 142,
                        "options": {
                            "legend": {
                                "calcs": [],
                                "displayMode": "list",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "single",
                                "sort": "none"
                            }
                        },
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "histogram_quantile(0.99, vm_streamaggr_samples_lag_seconds_bucket{job=~\"$job\",instance=~\"$instance\"}[$__rate_interval])",
                                "instant": false,
                                "legendFormat": "{{instance}} ({{job}})",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Aggregated samples lag",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the size of Label Compressor in bytes.\n\nLabels compressor encodes label-value pairs during aggregation to optimise memory usage. It is expected for its size to grow with time and to reset on vmagent restarts.\n\nRapid spikes in Label compressor size might be a sign of significant changes in labels of received samples.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "axisSoftMin": 0,
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "auto",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green",
                                            "value": null
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "decbytes"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 23
                        },
                        "id": 140,
                        "options": {
                            "legend": {
                                "calcs": [],
                                "displayMode": "list",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "single",
                                "sort": "none"
                            }
                        },
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "vm_streamaggr_labels_compressor_size_bytes{job=~\"$job\",instance=~\"$instance\"} > 0",
                                "instant": false,
                                "legendFormat": "{{instance}} ({{job}})",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Labels compressor bytes",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the size of Label Compressor in number of entries.\n\nLabels compressor encodes label-value pairs during aggregation to optimise memory usage. It is expected for its size to grow with time and to reset on vmagent restarts.\n\nRapid spikes in Label compressor size might be a sign of significant changes in labels of received samples.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "axisSoftMin": 0,
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "auto",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green",
                                            "value": null
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                }
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 23
                        },
                        "id": 141,
                        "options": {
                            "legend": {
                                "calcs": [],
                                "displayMode": "list",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "single",
                                "sort": "none"
                            }
                        },
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "vm_streamaggr_labels_compressor_items_count{job=~\"$job\",instance=~\"$instance\"} > 0",
                                "instant": false,
                                "legendFormat": "{{instance}} ({{job}})",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Labels compressor items count",
                        "type": "timeseries"
                    }
                ],
                "title": "Streaming aggregation",
                "type": "row"
            },
            {
                "collapsed": true,
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 39
                },
                "id": 58,
                "panels": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the rate of requests to configured remote write endpoints by url and status code.\n\nRemote write URLs are hidden by default but might be unveiled once `-remoteWrite.showURL` is set to true.\n\n",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "decimals": 2,
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 16
                        },
                        "id": 60,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": true,
                                "expr": "sum(rate(vmagent_remotewrite_requests_total{job=~\"$job\", instance=~\"$instance\", url=~\"$url\"}[$__rate_interval])) by(job, url, status_code) > 0",
                                "interval": "",
                                "legendFormat": "",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Requests rate ($instance) to ($url)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the global rate for number of written bytes via remote write connections.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "decbytes"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 16
                        },
                        "id": 66,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": true,
                                "expr": "sum(rate(vmagent_remotewrite_conn_bytes_written_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job) > 0",
                                "interval": "",
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Bytes write rate ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows requests retry rate by url. Number of retries is unlimited but protected with delays up to 1m between attempts.\n\nRemote write URLs are hidden by default but might be unveiled once `-remoteWrite.showURL` is set to true.\n\n",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 24
                        },
                        "id": 61,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": true,
                                "expr": "sum(rate(vmagent_remotewrite_retries_count_total{job=~\"$job\", instance=~\"$instance\", url=~\"$url\"}[$__rate_interval])) by(url) > 0",
                                "interval": "",
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Retry rate ($instance) to ($url)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows current number of established connections to remote write endpoints.\n\n",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 24
                        },
                        "id": 65,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": true,
                                "expr": "sum(max_over_time(vmagent_remotewrite_conns{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job)",
                                "interval": "",
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Connections ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the current limit usage of unique series over an hourly period. Vmagent will start to drop series once the limit is reached.\n\nPlease note, panel will be blank if `remoteWrite.maxHourlySeries` is not set.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "line"
                                    }
                                },
                                "mappings": [],
                                "max": 100,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "transparent"
                                        },
                                        {
                                            "color": "red",
                                            "value": 0.9
                                        }
                                    ]
                                },
                                "unit": "percent"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 32
                        },
                        "id": 88,
                        "options": {
                            "legend": {
                                "calcs": [],
                                "displayMode": "list",
                                "placement": "bottom",
                                "showLegend": false
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": true,
                                "expr": "max(\n  vmagent_hourly_series_limit_current_series{job=~\"$job\", instance=~\"$instance\"} \n  / \n  vmagent_hourly_series_limit_max_series{job=~\"$job\", instance=~\"$instance\"}\n  ) by(job) * 100",
                                "interval": "",
                                "legendFormat": "{{job}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Hourly series limit",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows saturation of every connection to remote storage. If the threshold of 90% is reached, then the connection is saturated (busy or slow) by more than 90%, so vmagent won't be able to keep up and can start buffering data. \n\nThis usually means that `-remoteWrite.queues` command-line flag must be increased in order to increase the number of connections per each remote storage.\n",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "line"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "transparent"
                                        },
                                        {
                                            "color": "red",
                                            "value": 0.9
                                        }
                                    ]
                                },
                                "unit": "percentunit"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 32
                        },
                        "id": 84,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": true,
                                "expr": "max(\n  rate(vmagent_remotewrite_send_duration_seconds_total{job=~\"$job\", instance=~\"$instance\", url=~\"$url\"}[$__rate_interval])\n  /\n  vmagent_remotewrite_queues{job=~\"$job\", instance=~\"$instance\", url=~\"$url\"}\n) by(job, url)",
                                "interval": "",
                                "legendFormat": "",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Remote write connection saturation ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the current limit usage of unique series over a daily period. Vmagent will start to drop series once the limit is reached.\n\nPlease note, panel will be blank if `remoteWrite.maxDailySeries` is not set.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "line"
                                    }
                                },
                                "mappings": [],
                                "max": 100,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "transparent"
                                        },
                                        {
                                            "color": "red",
                                            "value": 0.9
                                        }
                                    ]
                                },
                                "unit": "percentunit"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 40
                        },
                        "id": 90,
                        "options": {
                            "legend": {
                                "calcs": [],
                                "displayMode": "list",
                                "placement": "bottom",
                                "showLegend": false
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": true,
                                "expr": "max(\n  vmagent_daily_series_limit_current_series{job=~\"$job\",instance=~\"$instance\"} \n  / \n  vmagent_daily_series_limit_max_series{job=~\"$job\",instance=~\"$instance\"}\n) by(job)",
                                "interval": "",
                                "legendFormat": "{{job}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Daily series limit",
                        "type": "timeseries"
                    }
                ],
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "refId": "A"
                    }
                ],
                "title": "Remote write",
                "type": "row"
            },
            {
                "collapsed": true,
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 40
                },
                "id": 113,
                "panels": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "gridPos": {
                            "h": 2,
                            "w": 24,
                            "x": 0,
                            "y": 17
                        },
                        "id": 115,
                        "options": {
                            "code": {
                                "language": "plaintext",
                                "showLineNumbers": false,
                                "showMiniMap": false
                            },
                            "content": "Drilldown row is used by other panels on the dashboard to show more detailed metrics per-instance.",
                            "mode": "markdown"
                        },
                        "pluginVersion": "10.4.2",
                        "transparent": true,
                        "type": "text"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 19
                        },
                        "id": 119,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": false,
                                "expr": "sum(rate(process_cpu_seconds_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job, instance)",
                                "format": "time_series",
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "{{instance}} ({{job}})",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "CPU usage ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the used memory (resident).\nThe application's performance will significantly degrade when memory usage is close to 100%.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        }
                                    ]
                                },
                                "unit": "decbytes"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 19
                        },
                        "id": 117,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.1.0",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": true,
                                "expr": "max_over_time(process_resident_memory_bytes{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])",
                                "interval": "",
                                "legendFormat": "{{instance}} ({{job}})",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "RSS memory usage ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the persistent queue size of pending samples in bytes which hasn't been flushed to remote storage yet. \n\nIncreasing of value might be a sign of connectivity issues. In such cases, vmagent starts to flush pending data on disk with attempt to send it later once connection is restored.\n\nRemote write URLs are hidden by default but might be unveiled once `-remoteWrite.showURL` is set to true.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "bytes"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 27
                        },
                        "id": 125,
                        "links": [
                            {
                                "title": "Troubleshooting",
                                "url": "https://docs.victoriametrics.com/vmagent/#troubleshooting"
                            }
                        ],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": true,
                                "expr": "sum(vmagent_remotewrite_pending_data_bytes{job=~\"$job\", instance=~\"$instance\", url=~\"$url\"}) by (instance, url)",
                                "interval": "",
                                "legendFormat": "{{instance}} => {{url}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Persistent queue size  ($instance) to ($url)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows in/out samples rate including push and pull models. \n\nThe out-rate could be different to in-rate because of replication or additional timeseries added by vmagent for every scraped target.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": [
                                {
                                    "matcher": {
                                        "id": "byRegexp",
                                        "options": "/out .*/"
                                    },
                                    "properties": [
                                        {
                                            "id": "custom.transform",
                                            "value": "negative-Y"
                                        }
                                    ]
                                }
                            ]
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 27
                        },
                        "id": 123,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(rate(vm_promscrape_scraped_samples_sum{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job, instance)\n+ sum(rate(vmagent_rows_inserted_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job, instance)",
                                "hide": false,
                                "interval": "",
                                "legendFormat": "in {{instance}} {{job}}",
                                "range": true,
                                "refId": "A"
                            },
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(rate(vmagent_remotewrite_block_size_rows_sum{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job, instance)",
                                "interval": "",
                                "legendFormat": "out {{instance}} {{job}}",
                                "range": true,
                                "refId": "B"
                            }
                        ],
                        "title": "Samples rate ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the number of bytes read/write from the storage layer when vmagent has to buffer data on disk or read already buffered data.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "bytes"
                            },
                            "overrides": [
                                {
                                    "matcher": {
                                        "id": "byName",
                                        "options": "read"
                                    },
                                    "properties": [
                                        {
                                            "id": "custom.transform",
                                            "value": "negative-Y"
                                        }
                                    ]
                                }
                            ]
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 35
                        },
                        "id": 121,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(rate(process_io_storage_read_bytes_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job, instance)",
                                "format": "time_series",
                                "hide": false,
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "read {{instance}} {{job}}",
                                "range": true,
                                "refId": "A"
                            },
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(rate(process_io_storage_written_bytes_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job,instance)",
                                "format": "time_series",
                                "hide": false,
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "write {{instance}} {{job}}",
                                "range": true,
                                "refId": "B"
                            }
                        ],
                        "title": "Disk writes/reads ($instance)",
                        "type": "timeseries"
                    }
                ],
                "title": "Drilldown",
                "type": "row"
            }
        ],
        "refresh": "",
        "schemaVersion": 39,
        "tags": [
            "vmagent",
            "victoriametrics",
            "vm-k8s-stack"
        ],
        "templating": {
            "list": [
                {
                    "current": {
                        "selected": false,
                        "text": "VictoriaMetrics",
                        "value": "P4169E866C3094E38"
                    },
                    "hide": 0,
                    "includeAll": false,
                    "multi": false,
                    "name": "ds",
                    "options": [

                    ],
                    "query": "prometheus",
                    "queryValue": "",
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "type": "datasource"
                },
                {
                    "allValue": "",
                    "current": {

                    },
                    "datasource": {
                        "type": "prometheus",
                        "uid": "$ds"
                    },
                    "definition": "label_values(vm_app_version{version=~\"^vmagent.*\"}, job)",
                    "hide": 0,
                    "includeAll": true,
                    "multi": true,
                    "name": "job",
                    "options": [

                    ],
                    "query": {
                        "query": "label_values(vm_app_version{version=~\"^vmagent.*\"}, job)",
                        "refId": "VictoriaMetrics-job-Variable-Query"
                    },
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": 0,
                    "tagValuesQuery": "",
                    "tagsQuery": "",
                    "type": "query",
                    "useTags": false
                },
                {
                    "allValue": ".*",
                    "current": {

                    },
                    "datasource": {
                        "type": "prometheus",
                        "uid": "$ds"
                    },
                    "definition": "label_values(vm_app_version{job=~\"$job\"}, instance)",
                    "hide": 0,
                    "includeAll": true,
                    "multi": true,
                    "name": "instance",
                    "options": [

                    ],
                    "query": {
                        "query": "label_values(vm_app_version{job=~\"$job\"}, instance)",
                        "refId": "VictoriaMetrics-instance-Variable-Query"
                    },
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": 0,
                    "tagValuesQuery": "",
                    "tagsQuery": "",
                    "type": "query",
                    "useTags": false
                },
                {
                    "allValue": ".*",
                    "current": {

                    },
                    "datasource": {
                        "type": "prometheus",
                        "uid": "$ds"
                    },
                    "definition": "label_values(vmagent_remotewrite_requests_total{job=~\"$job\", instance=~\"$instance\"}, url)",
                    "description": "The remote write URLs",
                    "hide": 0,
                    "includeAll": true,
                    "multi": true,
                    "name": "url",
                    "options": [

                    ],
                    "query": {
                        "query": "label_values(vmagent_remotewrite_requests_total{job=~\"$job\", instance=~\"$instance\"}, url)",
                        "refId": "StandardVariableQuery"
                    },
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": 0,
                    "type": "query"
                },
                {
                    "datasource": {
                        "type": "prometheus",
                        "uid": "$ds"
                    },
                    "filters": [

                    ],
                    "hide": 0,
                    "name": "adhoc",
                    "skipUrlSync": false,
                    "type": "adhoc"
                }
            ]
        },
        "time": {
            "from": "now-3h",
            "to": "now"
        },
        "timepicker": {
            "refresh_intervals": [
                "10s",
                "30s",
                "1m",
                "5m",
                "15m",
                "30m",
                "1h",
                "2h",
                "1d"
            ]
        },
        "timezone": "utc",
        "title": "VictoriaMetrics - vmagent",
        "uid": "G7Z9GzMGz",
        "version": 1,
        "weekStart": ""
    }
---
# Source: victoria-metrics-k8s-stack/templates/grafana/dashboards/vmalert.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-vmalert
  labels:
    grafana_dashboard: "1"
    app: victoria-metrics-k8s-stack-grafana
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
data:
  vmalert.json:  |-
    {
        "__inputs": [],
        "__elements": {},
        "__requires": [
            {
                "type": "grafana",
                "id": "grafana",
                "name": "Grafana",
                "version": "10.4.2"
            },
            {
                "type": "datasource",
                "id": "prometheus",
                "name": "Prometheus",
                "version": "1.0.0"
            },
            {
                "type": "panel",
                "id": "stat",
                "name": "Stat",
                "version": ""
            },
            {
                "type": "panel",
                "id": "table",
                "name": "Table",
                "version": ""
            },
            {
                "type": "panel",
                "id": "timeseries",
                "name": "Time series",
                "version": ""
            }
        ],
        "annotations": {
            "list": [
                {
                    "builtIn": 1,
                    "datasource": {
                        "type": "datasource",
                        "uid": "grafana"
                    },
                    "enable": true,
                    "hide": true,
                    "iconColor": "rgba(0, 211, 255, 1)",
                    "name": "Annotations & Alerts",
                    "target": {
                        "limit": 100,
                        "matchAny": false,
                        "tags": [],
                        "type": "dashboard"
                    },
                    "type": "dashboard"
                },
                {
                    "datasource": {
                        "type": "prometheus",
                        "uid": "$ds"
                    },
                    "enable": true,
                    "expr": "sum(vm_app_version{job=~\"$job\", instance=~\"$instance\"}) by(short_version) unless (sum(vm_app_version{job=~\"$job\", instance=~\"$instance\"} offset $__interval) by(short_version))",
                    "hide": true,
                    "iconColor": "dark-blue",
                    "name": "version",
                    "textFormat": "{{short_version}}",
                    "titleFormat": "Version change"
                },
                {
                    "datasource": {
                        "type": "prometheus",
                        "uid": "$ds"
                    },
                    "enable": true,
                    "expr": "sum(changes(vm_app_start_timestamp{job=~\"$job\", instance=~\"$instance\"}[$__interval])) by(job, instance)",
                    "iconColor": "dark-yellow",
                    "name": "restarts",
                    "textFormat": "{{job}}:{{instance}} restarted"
                }
            ]
        },
        "description": "Overview for VictoriaMetrics vmalert v1.102.0 or higher",
        "editable": false,
        "fiscalYearStartMonth": 0,
        "graphTooltip": 1,
        "id": null,
        "links": [
            {
                "asDropdown": false,
                "icon": "external link",
                "includeVars": false,
                "keepTime": false,
                "tags": [],
                "targetBlank": true,
                "title": "vmalert docs",
                "tooltip": "",
                "type": "link",
                "url": "https://docs.victoriametrics.com/vmalert/"
            },
            {
                "asDropdown": false,
                "icon": "external link",
                "includeVars": false,
                "keepTime": false,
                "tags": [],
                "targetBlank": true,
                "title": "Found a bug?",
                "tooltip": "",
                "type": "link",
                "url": " https://github.com/VictoriaMetrics/VictoriaMetrics/issues"
            },
            {
                "asDropdown": false,
                "icon": "external link",
                "includeVars": false,
                "keepTime": false,
                "tags": [],
                "targetBlank": true,
                "title": "New releases",
                "tooltip": "",
                "type": "link",
                "url": " https://github.com/VictoriaMetrics/VictoriaMetrics/releases"
            }
        ],
        "liveNow": false,
        "panels": [
            {
                "collapsed": false,
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 0
                },
                "id": 47,
                "panels": [],
                "title": "Stats",
                "type": "row"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Shows if the last configuration update was successful. \"Not Ok\" means there was an unsuccessful attempt to update the configuration due to some error. Check the log for details.",
                "fieldConfig": {
                    "defaults": {
                        "mappings": [
                            {
                                "options": {
                                    "0": {
                                        "color": "green",
                                        "index": 0,
                                        "text": "Ok"
                                    }
                                },
                                "type": "value"
                            },
                            {
                                "options": {
                                    "from": 1,
                                    "result": {
                                        "color": "red",
                                        "index": 1,
                                        "text": "Not Ok"
                                    },
                                    "to": 999999
                                },
                                "type": "range"
                            }
                        ],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                }
                            ]
                        }
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 3,
                    "w": 4,
                    "x": 0,
                    "y": 1
                },
                "id": 6,
                "options": {
                    "colorMode": "value",
                    "graphMode": "area",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "last"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "text": {},
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.2",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "exemplar": false,
                        "expr": "count(vmalert_config_last_reload_successful{job=~\"$job\", instance=~\"$instance\"} < 1 ) or 0",
                        "interval": "",
                        "legendFormat": "",
                        "refId": "A"
                    }
                ],
                "title": "Config update",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Shows the total number of loaded alerting rules across selected instances and groups.",
                "fieldConfig": {
                    "defaults": {
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                }
                            ]
                        }
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 3,
                    "w": 5,
                    "x": 4,
                    "y": 1
                },
                "id": 9,
                "options": {
                    "colorMode": "value",
                    "graphMode": "area",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "last"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "text": {},
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.2",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "exemplar": false,
                        "expr": "count(vmalert_alerting_rules_last_evaluation_samples{job=~\"$job\", instance=~\"$instance\", group=~\"$group\"})",
                        "interval": "",
                        "legendFormat": "",
                        "refId": "A"
                    }
                ],
                "title": "Alerting rules",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Shows the total number of loaded recording rules across selected instances and groups.",
                "fieldConfig": {
                    "defaults": {
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                }
                            ]
                        }
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 3,
                    "w": 5,
                    "x": 9,
                    "y": 1
                },
                "id": 7,
                "options": {
                    "colorMode": "value",
                    "graphMode": "area",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "last"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "text": {},
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.2",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "exemplar": false,
                        "expr": "count(vmalert_recording_rules_last_evaluation_samples{job=~\"$job\", instance=~\"$instance\", group=~\"$group\"})",
                        "interval": "",
                        "legendFormat": "",
                        "refId": "A"
                    }
                ],
                "title": "Recording rules",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Shows the total number of errors generated by recording/alerting rules for selected instances and groups.",
                "fieldConfig": {
                    "defaults": {
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 1
                                }
                            ]
                        }
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 3,
                    "w": 5,
                    "x": 14,
                    "y": 1
                },
                "id": 8,
                "options": {
                    "colorMode": "value",
                    "graphMode": "area",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "last"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "text": {},
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.2",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "exemplar": false,
                        "expr": "(sum(increase(vmalert_alerting_rules_errors_total{job=~\"$job\", instance=~\"$instance\", group=~\"$group\"}[$__rate_interval])) or vector(0)) + \n(sum(increase(vmalert_recording_rules_errors_total{job=~\"$job\", instance=~\"$instance\", group=~\"$group\"}[$__rate_interval])) or vector(0))",
                        "interval": "",
                        "legendFormat": "",
                        "refId": "A"
                    }
                ],
                "title": "Errors",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Shows number of Recording Rules which produce no data.\n\n Usually it means that such rules are misconfigured, since they give no output during the evaluation.\nPlease check if rule's expression is correct and it is working as expected.",
                "fieldConfig": {
                    "defaults": {
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 1
                                }
                            ]
                        }
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 3,
                    "w": 5,
                    "x": 19,
                    "y": 1
                },
                "id": 48,
                "options": {
                    "colorMode": "value",
                    "graphMode": "area",
                    "justifyMode": "auto",
                    "orientation": "auto",
                    "reduceOptions": {
                        "calcs": [
                            "last"
                        ],
                        "fields": "",
                        "values": false
                    },
                    "showPercentChange": false,
                    "text": {},
                    "textMode": "auto",
                    "wideLayout": true
                },
                "pluginVersion": "10.4.2",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "count(vmalert_recording_rules_last_evaluation_samples{job=~\"$job\", instance=~\"$instance\"} < 1) or 0",
                        "interval": "",
                        "legendFormat": "",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "No data errors",
                "type": "stat"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "thresholds"
                        },
                        "custom": {
                            "align": "auto",
                            "cellOptions": {
                                "type": "auto"
                            },
                            "inspect": false,
                            "minWidth": 50
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        }
                    },
                    "overrides": [
                        {
                            "matcher": {
                                "id": "byName",
                                "options": "Time"
                            },
                            "properties": [
                                {
                                    "id": "custom.hidden",
                                    "value": true
                                }
                            ]
                        },
                        {
                            "matcher": {
                                "id": "byName",
                                "options": "Value"
                            },
                            "properties": [
                                {
                                    "id": "displayName",
                                    "value": "Count"
                                }
                            ]
                        }
                    ]
                },
                "gridPos": {
                    "h": 4,
                    "w": 9,
                    "x": 0,
                    "y": 4
                },
                "id": 45,
                "options": {
                    "cellHeight": "sm",
                    "footer": {
                        "countRows": false,
                        "fields": "",
                        "reducer": [
                            "sum"
                        ],
                        "show": false
                    },
                    "showHeader": true
                },
                "pluginVersion": "10.4.2",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "sum(vm_app_version{job=~\"$job\", instance=~\"$instance\"}) by(job, short_version)",
                        "format": "table",
                        "instant": true,
                        "range": false,
                        "refId": "A"
                    }
                ],
                "type": "table"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 0,
                            "gradientMode": "none",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "stepAfter",
                            "lineWidth": 1,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "decimals": 0,
                        "links": [],
                        "mappings": [],
                        "min": 0,
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 4,
                    "w": 15,
                    "x": 9,
                    "y": 4
                },
                "id": 4,
                "options": {
                    "legend": {
                        "calcs": [
                            "lastNotNull"
                        ],
                        "displayMode": "table",
                        "placement": "right",
                        "showLegend": true,
                        "sortBy": "Last *",
                        "sortDesc": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "asc"
                    }
                },
                "pluginVersion": "9.2.6",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "sum(min_over_time(up{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by (job)",
                        "format": "time_series",
                        "instant": false,
                        "interval": "",
                        "legendFormat": "{{job}}",
                        "refId": "A"
                    }
                ],
                "title": "Uptime",
                "type": "timeseries"
            },
            {
                "collapsed": false,
                "datasource": {
                    "type": "prometheus",
                    "uid": "grafana"
                },
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 8
                },
                "id": 11,
                "panels": [],
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "grafana"
                        },
                        "refId": "A"
                    }
                ],
                "title": "Overview ($instance)",
                "type": "row"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Shows the number of fired alerts by job.",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 0,
                            "gradientMode": "none",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "linear",
                            "lineWidth": 1,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 9
                },
                "id": 15,
                "options": {
                    "legend": {
                        "calcs": [
                            "mean",
                            "lastNotNull",
                            "max"
                        ],
                        "displayMode": "table",
                        "placement": "bottom",
                        "showLegend": true,
                        "sortBy": "Last *",
                        "sortDesc": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "9.2.6",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "sum(increase(vmalert_alerts_fired_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job)",
                        "interval": "",
                        "legendFormat": "{{job}}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Alerts fired total ($instance)",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Top $topk groups by evaluation duration. Shows groups that take the most of time during the evaluation across all instances.\n\nThe panel uses MetricsQL functions and may not work with Prometheus.",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 0,
                            "gradientMode": "none",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "linear",
                            "lineWidth": 1,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "s"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 9
                },
                "id": 23,
                "options": {
                    "legend": {
                        "calcs": [
                            "mean",
                            "lastNotNull",
                            "max"
                        ],
                        "displayMode": "table",
                        "placement": "bottom",
                        "showLegend": true,
                        "sortBy": "Last *",
                        "sortDesc": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "9.2.6",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "topk_max($topk, max(sum(\n    rate(vmalert_iteration_duration_seconds_sum{job=~\"$job\", instance=~\"$instance\", group=~\"$group\"}[$__rate_interval])\n/\n    rate(vmalert_iteration_duration_seconds_count{job=~\"$job\", instance=~\"$instance\", group=~\"$group\"}[$__rate_interval])\n) by(job, instance, group)) \nby(job, group))",
                        "interval": "",
                        "legendFormat": "{{group}} ({{job}})",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Top $topk groups avg evaluation duration ($group)",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Shows how many requests (executions) per second vmalert sends to the configured datasource.",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 0,
                            "gradientMode": "none",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "linear",
                            "lineWidth": 1,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 17
                },
                "id": 24,
                "options": {
                    "legend": {
                        "calcs": [
                            "mean",
                            "lastNotNull",
                            "max"
                        ],
                        "displayMode": "table",
                        "placement": "bottom",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "desc"
                    }
                },
                "pluginVersion": "9.2.6",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "sum(rate(vmalert_execution_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by (job)",
                        "interval": "",
                        "legendFormat": "{{job}}",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Rules execution rate ($instance)",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Shows the error rate while executing configured rules. Non-zero value means there are some issues with existing rules. Check the logs to get more details.",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisBorderShow": false,
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "line",
                            "fillOpacity": 10,
                            "gradientMode": "none",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "insertNulls": false,
                            "lineInterpolation": "linear",
                            "lineWidth": 1,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green",
                                    "value": null
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 17
                },
                "id": 25,
                "options": {
                    "legend": {
                        "calcs": [
                            "mean",
                            "lastNotNull",
                            "max"
                        ],
                        "displayMode": "table",
                        "placement": "bottom",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "9.2.6",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "sum(rate(vmalert_execution_errors_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job) > 0",
                        "interval": "",
                        "legendFormat": "__auto",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Rules execution errors ($instance)",
                "type": "timeseries"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "thresholds"
                        },
                        "custom": {
                            "align": "auto",
                            "cellOptions": {
                                "type": "auto"
                            },
                            "inspect": false
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green"
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        }
                    },
                    "overrides": [
                        {
                            "matcher": {
                                "id": "byName",
                                "options": "Value"
                            },
                            "properties": [
                                {
                                    "id": "custom.hidden",
                                    "value": true
                                }
                            ]
                        },
                        {
                            "matcher": {
                                "id": "byName",
                                "options": "Time"
                            },
                            "properties": [
                                {
                                    "id": "custom.hidden",
                                    "value": true
                                }
                            ]
                        }
                    ]
                },
                "gridPos": {
                    "h": 7,
                    "w": 12,
                    "x": 0,
                    "y": 25
                },
                "id": 50,
                "options": {
                    "footer": {
                        "fields": "",
                        "reducer": [
                            "sum"
                        ],
                        "show": false
                    },
                    "showHeader": true,
                    "sortBy": [
                        {
                            "desc": true,
                            "displayName": "job"
                        }
                    ]
                },
                "pluginVersion": "9.2.7",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "sum(flag{is_set=\"true\", job=~\"$job\", instance=~\"$instance\"}) by(job, instance, name, value)",
                        "format": "table",
                        "instant": true,
                        "legendFormat": "__auto",
                        "range": false,
                        "refId": "A"
                    }
                ],
                "title": "Non-default flags",
                "transformations": [
                    {
                        "id": "groupBy",
                        "options": {
                            "fields": {
                                "instance": {
                                    "aggregations": [
                                        "uniqueValues"
                                    ],
                                    "operation": "aggregate"
                                },
                                "job": {
                                    "aggregations": [],
                                    "operation": "groupby"
                                },
                                "name": {
                                    "aggregations": [],
                                    "operation": "groupby"
                                },
                                "value": {
                                    "aggregations": [],
                                    "operation": "groupby"
                                }
                            }
                        }
                    }
                ],
                "type": "table"
            },
            {
                "datasource": {
                    "type": "prometheus",
                    "uid": "$ds"
                },
                "description": "Missed evaluation means that group evaluation time takes longer than the configured evaluation interval. \nThis may result in missed alerting notifications or recording rules samples. Try increasing evaluation interval or concurrency for such groups. See https://docs.victoriametrics.com/vmalert/#groups\n\nIf rule expressions are taking longer than expected, please see https://docs.victoriametrics.com/troubleshooting/#slow-queries.\"",
                "fieldConfig": {
                    "defaults": {
                        "color": {
                            "mode": "palette-classic"
                        },
                        "custom": {
                            "axisCenteredZero": false,
                            "axisColorMode": "text",
                            "axisLabel": "",
                            "axisPlacement": "auto",
                            "barAlignment": 0,
                            "drawStyle": "bars",
                            "fillOpacity": 10,
                            "gradientMode": "none",
                            "hideFrom": {
                                "legend": false,
                                "tooltip": false,
                                "viz": false
                            },
                            "lineInterpolation": "linear",
                            "lineWidth": 1,
                            "pointSize": 5,
                            "scaleDistribution": {
                                "type": "linear"
                            },
                            "showPoints": "never",
                            "spanNulls": false,
                            "stacking": {
                                "group": "A",
                                "mode": "none"
                            },
                            "thresholdsStyle": {
                                "mode": "off"
                            }
                        },
                        "mappings": [],
                        "thresholds": {
                            "mode": "absolute",
                            "steps": [
                                {
                                    "color": "green"
                                },
                                {
                                    "color": "red",
                                    "value": 80
                                }
                            ]
                        },
                        "unit": "short"
                    },
                    "overrides": []
                },
                "gridPos": {
                    "h": 7,
                    "w": 12,
                    "x": 12,
                    "y": 25
                },
                "id": 58,
                "options": {
                    "legend": {
                        "calcs": [
                            "mean",
                            "lastNotNull",
                            "max"
                        ],
                        "displayMode": "table",
                        "placement": "bottom",
                        "showLegend": true
                    },
                    "tooltip": {
                        "mode": "multi",
                        "sort": "none"
                    }
                },
                "pluginVersion": "9.2.6",
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "editorMode": "code",
                        "exemplar": false,
                        "expr": "sum(increase(vmalert_iteration_missed_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job, group) > 0",
                        "interval": "1m",
                        "legendFormat": "__auto",
                        "range": true,
                        "refId": "A"
                    }
                ],
                "title": "Missed evaluations ($instance)",
                "type": "timeseries"
            },
            {
                "collapsed": true,
                "datasource": {
                    "type": "prometheus",
                    "uid": "grafana"
                },
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 32
                },
                "id": 43,
                "panels": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "The precentage of used RSS memory\n\nIf you think that usage is abnormal or unexpected, please file an issue and attach memory profile if possible.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "percentunit",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 3
                        },
                        "id": 37,
                        "links": [
                            {
                                "targetBlank": true,
                                "title": "Profiling",
                                "url": "https://docs.victoriametrics.com/vmagent/#profiling"
                            }
                        ],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": false,
                                "expr": "max(\n    max_over_time(process_resident_memory_bytes{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])\n    /\n    vm_available_memory_bytes{job=~\"$job\", instance=~\"$instance\"}\n) by(job)",
                                "interval": "",
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Memory usage % ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Amount of used RSS memory\n\nIf you think that usage is abnormal or unexpected, please file an issue and attach memory profile if possible.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "bytes",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 3
                        },
                        "id": 57,
                        "links": [
                            {
                                "targetBlank": true,
                                "title": "Profiling",
                                "url": "https://docs.victoriametrics.com/vmagent/#profiling"
                            }
                        ],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": false,
                                "expr": "max(\n    max_over_time(process_resident_memory_bytes{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])\n) by(job)",
                                "interval": "",
                                "legendFormat": "{{job}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Memory usage ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the CPU usage percentage per vmalert instance. \nIf you think that usage is abnormal or unexpected pls file an issue and attach CPU profile if possible.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "percentunit",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 11
                        },
                        "id": 35,
                        "links": [
                            {
                                "targetBlank": true,
                                "title": "Profiling",
                                "url": "https://docs.victoriametrics.com/vmagent/#profiling"
                            }
                        ],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": false,
                                "expr": "max(\n  rate(process_cpu_seconds_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval]) \n  / \n  vm_available_cpu_cores{job=~\"$job\", instance=~\"$instance\"}\n) by(job)",
                                "format": "time_series",
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "{{job}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "CPU usage %($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the max number of CPU cores used  by a `job` and the corresponding limit.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 11
                        },
                        "id": 56,
                        "links": [
                            {
                                "targetBlank": true,
                                "title": "Profiling",
                                "url": "https://docs.victoriametrics.com/vmagent/#profiling"
                            }
                        ],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": false,
                                "expr": "max(rate(process_cpu_seconds_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job)",
                                "format": "time_series",
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "{{job}}",
                                "range": true,
                                "refId": "A"
                            },
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": false,
                                "expr": "min(process_cpu_cores_available{job=~\"$job\", instance=~\"$instance\"}) by(job)",
                                "format": "time_series",
                                "hide": false,
                                "interval": "",
                                "intervalFactor": 1,
                                "legendFormat": "limit ({{job}})",
                                "range": true,
                                "refId": "B"
                            }
                        ],
                        "title": "CPU usage ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Panel shows the percentage of open file descriptors in the OS.\nReaching the limit of open files can cause various issues and must be prevented.\n\nSee how to change limits here https://medium.com/@muhammadtriwibowo/set-permanently-ulimit-n-open-files-in-ubuntu-4d61064429a",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "decimals": 3,
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "percentunit",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 19
                        },
                        "id": 39,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": false,
                                "expr": "max(\n    max_over_time(process_open_fds{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])\n    /\n    process_max_fds{job=~\"$job\", instance=~\"$instance\"}\n) by(job)",
                                "format": "time_series",
                                "interval": "",
                                "intervalFactor": 2,
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Open FDs usage % ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "decimals": 0,
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 19
                        },
                        "id": 41,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(go_goroutines{job=~\"$job\", instance=~\"$instance\"}) by(job)",
                                "format": "time_series",
                                "interval": "",
                                "intervalFactor": 2,
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Goroutines ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the percent of CPU spent on garbage collection.\n\nIf % is high, then CPU usage can be decreased by changing GOGC to higher values. Increasing GOGC value will increase memory usage, and decrease CPU usage.\n\nTry searching for keyword `GOGC` at https://docs.victoriametrics.com/troubleshooting/ ",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "decimals": 0,
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "percentunit",
                                "unitScale": true
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 27
                        },
                        "id": 59,
                        "links": [],
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "max(\n  rate(go_gc_cpu_seconds_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval]) \n / rate(process_cpu_seconds_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])\n ) by(job)",
                                "format": "time_series",
                                "interval": "",
                                "intervalFactor": 2,
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "CPU spent on GC ($instance)",
                        "type": "timeseries"
                    }
                ],
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "grafana"
                        },
                        "refId": "A"
                    }
                ],
                "title": "Resource usage",
                "type": "row"
            },
            {
                "collapsed": true,
                "datasource": {
                    "type": "prometheus",
                    "uid": "grafana"
                },
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 33
                },
                "id": 17,
                "panels": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows top $topk current active (firing) alerting rules.\n\nThe panel uses MetricsQL functions and may not work with Prometheus.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 36
                        },
                        "id": 14,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": false,
                                "expr": "topk_max($topk, sum(vmalert_alerts_firing{job=~\"$job\", instance=~\"$instance\", group=~\"$group\"}) by(job, group, alertname) > 0)",
                                "interval": "",
                                "legendFormat": "{{group}}.{{alertname}} ({{job}})",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Top $topk active alerts ($group)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the events when rule execution resulted into an error. Check the logs for more details.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 36
                        },
                        "id": 13,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": false,
                                "expr": "sum(increase(vmalert_alerting_rules_errors_total{job=~\"$job\", instance=~\"$instance\", group=~\"$group\"}[$__rate_interval])) by(job, group, alertname) > 0",
                                "interval": "",
                                "legendFormat": "{{group}}.{{alertname}} ({{job}})",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Errors ($group)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the current pending alerting rules per group.\nBy pending means the rule which remains active less than configured `for` parameter.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 44
                        },
                        "id": 20,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Mean",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": false,
                                "expr": "sum(vmalert_alerts_pending{job=~\"$job\", instance=~\"$instance\", group=~\"$group\"}) by(job, group, alertname) > 0",
                                "interval": "",
                                "legendFormat": "{{group}}.{{alertname}} ({{job}})",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Pending ($group)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the error rate for the attempts to send alerts to Alertmanager. If not zero it means there issues on attempt to send notification to Alertmanager and some alerts may be not delivered properly. Check the logs for more details.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 44
                        },
                        "id": 32,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "exemplar": false,
                                "expr": "sum(rate(vmalert_alerts_send_errors_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(instance, addr) > 0",
                                "interval": "",
                                "legendFormat": "{{instance}} => {{addr}}",
                                "refId": "A"
                            }
                        ],
                        "title": "Errors rate to Alertmanager",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows how many alerts are sent to Alertmanager per second. Only active alerts are sent.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 52
                        },
                        "id": 26,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": false,
                                "expr": "sum(rate(vmalert_alerts_sent_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job, addr) > 0",
                                "interval": "",
                                "legendFormat": "{{job}} => {{addr}}",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Requests rate to Alertmanager by job ($group)",
                        "type": "timeseries"
                    }
                ],
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "grafana"
                        },
                        "refId": "A"
                    }
                ],
                "title": "Alerting rules ($instance)",
                "type": "row"
            },
            {
                "collapsed": true,
                "datasource": {
                    "type": "prometheus",
                    "uid": "grafana"
                },
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 34
                },
                "id": 28,
                "panels": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the top $topk recording rules which generate the most of [samples](https://docs.victoriametrics.com/keyconcepts/#raw-samples). Each generated sample is basically a time series which then ingested into configured remote storage. Rules with high numbers may cause the most pressure on the remote database and become a source of too high cardinality.\n\nThe panel uses MetricsQL functions and may not work with Prometheus.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 51
                        },
                        "id": 31,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": false,
                                "expr": "topk_max($topk, \n  max(\n    sum(vmalert_recording_rules_last_evaluation_samples{job=~\"$job\", instance=~\"$instance\", group=~\"$group\"}) by(job, instance, group, recording) > 0\n  ) by(job, group, recording)\n)",
                                "interval": "",
                                "legendFormat": "{{group}}.{{recording}} ({{job}})",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Top $topk rules by produced samples ($group)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the rules which do not produce any [samples](https://docs.victoriametrics.com/keyconcepts/#raw-samples) during the evaluation. Usually it means that such rules are misconfigured, since they give no output during the evaluation.\nPlease check if rule's expression is correct and it is working as expected.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": true,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 51
                        },
                        "id": 33,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "lastNotNull",
                                    "max",
                                    "mean"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true,
                                "sortBy": "Last *",
                                "sortDesc": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "pluginVersion": "8.0.3",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": false,
                                "expr": "count(vmalert_recording_rules_last_evaluation_samples{job=~\"$job\", instance=~\"$instance\", group=~\"$group\"} < 1) by(job, group, recording)",
                                "interval": "",
                                "legendFormat": "{{group}}.{{recording}} ({{job}})",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Rules with 0 produced samples ($group)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 59
                        },
                        "id": 30,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "none"
                            }
                        },
                        "pluginVersion": "9.2.6",
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": false,
                                "expr": "sum(increase(vmalert_recording_rules_errors_total{job=~\"$job\", instance=~\"$instance\", group=~\"$group\"}[$__rate_interval])) by(job, group, recording) > 0",
                                "interval": "",
                                "legendFormat": "{{group}}.{{recording}} ({{job}})",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Errors ($group)",
                        "type": "timeseries"
                    }
                ],
                "targets": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "grafana"
                        },
                        "refId": "A"
                    }
                ],
                "title": "Recording rules ($instance)",
                "type": "row"
            },
            {
                "collapsed": true,
                "gridPos": {
                    "h": 1,
                    "w": 24,
                    "x": 0,
                    "y": 35
                },
                "id": 55,
                "panels": [
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "auto",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                }
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 17
                        },
                        "id": 52,
                        "options": {
                            "legend": {
                                "calcs": [],
                                "displayMode": "list",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "single",
                                "sort": "desc"
                            }
                        },
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(rate(vmalert_remotewrite_sent_rows_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job)",
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Datapoints send rate ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the number of datapoints dropped by vmalert while sending to the configured remote write URL. vmalert performs up to 5 retries before dropping the data. Check vmalert's error logs for the specific error message.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "auto",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "mappings": [],
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                }
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 17
                        },
                        "id": 53,
                        "options": {
                            "legend": {
                                "calcs": [],
                                "displayMode": "list",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "single",
                                "sort": "desc"
                            }
                        },
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "expr": "sum(rate(vmalert_remotewrite_dropped_rows_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job) > 0",
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Datapoints drop rate ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows current number of established connections to remote write endpoints.\n\n",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green"
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "short"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 0,
                            "y": 44
                        },
                        "id": 54,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": true,
                                "expr": "sum(max_over_time(vmalert_remotewrite_conns{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job)",
                                "interval": "",
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Connections ($instance)",
                        "type": "timeseries"
                    },
                    {
                        "datasource": {
                            "type": "prometheus",
                            "uid": "$ds"
                        },
                        "description": "Shows the global rate for number of written bytes via remote write connections.",
                        "fieldConfig": {
                            "defaults": {
                                "color": {
                                    "mode": "palette-classic"
                                },
                                "custom": {
                                    "axisBorderShow": false,
                                    "axisCenteredZero": false,
                                    "axisColorMode": "text",
                                    "axisLabel": "",
                                    "axisPlacement": "auto",
                                    "barAlignment": 0,
                                    "drawStyle": "line",
                                    "fillOpacity": 0,
                                    "gradientMode": "none",
                                    "hideFrom": {
                                        "legend": false,
                                        "tooltip": false,
                                        "viz": false
                                    },
                                    "insertNulls": false,
                                    "lineInterpolation": "linear",
                                    "lineWidth": 1,
                                    "pointSize": 5,
                                    "scaleDistribution": {
                                        "type": "linear"
                                    },
                                    "showPoints": "never",
                                    "spanNulls": false,
                                    "stacking": {
                                        "group": "A",
                                        "mode": "none"
                                    },
                                    "thresholdsStyle": {
                                        "mode": "off"
                                    }
                                },
                                "links": [],
                                "mappings": [],
                                "min": 0,
                                "thresholds": {
                                    "mode": "absolute",
                                    "steps": [
                                        {
                                            "color": "green",
                                            "value": null
                                        },
                                        {
                                            "color": "red",
                                            "value": 80
                                        }
                                    ]
                                },
                                "unit": "decbytes"
                            },
                            "overrides": []
                        },
                        "gridPos": {
                            "h": 8,
                            "w": 12,
                            "x": 12,
                            "y": 44
                        },
                        "id": 55,
                        "options": {
                            "legend": {
                                "calcs": [
                                    "mean",
                                    "lastNotNull",
                                    "max"
                                ],
                                "displayMode": "table",
                                "placement": "bottom",
                                "showLegend": true
                            },
                            "tooltip": {
                                "mode": "multi",
                                "sort": "desc"
                            }
                        },
                        "targets": [
                            {
                                "datasource": {
                                    "type": "prometheus",
                                    "uid": "$ds"
                                },
                                "editorMode": "code",
                                "exemplar": true,
                                "expr": "sum(rate(vmalert_remotewrite_conn_bytes_written_total{job=~\"$job\", instance=~\"$instance\"}[$__rate_interval])) by(job) > 0",
                                "interval": "",
                                "legendFormat": "__auto",
                                "range": true,
                                "refId": "A"
                            }
                        ],
                        "title": "Bytes write rate ($instance)",
                        "type": "timeseries"
                    }
                ],
                "title": "Remote write",
                "type": "row"
            }
        ],
        "refresh": "",
        "schemaVersion": 39,
        "tags": [
            "victoriametrics",
            "vmalert",
            "vm-k8s-stack"
        ],
        "templating": {
            "list": [
                {
                    "current": {
                        "selected": false,
                        "text": "VictoriaMetrics",
                        "value": "P4169E866C3094E38"
                    },
                    "hide": 0,
                    "includeAll": false,
                    "multi": false,
                    "name": "ds",
                    "options": [

                    ],
                    "query": "prometheus",
                    "queryValue": "",
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "type": "datasource"
                },
                {
                    "current": {

                    },
                    "datasource": {
                        "type": "prometheus",
                        "uid": "$ds"
                    },
                    "definition": "label_values(vm_app_version{version=~\"^vmalert.*\"}, job)",
                    "hide": 0,
                    "includeAll": true,
                    "multi": true,
                    "name": "job",
                    "options": [

                    ],
                    "query": {
                        "query": "label_values(vm_app_version{version=~\"^vmalert.*\"}, job)",
                        "refId": "StandardVariableQuery"
                    },
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": 0,
                    "type": "query"
                },
                {
                    "allValue": ".*",
                    "current": {

                    },
                    "datasource": {
                        "type": "prometheus",
                        "uid": "$ds"
                    },
                    "definition": "label_values(vm_app_version{job=~\"$job\"}, instance)",
                    "hide": 0,
                    "includeAll": true,
                    "multi": true,
                    "name": "instance",
                    "options": [

                    ],
                    "query": {
                        "query": "label_values(vm_app_version{job=~\"$job\"}, instance)",
                        "refId": "StandardVariableQuery"
                    },
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": 0,
                    "type": "query"
                },
                {
                    "allValue": ".*",
                    "current": {

                    },
                    "datasource": {
                        "type": "prometheus",
                        "uid": "$ds"
                    },
                    "definition": "label_values(vmalert_iteration_duration_seconds{job=~\"$job\", instance=~\"$instance\"}, group)",
                    "hide": 0,
                    "includeAll": true,
                    "multi": true,
                    "name": "group",
                    "options": [

                    ],
                    "query": {
                        "query": "label_values(vmalert_iteration_duration_seconds{job=~\"$job\", instance=~\"$instance\"}, group)",
                        "refId": "StandardVariableQuery"
                    },
                    "refresh": 1,
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": 0,
                    "type": "query"
                },
                {
                    "current": {
                        "selected": false,
                        "text": "5",
                        "value": "5"
                    },
                    "hide": 0,
                    "includeAll": false,
                    "multi": false,
                    "name": "topk",
                    "options": [
                        {
                            "selected": true,
                            "text": "5",
                            "value": "5"
                        },
                        {
                            "selected": false,
                            "text": "10",
                            "value": "10"
                        },
                        {
                            "selected": false,
                            "text": "20",
                            "value": "20"
                        },
                        {
                            "selected": false,
                            "text": "30",
                            "value": "30"
                        },
                        {
                            "selected": false,
                            "text": "40",
                            "value": "40"
                        },
                        {
                            "selected": false,
                            "text": "50",
                            "value": "50"
                        }
                    ],
                    "query": "5, 10, 20, 30, 40, 50",
                    "queryValue": "",
                    "skipUrlSync": false,
                    "type": "custom"
                },
                {
                    "datasource": {
                        "type": "prometheus",
                        "uid": "$ds"
                    },
                    "filters": [

                    ],
                    "hide": 0,
                    "name": "adhoc",
                    "skipUrlSync": false,
                    "type": "adhoc"
                }
            ]
        },
        "time": {
            "from": "now-3h",
            "to": "now"
        },
        "timepicker": {

        },
        "timezone": "utc",
        "title": "VictoriaMetrics - vmalert",
        "uid": "LzldHAVnz",
        "version": 1,
        "weekStart": ""
    }
---
# Source: victoria-metrics-k8s-stack/templates/grafana/datasource.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: my-release-victoria-metrics-k8s-stack-grafana-ds
  namespace: default
  labels:
    grafana_datasource: "1"
    app: victoria-metrics-k8s-stack-grafana
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
data:
  datasource.yaml: |-
    apiVersion: 1
    datasources:
    - name: VictoriaMetrics
      type: prometheus
      url: http://vmsingle-my-release-victoria-metrics-k8s-stack.default.svc:8429/
      access: proxy
      isDefault: true
      jsonData: 
        {}
---
# Source: victoria-metrics-k8s-stack/templates/victoria-metrics-operator/alertmanager/monzo-template.yaml
kind: ConfigMap
apiVersion: v1
metadata:
  name: my-release-victoria-metrics-k8s-stack-alertmanager-monzo-tpl
  namespace: default
  labels: 
    app.kubernetes.io/component: victoria-metrics-k8s-stack-alertmanager
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
data:
  monzo.tmpl: |-
    # This builds the silence URL.  We exclude the alertname in the range
    # to avoid the issue of having trailing comma separator (%2C) at the end
    # of the generated URL
    {{ define "__alert_silence_link" -}}
        {{ .ExternalURL }}/#/silences/new?filter=%7B
        {{- range .CommonLabels.SortedPairs -}}
            {{- if ne .Name "alertname" -}}
                {{- .Name }}%3D"{{- .Value | urlquery -}}"%2C%20
            {{- end -}}
        {{- end -}}
        alertname%3D"{{ .CommonLabels.alertname }}"%7D
    {{- end }}

    {{ define "__alert_severity_prefix" -}}
        {{ if ne .Status "firing" -}}
        :lgtm:
        {{- else if eq .Labels.severity "critical" -}}
        :fire:
        {{- else if eq .Labels.severity "warning" -}}
        :warning:
        {{- else -}}
        :question:
        {{- end }}
    {{- end }}

    {{ define "__alert_severity_prefix_title" -}}
        {{ if ne .Status "firing" -}}
        :lgtm:
        {{- else if eq .CommonLabels.severity "critical" -}}
        :fire:
        {{- else if eq .CommonLabels.severity "warning" -}}
        :warning:
        {{- else if eq .CommonLabels.severity "info" -}}
        :information_source:
        {{- else -}}
        :question:
        {{- end }}
    {{- end }}


    {{/* First line of Slack alerts */}}
    {{ define "slack.monzo.title" -}}
        [{{ .Status | toUpper -}}
        {{ if eq .Status "firing" }}:{{ .Alerts.Firing | len }}{{- end -}}
        ] {{ template "__alert_severity_prefix_title" . }} {{ .CommonLabels.alertname }}
    {{- end }}


    {{/* Color of Slack attachment (appears as line next to alert )*/}}
    {{ define "slack.monzo.color" -}}
        {{ if eq .Status "firing" -}}
            {{ if eq .CommonLabels.severity "warning" -}}
                warning
            {{- else if eq .CommonLabels.severity "critical" -}}
                danger
            {{- else -}}
                #439FE0
            {{- end -}}
        {{ else -}}
        good
        {{- end }}
    {{- end }}

    {{/* Emoji to display as user icon (custom emoji supported!) */}}
    {{ define "slack.monzo.icon_emoji" }}:waitwhat:{{ end }}

    {{/* The test to display in the alert */}}
    {{ define "slack.monzo.text" -}}
        {{ range .Alerts }}
            {{- if .Annotations.message }}
     • {{ .Annotations.message }}
            {{- end }}
            {{- if .Annotations.description }}
     • {{ .Annotations.description }}
            {{- end }}
        {{- end }}
    {{- end }}

    {{ define "slack.monzo.link_button_text" -}}
        {{- if .CommonAnnotations.link_text -}}
            {{- .CommonAnnotations.link_text -}}
        {{- else -}}
            Link
        {{- end }} :link:
    {{- end }}
---
# Source: victoria-metrics-k8s-stack/charts/grafana/templates/clusterrole.yaml
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  labels:
    helm.sh/chart: grafana-7.3.12
    app.kubernetes.io/name: grafana
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "10.4.3"
    app.kubernetes.io/managed-by: Helm
  name: my-release-grafana-clusterrole
rules:
  - apiGroups: [""] # "" indicates the core API group
    resources: ["configmaps", "secrets"]
    verbs: ["get", "watch", "list"]
---
# Source: victoria-metrics-k8s-stack/charts/kube-state-metrics/templates/role.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:    
    helm.sh/chart: kube-state-metrics-5.16.4
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: metrics
    app.kubernetes.io/part-of: kube-state-metrics
    app.kubernetes.io/name: kube-state-metrics
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "2.10.1"
  name: my-release-kube-state-metrics
rules:

- apiGroups: ["certificates.k8s.io"]
  resources:
  - certificatesigningrequests
  verbs: ["list", "watch"]

- apiGroups: [""]
  resources:
  - configmaps
  verbs: ["list", "watch"]

- apiGroups: ["batch"]
  resources:
  - cronjobs
  verbs: ["list", "watch"]

- apiGroups: ["extensions", "apps"]
  resources:
  - daemonsets
  verbs: ["list", "watch"]

- apiGroups: ["extensions", "apps"]
  resources:
  - deployments
  verbs: ["list", "watch"]

- apiGroups: [""]
  resources:
  - endpoints
  verbs: ["list", "watch"]

- apiGroups: ["autoscaling"]
  resources:
  - horizontalpodautoscalers
  verbs: ["list", "watch"]

- apiGroups: ["extensions", "networking.k8s.io"]
  resources:
  - ingresses
  verbs: ["list", "watch"]

- apiGroups: ["batch"]
  resources:
  - jobs
  verbs: ["list", "watch"]

- apiGroups: ["coordination.k8s.io"]
  resources:
  - leases
  verbs: ["list", "watch"]

- apiGroups: [""]
  resources:
  - limitranges
  verbs: ["list", "watch"]

- apiGroups: ["admissionregistration.k8s.io"]
  resources:
    - mutatingwebhookconfigurations
  verbs: ["list", "watch"]

- apiGroups: [""]
  resources:
  - namespaces
  verbs: ["list", "watch"]

- apiGroups: ["networking.k8s.io"]
  resources:
  - networkpolicies
  verbs: ["list", "watch"]

- apiGroups: [""]
  resources:
  - nodes
  verbs: ["list", "watch"]

- apiGroups: [""]
  resources:
  - persistentvolumeclaims
  verbs: ["list", "watch"]

- apiGroups: [""]
  resources:
  - persistentvolumes
  verbs: ["list", "watch"]

- apiGroups: ["policy"]
  resources:
    - poddisruptionbudgets
  verbs: ["list", "watch"]

- apiGroups: [""]
  resources:
  - pods
  verbs: ["list", "watch"]

- apiGroups: ["extensions", "apps"]
  resources:
  - replicasets
  verbs: ["list", "watch"]

- apiGroups: [""]
  resources:
  - replicationcontrollers
  verbs: ["list", "watch"]

- apiGroups: [""]
  resources:
  - resourcequotas
  verbs: ["list", "watch"]

- apiGroups: [""]
  resources:
  - secrets
  verbs: ["list", "watch"]

- apiGroups: [""]
  resources:
  - services
  verbs: ["list", "watch"]

- apiGroups: ["apps"]
  resources:
  - statefulsets
  verbs: ["list", "watch"]

- apiGroups: ["storage.k8s.io"]
  resources:
    - storageclasses
  verbs: ["list", "watch"]

- apiGroups: ["admissionregistration.k8s.io"]
  resources:
    - validatingwebhookconfigurations
  verbs: ["list", "watch"]

- apiGroups: ["storage.k8s.io"]
  resources:
    - volumeattachments
  verbs: ["list", "watch"]
---
# Source: victoria-metrics-k8s-stack/charts/victoria-metrics-operator/templates/cluster_role.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: my-release-victoria-metrics-operator
  labels:
    app.kubernetes.io/name: victoria-metrics-operator
    app.kubernetes.io/instance: my-release
    helm.sh/chart: victoria-metrics-operator-0.32.0
    app.kubernetes.io/managed-by: Helm
rules:
- apiGroups:
  - ""
  resources:
  - configmaps
  - configmaps/finalizers
  verbs:
  - '*'
- apiGroups:
  - ""
  resources:
  - endpoints
  verbs:
  - '*'
- apiGroups:
  - ""
  resources:
  - events
  verbs:
  - '*'
- apiGroups:
  - ""
  resources:
  - namespaces
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - ""
  resources:
  - persistentvolumeclaims
  - persistentvolumeclaims/finalizers
  verbs:
  - '*'
- apiGroups:
  - ""
  resources:
  - pods
  verbs:
  - '*'
- apiGroups:
  - ""
  resources:
  - secrets
  - secrets/finalizers
  verbs:
  - '*'
- apiGroups:
  - ""
  resources:
  - services
  - services/finalizers
  verbs:
  - '*'
- apiGroups:
  - ""
  resources:
    - serviceaccounts
    - serviceaccounts/finalizers
  verbs:
  - '*'
- apiGroups:
  - ""
  resources:
  - events
  verbs:
  - 'create'
- apiGroups:
    - ""
  resources:
    - nodes
    - nodes/proxy
    - services
    - endpoints
    - pods
    - endpointslices
    - configmaps
    - nodes/metrics
    - namespaces
  verbs:
    - get
    - list
    - watch
- apiGroups:
  - apps
  resources:
  - deployments
  - deployments/finalizers
  - replicasets
  - statefulsets
  - statefulsets/finalizers
  - statefulsets/status
  verbs:
  - '*'
- apiGroups:
  - monitoring.coreos.com
  resources:
  - '*'
  verbs:
  - '*'
- apiGroups:
  - operator.victoriametrics.com
  resources:
  - vmagents
  - vmagents/finalizers
  - vmalertmanagers
  - vmalertmanagers/finalizers
  - vmalertmanagerconfigs
  - vmalertmanagerconfigs/finalizers
  - vmalerts
  - vmalerts/finalizers
  - vmauths
  - vmauths/finalizers
  - vmusers
  - vmusers/finalizers
  - vmclusters
  - vmclusters/finalizers
  - vmpodscrapes
  - vmpodscrapes/finalizers
  - vmrules
  - vmrules/finalizers
  - vmservicescrapes
  - vmservicescrapes/finalizers
  - vmprobes
  - vmprobes/finalizers
  - vmsingles
  - vmsingles/finalizers
  - vmnodescrapes
  - vmnodescrapes/finalizers
  - vmstaticscrapes
  - vmstaticscrapes/finalizers
  - vmscrapeconfigs
  - vmscrapeconfigs/finalizers
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - operator.victoriametrics.com
  resources:
  - vmagents/status
  - vmalertmanagers/status
  - vmalertmanagerconfigss/status
  - vmalerts/status
  - vmclusters/status
  - vmpodscrapes/status
  - vmscrapeconfigs/status
  - vmrules/status
  - vmservicescrapes/status
  - vmprobes/status
  - vmsingles/status
  - vmscrapeconfig/status
  - vmusers/status
  - vmauths/status
  - vmstaticscrapes/status
  - vmnodescrapes/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
    - "extensions"
    - "networking.k8s.io"
  resources:
    - ingresses
  verbs:
    - get
    - list
    - watch
- nonResourceURLs:
    - "/metrics"
    - "/metrics/resources"
  verbs:
    - get
    - watch
    - list
- apiGroups:
    - "rbac.authorization.k8s.io"
  resources:
    - clusterrolebindings
    - clusterrolebindings/finalizers
    - clusterroles
    - clusterroles/finalizers
    - roles
    - rolebindings
  verbs:
    - get
    - list
    - create
    - patch
    - update
    - watch
    - delete
- apiGroups:
    - "policy"
  resources:
    - podsecuritypolicies
    - podsecuritypolicies/finalizers
  verbs:
    - get
    - list
    - create
    - patch
    - update
    - use
    - watch
    - delete
- apiGroups:
    - storage.k8s.io
  resources:
    - storageclasses
  verbs:
    - list
    - get
    - watch
- apiGroups:
    - policy
  resources:
    - poddisruptionbudgets
    - poddisruptionbudgets/finalizers
  verbs:
    - '*'
- apiGroups:
    - route.openshift.io
    - image.openshift.io
  resources:
    - routers/metrics
    - registry/metrics
  verbs:
    - get
- apiGroups:
    - autoscaling
  verbs:
    - list
    - get
    - delete
    - create
    - update
    - watch
  resources:
    - horizontalpodautoscalers
- apiGroups:
    - networking.k8s.io
    - extensions
  resources:
  - ingresses
  - ingresses/finalizers
  verbs:
  - create
  - delete
  - get
  - patch
  - update
  - watch
- apiGroups:
    - apiextensions.k8s.io
  resources:
    - customresourcedefinitions
  verbs:
    - get
    - list
- apiGroups:
    - discovery.k8s.io
  resources:
    - endpointslices
  verbs:
    - list
    - watch
    - get
---
# Source: victoria-metrics-k8s-stack/charts/grafana/templates/clusterrolebinding.yaml
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: my-release-grafana-clusterrolebinding
  labels:
    helm.sh/chart: grafana-7.3.12
    app.kubernetes.io/name: grafana
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "10.4.3"
    app.kubernetes.io/managed-by: Helm
subjects:
  - kind: ServiceAccount
    name: my-release-grafana
    namespace: default
roleRef:
  kind: ClusterRole
  name: my-release-grafana-clusterrole
  apiGroup: rbac.authorization.k8s.io
---
# Source: victoria-metrics-k8s-stack/charts/kube-state-metrics/templates/clusterrolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:    
    helm.sh/chart: kube-state-metrics-5.16.4
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: metrics
    app.kubernetes.io/part-of: kube-state-metrics
    app.kubernetes.io/name: kube-state-metrics
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "2.10.1"
  name: my-release-kube-state-metrics
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: my-release-kube-state-metrics
subjects:
- kind: ServiceAccount
  name: my-release-kube-state-metrics
  namespace: default
---
# Source: victoria-metrics-k8s-stack/charts/victoria-metrics-operator/templates/clusterrole_binding.yaml
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: my-release-victoria-metrics-operator
  labels:
    app.kubernetes.io/name: victoria-metrics-operator
    app.kubernetes.io/instance: my-release
    helm.sh/chart: victoria-metrics-operator-0.32.0
    app.kubernetes.io/managed-by: Helm
subjects:
- kind: ServiceAccount
  name: my-release-victoria-metrics-operator
  namespace: default
roleRef:
  kind: ClusterRole
  name: my-release-victoria-metrics-operator
  apiGroup: rbac.authorization.k8s.io
---
# Source: victoria-metrics-k8s-stack/charts/grafana/templates/role.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: my-release-grafana
  namespace: default
  labels:
    helm.sh/chart: grafana-7.3.12
    app.kubernetes.io/name: grafana
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "10.4.3"
    app.kubernetes.io/managed-by: Helm
rules: []
---
# Source: victoria-metrics-k8s-stack/charts/victoria-metrics-operator/templates/role.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: my-release-victoria-metrics-operator
  labels:
    app.kubernetes.io/name: victoria-metrics-operator
    app.kubernetes.io/instance: my-release
    helm.sh/chart: victoria-metrics-operator-0.32.0
    app.kubernetes.io/managed-by: Helm
  namespace: default
rules:
- apiGroups:
  - ""
  resources:
  - configmaps
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - ""
  resources:
  - configmaps/status
  verbs:
  - get
  - update
  - patch
- apiGroups:
  - ""
  resources:
  - events
  verbs:
  - create
  - patch
- apiGroups:
  - coordination.k8s.io
  verbs:
  - create
  - get
  - update
  resources:
  - leases
---
# Source: victoria-metrics-k8s-stack/charts/grafana/templates/rolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: my-release-grafana
  namespace: default
  labels:
    helm.sh/chart: grafana-7.3.12
    app.kubernetes.io/name: grafana
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "10.4.3"
    app.kubernetes.io/managed-by: Helm
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: my-release-grafana
subjects:
- kind: ServiceAccount
  name: my-release-grafana
  namespace: default
---
# Source: victoria-metrics-k8s-stack/charts/victoria-metrics-operator/templates/role_binding.yaml
kind: RoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: my-release-victoria-metrics-operator
  namespace: default
  labels:
    app.kubernetes.io/name: victoria-metrics-operator
    app.kubernetes.io/instance: my-release
    helm.sh/chart: victoria-metrics-operator-0.32.0
    app.kubernetes.io/managed-by: Helm
subjects:
- kind: ServiceAccount
  name: my-release-victoria-metrics-operator
  namespace: default
roleRef:
  kind: Role
  name: my-release-victoria-metrics-operator
  apiGroup: rbac.authorization.k8s.io
---
# Source: victoria-metrics-k8s-stack/charts/grafana/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: my-release-grafana
  namespace: default
  labels:
    helm.sh/chart: grafana-7.3.12
    app.kubernetes.io/name: grafana
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "10.4.3"
    app.kubernetes.io/managed-by: Helm
spec:
  type: ClusterIP
  ports:
    - name: service
      port: 80
      protocol: TCP
      targetPort: 3000
  selector:
    app.kubernetes.io/name: grafana
    app.kubernetes.io/instance: my-release
---
# Source: victoria-metrics-k8s-stack/charts/kube-state-metrics/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: my-release-kube-state-metrics
  namespace: default
  labels:    
    helm.sh/chart: kube-state-metrics-5.16.4
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: metrics
    app.kubernetes.io/part-of: kube-state-metrics
    app.kubernetes.io/name: kube-state-metrics
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "2.10.1"
  annotations:
    prometheus.io/scrape: 'true'
spec:
  type: "ClusterIP"
  ports:
  - name: "http"
    protocol: TCP
    port: 8080
    targetPort: 8080
  
  selector:    
    app.kubernetes.io/name: kube-state-metrics
    app.kubernetes.io/instance: my-release
---
# Source: victoria-metrics-k8s-stack/charts/prometheus-node-exporter/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: my-release-prometheus-node-exporter
  namespace: default
  labels:
    helm.sh/chart: prometheus-node-exporter-4.27.0
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: metrics
    app.kubernetes.io/part-of: prometheus-node-exporter
    app.kubernetes.io/name: prometheus-node-exporter
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "1.7.0"
    jobLabel: node-exporter
  annotations:
    prometheus.io/scrape: "true"
spec:
  type: ClusterIP
  ports:
    - port: 9100
      targetPort: 9100
      protocol: TCP
      name: metrics
  selector:
    app.kubernetes.io/name: prometheus-node-exporter
    app.kubernetes.io/instance: my-release
---
# Source: victoria-metrics-k8s-stack/charts/victoria-metrics-operator/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  namespace: default
  labels:
    app.kubernetes.io/name: victoria-metrics-operator
    app.kubernetes.io/instance: my-release
    helm.sh/chart: victoria-metrics-operator-0.32.0
    app.kubernetes.io/managed-by: Helm
  name: my-release-victoria-metrics-operator
spec:
  ports:
    - name: http
      port: 8080
      targetPort: 8080
      protocol: TCP
    - name: webhook
      port: 443
      targetPort: 9443
  selector:
    app.kubernetes.io/name: victoria-metrics-operator
    app.kubernetes.io/instance: my-release
  type: "ClusterIP"
---
# Source: victoria-metrics-k8s-stack/templates/servicemonitors/coredns.yaml
apiVersion: v1
kind: Service
metadata:
  name: my-release-victoria-metrics-k8s-stack-coredns
  namespace: kube-system
  labels:
    app: my-release-victoria-metrics-k8s-stack-coredns
    jobLabel: coredns
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  clusterIP: None
  ports:
    - name: http-metrics
      port: 9153
      protocol: TCP
      targetPort: 9153
  selector:
    k8s-app: kube-dns
---
# Source: victoria-metrics-k8s-stack/templates/servicemonitors/kube-controller-manager.yaml
apiVersion: v1
kind: Service
metadata:
  name: my-release-victoria-metrics-k8s-stack-kube-controller-manager
  namespace: kube-system
  labels:
    app: my-release-victoria-metrics-k8s-stack-kube-controller-manager
    jobLabel: kube-controller-manager
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  clusterIP: None
  ports:
    - name: http-metrics
      port: 10257
      protocol: TCP
      targetPort: 10257
  selector:
    component: kube-controller-manager
  type: ClusterIP
---
# Source: victoria-metrics-k8s-stack/templates/servicemonitors/kube-etcd.yaml
apiVersion: v1
kind: Service
metadata:
  name: my-release-victoria-metrics-k8s-stack-kube-etcd
  namespace: kube-system
  labels:
    app: my-release-victoria-metrics-k8s-stack-kube-etcd
    jobLabel: kube-etcd
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  clusterIP: None
  ports:
    - name: http-metrics
      port: 2379
      protocol: TCP
      targetPort: 2379
  selector:
    component: etcd
  type: ClusterIP
---
# Source: victoria-metrics-k8s-stack/templates/servicemonitors/kube-scheduler.yaml
apiVersion: v1
kind: Service
metadata:
  name: my-release-victoria-metrics-k8s-stack-kube-scheduler
  namespace: kube-system
  labels:
    app: my-release-victoria-metrics-k8s-stack-kube-scheduler
    jobLabel: kube-scheduler
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  clusterIP: None
  ports:
    - name: http-metrics
      port: 10259
      protocol: TCP
      targetPort: 10259
  selector:
    component: kube-scheduler
  type: ClusterIP
---
# Source: victoria-metrics-k8s-stack/charts/prometheus-node-exporter/templates/daemonset.yaml
apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: my-release-prometheus-node-exporter
  namespace: default
  labels:
    helm.sh/chart: prometheus-node-exporter-4.27.0
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: metrics
    app.kubernetes.io/part-of: prometheus-node-exporter
    app.kubernetes.io/name: prometheus-node-exporter
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "1.7.0"
    jobLabel: node-exporter
spec:
  selector:
    matchLabels:
      app.kubernetes.io/name: prometheus-node-exporter
      app.kubernetes.io/instance: my-release
  revisionHistoryLimit: 10
  updateStrategy:
    rollingUpdate:
      maxUnavailable: 1
    type: RollingUpdate
  template:
    metadata:
      annotations:
        cluster-autoscaler.kubernetes.io/safe-to-evict: "true"
      labels:
        helm.sh/chart: prometheus-node-exporter-4.27.0
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/component: metrics
        app.kubernetes.io/part-of: prometheus-node-exporter
        app.kubernetes.io/name: prometheus-node-exporter
        app.kubernetes.io/instance: my-release
        app.kubernetes.io/version: "1.7.0"
        jobLabel: node-exporter
    spec:
      automountServiceAccountToken: false
      securityContext:
        fsGroup: 65534
        runAsGroup: 65534
        runAsNonRoot: true
        runAsUser: 65534
      serviceAccountName: my-release-prometheus-node-exporter
      containers:
        - name: node-exporter
          image: quay.io/prometheus/node-exporter:v1.7.0
          imagePullPolicy: IfNotPresent
          args:
            - --path.procfs=/host/proc
            - --path.sysfs=/host/sys
            - --path.rootfs=/host/root
            - --path.udev.data=/host/root/run/udev/data
            - --web.listen-address=[$(HOST_IP)]:9100
            - --collector.filesystem.ignored-mount-points=^/(dev|proc|sys|var/lib/docker/.+|var/lib/kubelet/.+)($|/)
            - --collector.filesystem.ignored-fs-types=^(autofs|binfmt_misc|bpf|cgroup2?|configfs|debugfs|devpts|devtmpfs|fusectl|hugetlbfs|iso9660|mqueue|nsfs|overlay|proc|procfs|pstore|rpc_pipefs|securityfs|selinuxfs|squashfs|sysfs|tracefs)$
          securityContext:
            readOnlyRootFilesystem: true
          env:
            - name: HOST_IP
              value: 0.0.0.0
          ports:
            - name: metrics
              containerPort: 9100
              protocol: TCP
          livenessProbe:
            failureThreshold: 3
            httpGet:
              httpHeaders:
              path: /
              port: 9100
              scheme: HTTP
            initialDelaySeconds: 0
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 1
          readinessProbe:
            failureThreshold: 3
            httpGet:
              httpHeaders:
              path: /
              port: 9100
              scheme: HTTP
            initialDelaySeconds: 0
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 1
          volumeMounts:
            - name: proc
              mountPath: /host/proc
              readOnly:  true
            - name: sys
              mountPath: /host/sys
              readOnly: true
            - name: root
              mountPath: /host/root
              mountPropagation: HostToContainer
              readOnly: true
      hostNetwork: true
      hostPID: true
      nodeSelector:
        kubernetes.io/os: linux
      tolerations:
        - effect: NoSchedule
          operator: Exists
      volumes:
        - name: proc
          hostPath:
            path: /proc
        - name: sys
          hostPath:
            path: /sys
        - name: root
          hostPath:
            path: /
---
# Source: victoria-metrics-k8s-stack/charts/grafana/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-release-grafana
  namespace: default
  labels:
    helm.sh/chart: grafana-7.3.12
    app.kubernetes.io/name: grafana
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "10.4.3"
    app.kubernetes.io/managed-by: Helm
spec:
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app.kubernetes.io/name: grafana
      app.kubernetes.io/instance: my-release
  strategy:
    type: RollingUpdate
  template:
    metadata:
      labels:
        app.kubernetes.io/name: grafana
        app.kubernetes.io/instance: my-release
      annotations:
        checksum/config: c96eb011d26a4734c2d6ba100d3fb3d4593ec6cf6ba35b9883ce3b3f938c433d
        checksum/dashboards-json-config: 4fc70ccafd085a7660ccfe7c9583cb3874eaa489eb90d2b7dcab36503d4248b2
        checksum/sc-dashboard-provider-config: 593c0a8778b83f11fe80ccb21dfb20bc46705e2be3178df1dc4c89d164c8cd9c
        checksum/secret: 866c81c1dd0b6d3c666c906463cb272e7a1f8cb35f857fdd10f451f3099fb970
        kubectl.kubernetes.io/default-container: grafana
    spec:
      
      serviceAccountName: my-release-grafana
      automountServiceAccountToken: true
      securityContext:
        fsGroup: 472
        runAsGroup: 472
        runAsNonRoot: true
        runAsUser: 472
      initContainers:
        - name: download-dashboards
          image: "docker.io/curlimages/curl:7.85.0"
          imagePullPolicy: IfNotPresent
          command: ["/bin/sh"]
          args: [ "-c", "mkdir -p /var/lib/grafana/dashboards/default && /bin/sh -x /etc/grafana/download_dashboards.sh" ]
          env:
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            seccompProfile:
              type: RuntimeDefault
          volumeMounts:
            - name: config
              mountPath: "/etc/grafana/download_dashboards.sh"
              subPath: download_dashboards.sh
            - name: storage
              mountPath: "/var/lib/grafana"
        - name: grafana-init-sc-datasources
          image: "quay.io/kiwigrid/k8s-sidecar:1.26.1"
          imagePullPolicy: IfNotPresent
          env:
            - name: METHOD
              value: "LIST"
            - name: LABEL
              value: "grafana_datasource"
            - name: FOLDER
              value: "/etc/grafana/provisioning/datasources"
            - name: RESOURCE
              value: "both"
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            seccompProfile:
              type: RuntimeDefault
          volumeMounts:
            - name: sc-datasources-volume
              mountPath: "/etc/grafana/provisioning/datasources"
      enableServiceLinks: true
      containers:
        - name: grafana-sc-dashboard
          image: "quay.io/kiwigrid/k8s-sidecar:1.26.1"
          imagePullPolicy: IfNotPresent
          env:
            - name: METHOD
              value: WATCH
            - name: LABEL
              value: "grafana_dashboard"
            - name: FOLDER
              value: "/tmp/dashboards"
            - name: RESOURCE
              value: "both"
            - name: REQ_USERNAME
              valueFrom:
                secretKeyRef:
                  name: my-release-grafana
                  key: admin-user
            - name: REQ_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: my-release-grafana
                  key: admin-password
            - name: REQ_URL
              value: http://localhost:3000/api/admin/provisioning/dashboards/reload
            - name: REQ_METHOD
              value: POST
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            seccompProfile:
              type: RuntimeDefault
          volumeMounts:
            - name: sc-dashboard-volume
              mountPath: "/tmp/dashboards"
        - name: grafana
          image: "docker.io/grafana/grafana:10.4.3"
          imagePullPolicy: IfNotPresent
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            seccompProfile:
              type: RuntimeDefault
          volumeMounts:
            - name: config
              mountPath: "/etc/grafana/grafana.ini"
              subPath: grafana.ini
            - name: storage
              mountPath: "/var/lib/grafana"
            - name: config
              mountPath: "/etc/grafana/provisioning/dashboards/dashboardproviders.yaml"
              subPath: "dashboardproviders.yaml"
            - name: sc-dashboard-volume
              mountPath: "/tmp/dashboards"
            - name: sc-dashboard-provider
              mountPath: "/etc/grafana/provisioning/dashboards/sc-dashboardproviders.yaml"
              subPath: provider.yaml
            - name: sc-datasources-volume
              mountPath: "/etc/grafana/provisioning/datasources"
          ports:
            - name: grafana
              containerPort: 3000
              protocol: TCP
            - name: gossip-tcp
              containerPort: 9094
              protocol: TCP
            - name: gossip-udp
              containerPort: 9094
              protocol: UDP
          env:
            - name: POD_IP
              valueFrom:
                fieldRef:
                  fieldPath: status.podIP
            - name: GF_SECURITY_ADMIN_USER
              valueFrom:
                secretKeyRef:
                  name: my-release-grafana
                  key: admin-user
            - name: GF_SECURITY_ADMIN_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: my-release-grafana
                  key: admin-password
            - name: GF_PATHS_DATA
              value: /var/lib/grafana/
            - name: GF_PATHS_LOGS
              value: /var/log/grafana
            - name: GF_PATHS_PLUGINS
              value: /var/lib/grafana/plugins
            - name: GF_PATHS_PROVISIONING
              value: /etc/grafana/provisioning
          livenessProbe:
            failureThreshold: 10
            httpGet:
              path: /api/health
              port: 3000
            initialDelaySeconds: 60
            timeoutSeconds: 30
          readinessProbe:
            httpGet:
              path: /api/health
              port: 3000
      volumes:
        - name: config
          configMap:
            name: my-release-grafana
        - name: dashboards-default
          configMap:
            name: my-release-grafana-dashboards-default
        - name: storage
          emptyDir: {}
        - name: sc-dashboard-volume
          emptyDir:
            {}
        - name: sc-dashboard-provider
          configMap:
            name: my-release-grafana-config-dashboards
        - name: sc-datasources-volume
          emptyDir:
            {}
---
# Source: victoria-metrics-k8s-stack/charts/kube-state-metrics/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-release-kube-state-metrics
  namespace: default
  labels:    
    helm.sh/chart: kube-state-metrics-5.16.4
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: metrics
    app.kubernetes.io/part-of: kube-state-metrics
    app.kubernetes.io/name: kube-state-metrics
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "2.10.1"
spec:
  selector:
    matchLabels:      
      app.kubernetes.io/name: kube-state-metrics
      app.kubernetes.io/instance: my-release
  replicas: 1
  strategy:
    type: RollingUpdate
  revisionHistoryLimit: 10
  template:
    metadata:
      labels:        
        helm.sh/chart: kube-state-metrics-5.16.4
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/component: metrics
        app.kubernetes.io/part-of: kube-state-metrics
        app.kubernetes.io/name: kube-state-metrics
        app.kubernetes.io/instance: my-release
        app.kubernetes.io/version: "2.10.1"
    spec:
      hostNetwork: false
      serviceAccountName: my-release-kube-state-metrics
      securityContext:
        fsGroup: 65534
        runAsGroup: 65534
        runAsNonRoot: true
        runAsUser: 65534
        seccompProfile:
          type: RuntimeDefault
      containers:
      - name: kube-state-metrics
        args:
        - --port=8080
        - --resources=certificatesigningrequests,configmaps,cronjobs,daemonsets,deployments,endpoints,horizontalpodautoscalers,ingresses,jobs,leases,limitranges,mutatingwebhookconfigurations,namespaces,networkpolicies,nodes,persistentvolumeclaims,persistentvolumes,poddisruptionbudgets,pods,replicasets,replicationcontrollers,resourcequotas,secrets,services,statefulsets,storageclasses,validatingwebhookconfigurations,volumeattachments
        imagePullPolicy: IfNotPresent
        image: registry.k8s.io/kube-state-metrics/kube-state-metrics:v2.10.1
        ports:
        - containerPort: 8080
          name: "http"
        livenessProbe:
          failureThreshold: 3
          httpGet:
            httpHeaders:
            path: /healthz
            port: 8080
            scheme: HTTP
          initialDelaySeconds: 5
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 5
        readinessProbe:
          failureThreshold: 3
          httpGet:
            httpHeaders:
            path: /
            port: 8080
            scheme: HTTP
          initialDelaySeconds: 5
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 5
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
          readOnlyRootFilesystem: true
---
# Source: victoria-metrics-k8s-stack/charts/victoria-metrics-operator/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-release-victoria-metrics-operator
  namespace: default
  labels:
    app.kubernetes.io/name: victoria-metrics-operator
    app.kubernetes.io/instance: my-release
    helm.sh/chart: victoria-metrics-operator-0.32.0
    app.kubernetes.io/managed-by: Helm
  annotations:
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: victoria-metrics-operator
      app.kubernetes.io/instance: my-release
  template:
    metadata:
      labels:
        app.kubernetes.io/name: victoria-metrics-operator
        app.kubernetes.io/instance: my-release
    spec:
      serviceAccountName: my-release-victoria-metrics-operator
      containers:
        - name: victoria-metrics-operator
          image: "victoriametrics/operator:v0.45.0"
          imagePullPolicy: IfNotPresent
          env:
            - name: WATCH_NAMESPACE
              value: ""
            - name: POD_NAME
              valueFrom:
                fieldRef:
                  fieldPath: metadata.name
            - name: OPERATOR_NAME
              value: victoria-metrics-operator
            - name: VM_ENABLEDPROMETHEUSCONVERTER_PODMONITOR
              value: "false"
            - name: VM_ENABLEDPROMETHEUSCONVERTER_SERVICESCRAPE
              value: "false"
            - name: VM_ENABLEDPROMETHEUSCONVERTER_PROMETHEUSRULE
              value: "false"
            - name: VM_ENABLEDPROMETHEUSCONVERTER_PROBE
              value: "false"
            - name: VM_ENABLEDPROMETHEUSCONVERTER_ALERTMANAGERCONFIG
              value: "false"
            - name: VM_PSPAUTOCREATEENABLED
              value: "false"
            - name: VM_ENABLEDPROMETHEUSCONVERTEROWNERREFERENCES
              value: "false"
          args:
            - --zap-log-level=info
            - --enable-leader-election
          command:
            - manager
          ports:
            - containerPort: 8080
              name: http
              protocol: TCP
            - containerPort: 9443
              name: webhook
              protocol: TCP
          volumeMounts:
          resources:
            {}
      volumes:
---
# Source: victoria-metrics-k8s-stack/templates/victoria-metrics-operator/vmagent/vmagent.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMAgent
metadata:
  name: my-release-victoria-metrics-k8s-stack
  namespace: default
  labels: 
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  externalLabels: {}
  extraArgs:
    promscrape.dropOriginalLabels: "true"
    promscrape.streamParse: "true"
  image:
    tag: v1.101.0
  remoteWrite:
  - url: http://vmsingle-my-release-victoria-metrics-k8s-stack.default.svc:8429/api/v1/write
  scrapeInterval: 20s
  selectAllByDefault: true
---
# Source: victoria-metrics-k8s-stack/templates/victoria-metrics-operator/vmalert/vmalert.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMAlert
metadata:
  name: my-release-victoria-metrics-k8s-stack
  namespace: default
  labels: 
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  datasource:
    url: http://vmsingle-my-release-victoria-metrics-k8s-stack.default.svc:8429/
  evaluationInterval: 15s
  externalLabels: {}
  extraArgs:
    remoteWrite.disablePathAppend: "true"
  image:
    tag: v1.101.0
  notifiers:
  - url: http://vmalertmanager-my-release-victoria-metrics-k8s-stack-0.vmalertmanager-my-release-victoria-metrics-k8s-stack.default.svc:9093
  remoteRead:
    url: http://vmsingle-my-release-victoria-metrics-k8s-stack.default.svc:8429/
  remoteWrite:
    url: http://vmsingle-my-release-victoria-metrics-k8s-stack.default.svc:8429/api/v1/write
  selectAllByDefault: true
---
# Source: victoria-metrics-k8s-stack/templates/victoria-metrics-operator/alertmanager/vmalertmanager.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMAlertmanager
metadata:
  name: my-release-victoria-metrics-k8s-stack
  namespace: default
  labels: 
    app.kubernetes.io/component: victoria-metrics-k8s-stack-alertmanager
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  externalURL: ""
  image:
    tag: v0.25.0
  routePrefix: /
  selectAllByDefault: true
  configSecret: my-release-victoria-metrics-k8s-stack-alertmanager
  templates:
  - name: my-release-victoria-metrics-k8s-stack-alertmanager-monzo-tpl
    key: monzo.tmpl
---
# Source: victoria-metrics-k8s-stack/templates/servicemonitors/cadvisor.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMNodeScrape
metadata:
  name: my-release-victoria-metrics-k8s-stack-cadvisor
  namespace: default
  labels: 
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec: 
  bearerTokenFile: /var/run/secrets/kubernetes.io/serviceaccount/token
  honorLabels: true
  honorTimestamps: false
  interval: 30s
  metricRelabelConfigs:
  - action: labeldrop
    regex: (uid)
  - action: labeldrop
    regex: (id|name)
  - action: drop
    regex: (rest_client_request_duration_seconds_bucket|rest_client_request_duration_seconds_sum|rest_client_request_duration_seconds_count)
    source_labels:
    - __name__
  path: /metrics/cadvisor
  relabelConfigs:
  - action: labelmap
    regex: __meta_kubernetes_node_label_(.+)
  - sourceLabels:
    - __metrics_path__
    targetLabel: metrics_path
  - replacement: kubelet
    targetLabel: job
  scheme: https
  scrapeTimeout: 5s
  tlsConfig:
    caFile: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
    insecureSkipVerify: true
---
# Source: victoria-metrics-k8s-stack/templates/servicemonitors/kubelet-probes.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMNodeScrape
metadata:
  name: my-release-victoria-metrics-k8s-stack-probes
  namespace: default
  labels: 
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec: 
  bearerTokenFile: /var/run/secrets/kubernetes.io/serviceaccount/token
  honorLabels: true
  honorTimestamps: false
  interval: 30s
  metricRelabelConfigs:
  - action: labeldrop
    regex: (uid)
  - action: labeldrop
    regex: (id|name)
  - action: drop
    regex: (rest_client_request_duration_seconds_bucket|rest_client_request_duration_seconds_sum|rest_client_request_duration_seconds_count)
    source_labels:
    - __name__
  path: /metrics/probes
  relabelConfigs:
  - action: labelmap
    regex: __meta_kubernetes_node_label_(.+)
  - sourceLabels:
    - __metrics_path__
    targetLabel: metrics_path
  - replacement: kubelet
    targetLabel: job
  scheme: https
  scrapeTimeout: 5s
  tlsConfig:
    caFile: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
    insecureSkipVerify: true
---
# Source: victoria-metrics-k8s-stack/templates/servicemonitors/kubelet.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMNodeScrape
metadata:
  name: my-release-victoria-metrics-k8s-stack-kubelet
  namespace: default
  labels: 
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec: 
  bearerTokenFile: /var/run/secrets/kubernetes.io/serviceaccount/token
  honorLabels: true
  honorTimestamps: false
  interval: 30s
  metricRelabelConfigs:
  - action: labeldrop
    regex: (uid)
  - action: labeldrop
    regex: (id|name)
  - action: drop
    regex: (rest_client_request_duration_seconds_bucket|rest_client_request_duration_seconds_sum|rest_client_request_duration_seconds_count)
    source_labels:
    - __name__
  relabelConfigs:
  - action: labelmap
    regex: __meta_kubernetes_node_label_(.+)
  - sourceLabels:
    - __metrics_path__
    targetLabel: metrics_path
  - replacement: kubelet
    targetLabel: job
  scheme: https
  scrapeTimeout: 5s
  tlsConfig:
    caFile: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
    insecureSkipVerify: true
---
# Source: victoria-metrics-k8s-stack/templates/rules/alertmanager.rules.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-alertmanager.rules
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: alertmanager.rules
    rules:
    - alert: AlertmanagerFailedReload
      annotations:
        description: Configuration has failed to load for {{ $labels.namespace }}/{{ $labels.pod}}.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/alertmanager/alertmanagerfailedreload
        summary: Reloading an Alertmanager configuration has failed.
      expr: |-
        # Without max_over_time, failed scrapes could create false negatives, see
        # https://www.robustperception.io/alerting-on-gauges-in-prometheus-2-0 for details.
        max_over_time(alertmanager_config_last_reload_successful{job="vmalertmanager-my-release-victoria-metrics-k8s-stack",namespace="default"}[5m]) == 0
      for: 10m
      labels:
        severity: critical
    - alert: AlertmanagerMembersInconsistent
      annotations:
        description: Alertmanager {{ $labels.namespace }}/{{ $labels.pod}} has only found {{ $value }} members of the {{$labels.job}} cluster.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/alertmanager/alertmanagermembersinconsistent
        summary: A member of an Alertmanager cluster has not found all other cluster members.
      expr: |-
        # Without max_over_time, failed scrapes could create false negatives, see
        # https://www.robustperception.io/alerting-on-gauges-in-prometheus-2-0 for details.
          max_over_time(alertmanager_cluster_members{job="vmalertmanager-my-release-victoria-metrics-k8s-stack",namespace="default"}[5m])
        < on (namespace,service) group_left
          count by (namespace,service) (max_over_time(alertmanager_cluster_members{job="vmalertmanager-my-release-victoria-metrics-k8s-stack",namespace="default"}[5m]))
      for: 15m
      labels:
        severity: critical
    - alert: AlertmanagerFailedToSendAlerts
      annotations:
        description: Alertmanager {{ $labels.namespace }}/{{ $labels.pod}} failed to send {{ $value | humanizePercentage }} of notifications to {{ $labels.integration }}.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/alertmanager/alertmanagerfailedtosendalerts
        summary: An Alertmanager instance failed to send notifications.
      expr: |-
        (
          rate(alertmanager_notifications_failed_total{job="vmalertmanager-my-release-victoria-metrics-k8s-stack",namespace="default"}[5m])
        /
          ignoring (reason) group_left rate(alertmanager_notifications_total{job="vmalertmanager-my-release-victoria-metrics-k8s-stack",namespace="default"}[5m])
        )
        > 0.01
      for: 5m
      labels:
        severity: warning
    - alert: AlertmanagerClusterFailedToSendAlerts
      annotations:
        description: The minimum notification failure rate to {{ $labels.integration }} sent from any instance in the {{$labels.job}} cluster is {{ $value | humanizePercentage }}.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/alertmanager/alertmanagerclusterfailedtosendalerts
        summary: All Alertmanager instances in a cluster failed to send notifications to a critical integration.
      expr: |-
        min by (namespace,service, integration) (
          rate(alertmanager_notifications_failed_total{job="vmalertmanager-my-release-victoria-metrics-k8s-stack",namespace="default", integration=~`.*`}[5m])
        /
          ignoring (reason) group_left rate(alertmanager_notifications_total{job="vmalertmanager-my-release-victoria-metrics-k8s-stack",namespace="default", integration=~`.*`}[5m])
        )
        > 0.01
      for: 5m
      labels:
        severity: critical
    - alert: AlertmanagerClusterFailedToSendAlerts
      annotations:
        description: The minimum notification failure rate to {{ $labels.integration }} sent from any instance in the {{$labels.job}} cluster is {{ $value | humanizePercentage }}.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/alertmanager/alertmanagerclusterfailedtosendalerts
        summary: All Alertmanager instances in a cluster failed to send notifications to a non-critical integration.
      expr: |-
        min by (namespace,service, integration) (
          rate(alertmanager_notifications_failed_total{job="vmalertmanager-my-release-victoria-metrics-k8s-stack",namespace="default", integration!~`.*`}[5m])
        /
          ignoring (reason) group_left rate(alertmanager_notifications_total{job="vmalertmanager-my-release-victoria-metrics-k8s-stack",namespace="default", integration!~`.*`}[5m])
        )
        > 0.01
      for: 5m
      labels:
        severity: warning
    - alert: AlertmanagerConfigInconsistent
      annotations:
        description: Alertmanager instances within the {{$labels.job}} cluster have different configurations.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/alertmanager/alertmanagerconfiginconsistent
        summary: Alertmanager instances within the same cluster have different configurations.
      expr: |-
        count by (namespace,service) (
          count_values by (namespace,service) ("config_hash", alertmanager_config_hash{job="vmalertmanager-my-release-victoria-metrics-k8s-stack",namespace="default"})
        )
        != 1
      for: 20m
      labels:
        severity: critical
    - alert: AlertmanagerClusterDown
      annotations:
        description: '{{ $value | humanizePercentage }} of Alertmanager instances within the {{$labels.job}} cluster have been up for less than half of the last 5m.'
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/alertmanager/alertmanagerclusterdown
        summary: Half or more of the Alertmanager instances within the same cluster are down.
      expr: |-
        (
          count by (namespace,service) (
            avg_over_time(up{job="vmalertmanager-my-release-victoria-metrics-k8s-stack",namespace="default"}[5m]) < 0.5
          )
        /
          count by (namespace,service) (
            up{job="vmalertmanager-my-release-victoria-metrics-k8s-stack",namespace="default"}
          )
        )
        >= 0.5
      for: 5m
      labels:
        severity: critical
    - alert: AlertmanagerClusterCrashlooping
      annotations:
        description: '{{ $value | humanizePercentage }} of Alertmanager instances within the {{$labels.job}} cluster have restarted at least 5 times in the last 10m.'
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/alertmanager/alertmanagerclustercrashlooping
        summary: Half or more of the Alertmanager instances within the same cluster are crashlooping.
      expr: |-
        (
          count by (namespace,service) (
            changes(process_start_time_seconds{job="vmalertmanager-my-release-victoria-metrics-k8s-stack",namespace="default"}[10m]) > 4
          )
        /
          count by (namespace,service) (
            up{job="vmalertmanager-my-release-victoria-metrics-k8s-stack",namespace="default"}
          )
        )
        >= 0.5
      for: 5m
      labels:
        severity: critical
---
# Source: victoria-metrics-k8s-stack/templates/rules/etcd.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-etcd
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: etcd
    rules:
    - alert: etcdMembersDown
      annotations:
        description: 'etcd cluster "{{ $labels.job }}": members are down ({{ $value }}).'
        summary: etcd cluster members are down.
      expr: |-
        max without (endpoint) (
          sum without (instance) (up{job=~".*etcd.*"} == bool 0)
        or
          count without (To) (
            sum without (instance) (rate(etcd_network_peer_sent_failures_total{job=~".*etcd.*"}[120s])) > 0.01
          )
        )
        > 0
      for: 10m
      labels:
        severity: critical
    - alert: etcdInsufficientMembers
      annotations:
        description: 'etcd cluster "{{ $labels.job }}": insufficient members ({{ $value }}).'
        summary: etcd cluster has insufficient number of members.
      expr: sum(up{job=~".*etcd.*"} == bool 1) without (instance) < ((count(up{job=~".*etcd.*"}) without (instance) + 1) / 2)
      for: 3m
      labels:
        severity: critical
    - alert: etcdNoLeader
      annotations:
        description: 'etcd cluster "{{ $labels.job }}": member {{ $labels.instance }} has no leader.'
        summary: etcd cluster has no leader.
      expr: etcd_server_has_leader{job=~".*etcd.*"} == 0
      for: 1m
      labels:
        severity: critical
    - alert: etcdHighNumberOfLeaderChanges
      annotations:
        description: 'etcd cluster "{{ $labels.job }}": {{ $value }} leader changes within the last 15 minutes. Frequent elections may be a sign of insufficient resources, high network latency, or disruptions by other components and should be investigated.'
        summary: etcd cluster has high number of leader changes.
      expr: increase((max without (instance) (etcd_server_leader_changes_seen_total{job=~".*etcd.*"}) or 0*absent(etcd_server_leader_changes_seen_total{job=~".*etcd.*"}))[15m:1m]) >= 4
      for: 5m
      labels:
        severity: warning
    - alert: etcdHighNumberOfFailedGRPCRequests
      annotations:
        description: 'etcd cluster "{{ $labels.job }}": {{ $value }}% of requests for {{ $labels.grpc_method }} failed on etcd instance {{ $labels.instance }}.'
        summary: etcd cluster has high number of failed grpc requests.
      expr: |-
        100 * sum(rate(grpc_server_handled_total{job=~".*etcd.*", grpc_code=~"Unknown|FailedPrecondition|ResourceExhausted|Internal|Unavailable|DataLoss|DeadlineExceeded"}[5m])) without (grpc_type, grpc_code)
          /
        sum(rate(grpc_server_handled_total{job=~".*etcd.*"}[5m])) without (grpc_type, grpc_code)
          > 1
      for: 10m
      labels:
        severity: warning
    - alert: etcdHighNumberOfFailedGRPCRequests
      annotations:
        description: 'etcd cluster "{{ $labels.job }}": {{ $value }}% of requests for {{ $labels.grpc_method }} failed on etcd instance {{ $labels.instance }}.'
        summary: etcd cluster has high number of failed grpc requests.
      expr: |-
        100 * sum(rate(grpc_server_handled_total{job=~".*etcd.*", grpc_code=~"Unknown|FailedPrecondition|ResourceExhausted|Internal|Unavailable|DataLoss|DeadlineExceeded"}[5m])) without (grpc_type, grpc_code)
          /
        sum(rate(grpc_server_handled_total{job=~".*etcd.*"}[5m])) without (grpc_type, grpc_code)
          > 5
      for: 5m
      labels:
        severity: critical
    - alert: etcdGRPCRequestsSlow
      annotations:
        description: 'etcd cluster "{{ $labels.job }}": 99th percentile of gRPC requests is {{ $value }}s on etcd instance {{ $labels.instance }} for {{ $labels.grpc_method }} method.'
        summary: etcd grpc requests are slow
      expr: |-
        histogram_quantile(0.99, sum(rate(grpc_server_handling_seconds_bucket{job=~".*etcd.*", grpc_method!="Defragment", grpc_type="unary"}[5m])) without(grpc_type))
        > 0.15
      for: 10m
      labels:
        severity: critical
    - alert: etcdMemberCommunicationSlow
      annotations:
        description: 'etcd cluster "{{ $labels.job }}": member communication with {{ $labels.To }} is taking {{ $value }}s on etcd instance {{ $labels.instance }}.'
        summary: etcd cluster member communication is slow.
      expr: |-
        histogram_quantile(0.99, rate(etcd_network_peer_round_trip_time_seconds_bucket{job=~".*etcd.*"}[5m]))
        > 0.15
      for: 10m
      labels:
        severity: warning
    - alert: etcdHighNumberOfFailedProposals
      annotations:
        description: 'etcd cluster "{{ $labels.job }}": {{ $value }} proposal failures within the last 30 minutes on etcd instance {{ $labels.instance }}.'
        summary: etcd cluster has high number of proposal failures.
      expr: rate(etcd_server_proposals_failed_total{job=~".*etcd.*"}[15m]) > 5
      for: 15m
      labels:
        severity: warning
    - alert: etcdHighFsyncDurations
      annotations:
        description: 'etcd cluster "{{ $labels.job }}": 99th percentile fsync durations are {{ $value }}s on etcd instance {{ $labels.instance }}.'
        summary: etcd cluster 99th percentile fsync durations are too high.
      expr: |-
        histogram_quantile(0.99, rate(etcd_disk_wal_fsync_duration_seconds_bucket{job=~".*etcd.*"}[5m]))
        > 0.5
      for: 10m
      labels:
        severity: warning
    - alert: etcdHighFsyncDurations
      annotations:
        description: 'etcd cluster "{{ $labels.job }}": 99th percentile fsync durations are {{ $value }}s on etcd instance {{ $labels.instance }}.'
        summary: etcd cluster 99th percentile fsync durations are too high.
      expr: |-
        histogram_quantile(0.99, rate(etcd_disk_wal_fsync_duration_seconds_bucket{job=~".*etcd.*"}[5m]))
        > 1
      for: 10m
      labels:
        severity: critical
    - alert: etcdHighCommitDurations
      annotations:
        description: 'etcd cluster "{{ $labels.job }}": 99th percentile commit durations {{ $value }}s on etcd instance {{ $labels.instance }}.'
        summary: etcd cluster 99th percentile commit durations are too high.
      expr: |-
        histogram_quantile(0.99, rate(etcd_disk_backend_commit_duration_seconds_bucket{job=~".*etcd.*"}[5m]))
        > 0.25
      for: 10m
      labels:
        severity: warning
    - alert: etcdBackendQuotaLowSpace
      annotations:
        description: 'etcd cluster "{{ $labels.job }}": database size exceeds the defined quota on etcd instance {{ $labels.instance }}, please defrag or increase the quota as the writes to etcd will be disabled when it is full.'
        summary: etcd cluster database is running full.
      expr: (etcd_mvcc_db_total_size_in_bytes/etcd_server_quota_backend_bytes)*100 > 95
      for: 10m
      labels:
        severity: critical
    - alert: etcdExcessiveDatabaseGrowth
      annotations:
        description: 'etcd cluster "{{ $labels.job }}": Predicting running out of disk space in the next four hours, based on write observations within the past four hours on etcd instance {{ $labels.instance }}, please check as it might be disruptive.'
        summary: etcd cluster database growing very fast.
      expr: predict_linear(etcd_mvcc_db_total_size_in_bytes[4h], 4*60*60) > etcd_server_quota_backend_bytes
      for: 10m
      labels:
        severity: warning
---
# Source: victoria-metrics-k8s-stack/templates/rules/general.rules.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-general.rules
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: general.rules
    rules:
    - alert: TargetDown
      annotations:
        description: '{{ printf "%.4g" $value }}% of the {{ $labels.job }}/{{ $labels.service }} targets in {{ $labels.namespace }} namespace are down.'
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/general/targetdown
        summary: One or more targets are unreachable.
      expr: 100 * (count(up == 0) BY (cluster, job, namespace, service) / count(up) BY (cluster, job, namespace, service)) > 10
      for: 10m
      labels:
        severity: warning
    - alert: Watchdog
      annotations:
        description: 'This is an alert meant to ensure that the entire alerting pipeline is functional.

          This alert is always firing, therefore it should always be firing in Alertmanager

          and always fire against a receiver. There are integrations with various notification

          mechanisms that send a notification when this alert is not firing. For example the

          "DeadMansSnitch" integration in PagerDuty.

          '
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/general/watchdog
        summary: An alert that should always be firing to certify that Alertmanager is working properly.
      expr: vector(1)
      labels:
        severity: none
    - alert: InfoInhibitor
      annotations:
        description: 'This is an alert that is used to inhibit info alerts.

          By themselves, the info-level alerts are sometimes very noisy, but they are relevant when combined with

          other alerts.

          This alert fires whenever there''s a severity="info" alert, and stops firing when another alert with a

          severity of ''warning'' or ''critical'' starts firing on the same namespace.

          This alert should be routed to a null receiver and configured to inhibit alerts with severity="info".

          '
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/general/infoinhibitor
        summary: Info-level alert inhibition.
      expr: ALERTS{severity = "info"} == 1 unless on(namespace) ALERTS{alertname != "InfoInhibitor", severity =~ "warning|critical", alertstate="firing"} == 1
      labels:
        severity: none
---
# Source: victoria-metrics-k8s-stack/templates/rules/k8s.rules.container_cpu_usage_seconds_total.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-k8s.rules.containercpuusa
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: k8s.rules.container_cpu_usage_seconds_total
    rules:
    - expr: |-
        sum by (cluster, namespace, pod, container) (
          irate(container_cpu_usage_seconds_total{job="kubelet", metrics_path="/metrics/cadvisor", image!=""}[5m])
        ) * on (cluster, namespace, pod) group_left(node) topk by (cluster, namespace, pod) (
          1, max by(cluster, namespace, pod, node) (kube_pod_info{node!=""})
        )
      record: node_namespace_pod_container:container_cpu_usage_seconds_total:sum_irate
---
# Source: victoria-metrics-k8s-stack/templates/rules/k8s.rules.container_memory_cache.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-k8s.rules.containermemory
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: k8s.rules.container_memory_cache
    rules:
    - expr: |-
        container_memory_cache{job="kubelet", metrics_path="/metrics/cadvisor", image!=""}
        * on (cluster, namespace, pod) group_left(node) topk by(cluster, namespace, pod) (1,
          max by(cluster, namespace, pod, node) (kube_pod_info{node!=""})
        )
      record: node_namespace_pod_container:container_memory_cache
---
# Source: victoria-metrics-k8s-stack/templates/rules/k8s.rules.container_memory_rss.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-k8s.rules.containermemory
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: k8s.rules.container_memory_rss
    rules:
    - expr: |-
        container_memory_rss{job="kubelet", metrics_path="/metrics/cadvisor", image!=""}
        * on (cluster, namespace, pod) group_left(node) topk by(cluster, namespace, pod) (1,
          max by(cluster, namespace, pod, node) (kube_pod_info{node!=""})
        )
      record: node_namespace_pod_container:container_memory_rss
---
# Source: victoria-metrics-k8s-stack/templates/rules/k8s.rules.container_memory_swap.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-k8s.rules.containermemory
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: k8s.rules.container_memory_swap
    rules:
    - expr: |-
        container_memory_swap{job="kubelet", metrics_path="/metrics/cadvisor", image!=""}
        * on (cluster, namespace, pod) group_left(node) topk by(cluster, namespace, pod) (1,
          max by(cluster, namespace, pod, node) (kube_pod_info{node!=""})
        )
      record: node_namespace_pod_container:container_memory_swap
---
# Source: victoria-metrics-k8s-stack/templates/rules/k8s.rules.container_memory_working_set_bytes.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-k8s.rules.containermemory
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: k8s.rules.container_memory_working_set_bytes
    rules:
    - expr: |-
        container_memory_working_set_bytes{job="kubelet", metrics_path="/metrics/cadvisor", image!=""}
        * on (cluster, namespace, pod) group_left(node) topk by(cluster, namespace, pod) (1,
          max by(cluster, namespace, pod, node) (kube_pod_info{node!=""})
        )
      record: node_namespace_pod_container:container_memory_working_set_bytes
---
# Source: victoria-metrics-k8s-stack/templates/rules/k8s.rules.container_resource.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-k8s.rules.containerresour
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: k8s.rules.container_resource
    rules:
    - expr: |-
        kube_pod_container_resource_requests{resource="memory",job="kube-state-metrics"}  * on (namespace, pod, cluster)
        group_left() max by (namespace, pod, cluster) (
          (kube_pod_status_phase{phase=~"Pending|Running"} == 1)
        )
      record: cluster:namespace:pod_memory:active:kube_pod_container_resource_requests
    - expr: |-
        sum by (namespace, cluster) (
            sum by (namespace, pod, cluster) (
                max by (namespace, pod, container, cluster) (
                  kube_pod_container_resource_requests{resource="memory",job="kube-state-metrics"}
                ) * on(namespace, pod, cluster) group_left() max by (namespace, pod, cluster) (
                  kube_pod_status_phase{phase=~"Pending|Running"} == 1
                )
            )
        )
      record: namespace_memory:kube_pod_container_resource_requests:sum
    - expr: |-
        kube_pod_container_resource_requests{resource="cpu",job="kube-state-metrics"}  * on (namespace, pod, cluster)
        group_left() max by (namespace, pod, cluster) (
          (kube_pod_status_phase{phase=~"Pending|Running"} == 1)
        )
      record: cluster:namespace:pod_cpu:active:kube_pod_container_resource_requests
    - expr: |-
        sum by (namespace, cluster) (
            sum by (namespace, pod, cluster) (
                max by (namespace, pod, container, cluster) (
                  kube_pod_container_resource_requests{resource="cpu",job="kube-state-metrics"}
                ) * on(namespace, pod, cluster) group_left() max by (namespace, pod, cluster) (
                  kube_pod_status_phase{phase=~"Pending|Running"} == 1
                )
            )
        )
      record: namespace_cpu:kube_pod_container_resource_requests:sum
    - expr: |-
        kube_pod_container_resource_limits{resource="memory",job="kube-state-metrics"}  * on (namespace, pod, cluster)
        group_left() max by (namespace, pod, cluster) (
          (kube_pod_status_phase{phase=~"Pending|Running"} == 1)
        )
      record: cluster:namespace:pod_memory:active:kube_pod_container_resource_limits
    - expr: |-
        sum by (namespace, cluster) (
            sum by (namespace, pod, cluster) (
                max by (namespace, pod, container, cluster) (
                  kube_pod_container_resource_limits{resource="memory",job="kube-state-metrics"}
                ) * on(namespace, pod, cluster) group_left() max by (namespace, pod, cluster) (
                  kube_pod_status_phase{phase=~"Pending|Running"} == 1
                )
            )
        )
      record: namespace_memory:kube_pod_container_resource_limits:sum
    - expr: |-
        kube_pod_container_resource_limits{resource="cpu",job="kube-state-metrics"}  * on (namespace, pod, cluster)
        group_left() max by (namespace, pod, cluster) (
         (kube_pod_status_phase{phase=~"Pending|Running"} == 1)
         )
      record: cluster:namespace:pod_cpu:active:kube_pod_container_resource_limits
    - expr: |-
        sum by (namespace, cluster) (
            sum by (namespace, pod, cluster) (
                max by (namespace, pod, container, cluster) (
                  kube_pod_container_resource_limits{resource="cpu",job="kube-state-metrics"}
                ) * on(namespace, pod, cluster) group_left() max by (namespace, pod, cluster) (
                  kube_pod_status_phase{phase=~"Pending|Running"} == 1
                )
            )
        )
      record: namespace_cpu:kube_pod_container_resource_limits:sum
---
# Source: victoria-metrics-k8s-stack/templates/rules/k8s.rules.pod_owner.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-k8s.rules.podowner
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: k8s.rules.pod_owner
    rules:
    - expr: |-
        max by (cluster, namespace, workload, pod) (
          label_replace(
            label_replace(
              kube_pod_owner{job="kube-state-metrics", owner_kind="ReplicaSet"},
              "replicaset", "$1", "owner_name", "(.*)"
            ) * on(replicaset, namespace) group_left(owner_name) topk by(replicaset, namespace) (
              1, max by (replicaset, namespace, owner_name) (
                kube_replicaset_owner{job="kube-state-metrics"}
              )
            ),
            "workload", "$1", "owner_name", "(.*)"
          )
        )
      labels:
        workload_type: deployment
      record: namespace_workload_pod:kube_pod_owner:relabel
    - expr: |-
        max by (cluster, namespace, workload, pod) (
          label_replace(
            kube_pod_owner{job="kube-state-metrics", owner_kind="DaemonSet"},
            "workload", "$1", "owner_name", "(.*)"
          )
        )
      labels:
        workload_type: daemonset
      record: namespace_workload_pod:kube_pod_owner:relabel
    - expr: |-
        max by (cluster, namespace, workload, pod) (
          label_replace(
            kube_pod_owner{job="kube-state-metrics", owner_kind="StatefulSet"},
            "workload", "$1", "owner_name", "(.*)"
          )
        )
      labels:
        workload_type: statefulset
      record: namespace_workload_pod:kube_pod_owner:relabel
    - expr: |-
        max by (cluster, namespace, workload, pod) (
          label_replace(
            kube_pod_owner{job="kube-state-metrics", owner_kind="Job"},
            "workload", "$1", "owner_name", "(.*)"
          )
        )
      labels:
        workload_type: job
      record: namespace_workload_pod:kube_pod_owner:relabel
---
# Source: victoria-metrics-k8s-stack/templates/rules/kube-apiserver-availability.rules.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-kube-apiserver-availabili
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - interval: 3m
    name: kube-apiserver-availability.rules
    rules:
    - expr: avg_over_time(code_verb:apiserver_request_total:increase1h[30d]) * 24 * 30
      record: code_verb:apiserver_request_total:increase30d
    - expr: sum by (cluster, code) (code_verb:apiserver_request_total:increase30d{verb=~"LIST|GET"})
      labels:
        verb: read
      record: code:apiserver_request_total:increase30d
    - expr: sum by (cluster, code) (code_verb:apiserver_request_total:increase30d{verb=~"POST|PUT|PATCH|DELETE"})
      labels:
        verb: write
      record: code:apiserver_request_total:increase30d
    - expr: sum by (cluster, verb, scope) (increase(apiserver_request_sli_duration_seconds_count{job="apiserver"}[1h]))
      record: cluster_verb_scope:apiserver_request_sli_duration_seconds_count:increase1h
    - expr: sum by (cluster, verb, scope) (avg_over_time(cluster_verb_scope:apiserver_request_sli_duration_seconds_count:increase1h[30d]) * 24 * 30)
      record: cluster_verb_scope:apiserver_request_sli_duration_seconds_count:increase30d
    - expr: sum by (cluster, verb, scope, le) (increase(apiserver_request_sli_duration_seconds_bucket[1h]))
      record: cluster_verb_scope_le:apiserver_request_sli_duration_seconds_bucket:increase1h
    - expr: sum by (cluster, verb, scope, le) (avg_over_time(cluster_verb_scope_le:apiserver_request_sli_duration_seconds_bucket:increase1h[30d]) * 24 * 30)
      record: cluster_verb_scope_le:apiserver_request_sli_duration_seconds_bucket:increase30d
    - expr: |-
        1 - (
          (
            # write too slow
            sum by (cluster) (cluster_verb_scope:apiserver_request_sli_duration_seconds_count:increase30d{verb=~"POST|PUT|PATCH|DELETE"})
            -
            sum by (cluster) (cluster_verb_scope_le:apiserver_request_sli_duration_seconds_bucket:increase30d{verb=~"POST|PUT|PATCH|DELETE",le="1"})
          ) +
          (
            # read too slow
            sum by (cluster) (cluster_verb_scope:apiserver_request_sli_duration_seconds_count:increase30d{verb=~"LIST|GET"})
            -
            (
              (
                sum by (cluster) (cluster_verb_scope_le:apiserver_request_sli_duration_seconds_bucket:increase30d{verb=~"LIST|GET",scope=~"resource|",le="1"})
                or
                vector(0)
              )
              +
              sum by (cluster) (cluster_verb_scope_le:apiserver_request_sli_duration_seconds_bucket:increase30d{verb=~"LIST|GET",scope="namespace",le="5"})
              +
              sum by (cluster) (cluster_verb_scope_le:apiserver_request_sli_duration_seconds_bucket:increase30d{verb=~"LIST|GET",scope="cluster",le="30"})
            )
          ) +
          # errors
          sum by (cluster) (code:apiserver_request_total:increase30d{code=~"5.."} or vector(0))
        )
        /
        sum by (cluster) (code:apiserver_request_total:increase30d)
      labels:
        verb: all
      record: apiserver_request:availability30d
    - expr: |-
        1 - (
          sum by (cluster) (cluster_verb_scope:apiserver_request_sli_duration_seconds_count:increase30d{verb=~"LIST|GET"})
          -
          (
            # too slow
            (
              sum by (cluster) (cluster_verb_scope_le:apiserver_request_sli_duration_seconds_bucket:increase30d{verb=~"LIST|GET",scope=~"resource|",le="1"})
              or
              vector(0)
            )
            +
            sum by (cluster) (cluster_verb_scope_le:apiserver_request_sli_duration_seconds_bucket:increase30d{verb=~"LIST|GET",scope="namespace",le="5"})
            +
            sum by (cluster) (cluster_verb_scope_le:apiserver_request_sli_duration_seconds_bucket:increase30d{verb=~"LIST|GET",scope="cluster",le="30"})
          )
          +
          # errors
          sum by (cluster) (code:apiserver_request_total:increase30d{verb="read",code=~"5.."} or vector(0))
        )
        /
        sum by (cluster) (code:apiserver_request_total:increase30d{verb="read"})
      labels:
        verb: read
      record: apiserver_request:availability30d
    - expr: |-
        1 - (
          (
            # too slow
            sum by (cluster) (cluster_verb_scope:apiserver_request_sli_duration_seconds_count:increase30d{verb=~"POST|PUT|PATCH|DELETE"})
            -
            sum by (cluster) (cluster_verb_scope_le:apiserver_request_sli_duration_seconds_bucket:increase30d{verb=~"POST|PUT|PATCH|DELETE",le="1"})
          )
          +
          # errors
          sum by (cluster) (code:apiserver_request_total:increase30d{verb="write",code=~"5.."} or vector(0))
        )
        /
        sum by (cluster) (code:apiserver_request_total:increase30d{verb="write"})
      labels:
        verb: write
      record: apiserver_request:availability30d
    - expr: sum by (cluster,code,resource) (rate(apiserver_request_total{job="apiserver",verb=~"LIST|GET"}[5m]))
      labels:
        verb: read
      record: code_resource:apiserver_request_total:rate5m
    - expr: sum by (cluster,code,resource) (rate(apiserver_request_total{job="apiserver",verb=~"POST|PUT|PATCH|DELETE"}[5m]))
      labels:
        verb: write
      record: code_resource:apiserver_request_total:rate5m
    - expr: sum by (cluster, code, verb) (increase(apiserver_request_total{job="apiserver",verb=~"LIST|GET|POST|PUT|PATCH|DELETE",code=~"2.."}[1h]))
      record: code_verb:apiserver_request_total:increase1h
    - expr: sum by (cluster, code, verb) (increase(apiserver_request_total{job="apiserver",verb=~"LIST|GET|POST|PUT|PATCH|DELETE",code=~"3.."}[1h]))
      record: code_verb:apiserver_request_total:increase1h
    - expr: sum by (cluster, code, verb) (increase(apiserver_request_total{job="apiserver",verb=~"LIST|GET|POST|PUT|PATCH|DELETE",code=~"4.."}[1h]))
      record: code_verb:apiserver_request_total:increase1h
    - expr: sum by (cluster, code, verb) (increase(apiserver_request_total{job="apiserver",verb=~"LIST|GET|POST|PUT|PATCH|DELETE",code=~"5.."}[1h]))
      record: code_verb:apiserver_request_total:increase1h
---
# Source: victoria-metrics-k8s-stack/templates/rules/kube-apiserver-burnrate.rules.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-kube-apiserver-burnrate.r
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: kube-apiserver-burnrate.rules
    rules:
    - expr: |-
        (
          (
            # too slow
            sum by (cluster) (rate(apiserver_request_sli_duration_seconds_count{job="apiserver",verb=~"LIST|GET",subresource!~"proxy|attach|log|exec|portforward"}[1d]))
            -
            (
              (
                sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="apiserver",verb=~"LIST|GET",subresource!~"proxy|attach|log|exec|portforward",scope=~"resource|",le="1"}[1d]))
                or
                vector(0)
              )
              +
              sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="apiserver",verb=~"LIST|GET",subresource!~"proxy|attach|log|exec|portforward",scope="namespace",le="5"}[1d]))
              +
              sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="apiserver",verb=~"LIST|GET",subresource!~"proxy|attach|log|exec|portforward",scope="cluster",le="30"}[1d]))
            )
          )
          +
          # errors
          sum by (cluster) (rate(apiserver_request_total{job="apiserver",verb=~"LIST|GET",code=~"5.."}[1d]))
        )
        /
        sum by (cluster) (rate(apiserver_request_total{job="apiserver",verb=~"LIST|GET"}[1d]))
      labels:
        verb: read
      record: apiserver_request:burnrate1d
    - expr: |-
        (
          (
            # too slow
            sum by (cluster) (rate(apiserver_request_sli_duration_seconds_count{job="apiserver",verb=~"LIST|GET",subresource!~"proxy|attach|log|exec|portforward"}[1h]))
            -
            (
              (
                sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="apiserver",verb=~"LIST|GET",subresource!~"proxy|attach|log|exec|portforward",scope=~"resource|",le="1"}[1h]))
                or
                vector(0)
              )
              +
              sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="apiserver",verb=~"LIST|GET",subresource!~"proxy|attach|log|exec|portforward",scope="namespace",le="5"}[1h]))
              +
              sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="apiserver",verb=~"LIST|GET",subresource!~"proxy|attach|log|exec|portforward",scope="cluster",le="30"}[1h]))
            )
          )
          +
          # errors
          sum by (cluster) (rate(apiserver_request_total{job="apiserver",verb=~"LIST|GET",code=~"5.."}[1h]))
        )
        /
        sum by (cluster) (rate(apiserver_request_total{job="apiserver",verb=~"LIST|GET"}[1h]))
      labels:
        verb: read
      record: apiserver_request:burnrate1h
    - expr: |-
        (
          (
            # too slow
            sum by (cluster) (rate(apiserver_request_sli_duration_seconds_count{job="apiserver",verb=~"LIST|GET",subresource!~"proxy|attach|log|exec|portforward"}[2h]))
            -
            (
              (
                sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="apiserver",verb=~"LIST|GET",subresource!~"proxy|attach|log|exec|portforward",scope=~"resource|",le="1"}[2h]))
                or
                vector(0)
              )
              +
              sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="apiserver",verb=~"LIST|GET",subresource!~"proxy|attach|log|exec|portforward",scope="namespace",le="5"}[2h]))
              +
              sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="apiserver",verb=~"LIST|GET",subresource!~"proxy|attach|log|exec|portforward",scope="cluster",le="30"}[2h]))
            )
          )
          +
          # errors
          sum by (cluster) (rate(apiserver_request_total{job="apiserver",verb=~"LIST|GET",code=~"5.."}[2h]))
        )
        /
        sum by (cluster) (rate(apiserver_request_total{job="apiserver",verb=~"LIST|GET"}[2h]))
      labels:
        verb: read
      record: apiserver_request:burnrate2h
    - expr: |-
        (
          (
            # too slow
            sum by (cluster) (rate(apiserver_request_sli_duration_seconds_count{job="apiserver",verb=~"LIST|GET",subresource!~"proxy|attach|log|exec|portforward"}[30m]))
            -
            (
              (
                sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="apiserver",verb=~"LIST|GET",subresource!~"proxy|attach|log|exec|portforward",scope=~"resource|",le="1"}[30m]))
                or
                vector(0)
              )
              +
              sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="apiserver",verb=~"LIST|GET",subresource!~"proxy|attach|log|exec|portforward",scope="namespace",le="5"}[30m]))
              +
              sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="apiserver",verb=~"LIST|GET",subresource!~"proxy|attach|log|exec|portforward",scope="cluster",le="30"}[30m]))
            )
          )
          +
          # errors
          sum by (cluster) (rate(apiserver_request_total{job="apiserver",verb=~"LIST|GET",code=~"5.."}[30m]))
        )
        /
        sum by (cluster) (rate(apiserver_request_total{job="apiserver",verb=~"LIST|GET"}[30m]))
      labels:
        verb: read
      record: apiserver_request:burnrate30m
    - expr: |-
        (
          (
            # too slow
            sum by (cluster) (rate(apiserver_request_sli_duration_seconds_count{job="apiserver",verb=~"LIST|GET",subresource!~"proxy|attach|log|exec|portforward"}[3d]))
            -
            (
              (
                sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="apiserver",verb=~"LIST|GET",subresource!~"proxy|attach|log|exec|portforward",scope=~"resource|",le="1"}[3d]))
                or
                vector(0)
              )
              +
              sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="apiserver",verb=~"LIST|GET",subresource!~"proxy|attach|log|exec|portforward",scope="namespace",le="5"}[3d]))
              +
              sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="apiserver",verb=~"LIST|GET",subresource!~"proxy|attach|log|exec|portforward",scope="cluster",le="30"}[3d]))
            )
          )
          +
          # errors
          sum by (cluster) (rate(apiserver_request_total{job="apiserver",verb=~"LIST|GET",code=~"5.."}[3d]))
        )
        /
        sum by (cluster) (rate(apiserver_request_total{job="apiserver",verb=~"LIST|GET"}[3d]))
      labels:
        verb: read
      record: apiserver_request:burnrate3d
    - expr: |-
        (
          (
            # too slow
            sum by (cluster) (rate(apiserver_request_sli_duration_seconds_count{job="apiserver",verb=~"LIST|GET",subresource!~"proxy|attach|log|exec|portforward"}[5m]))
            -
            (
              (
                sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="apiserver",verb=~"LIST|GET",subresource!~"proxy|attach|log|exec|portforward",scope=~"resource|",le="1"}[5m]))
                or
                vector(0)
              )
              +
              sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="apiserver",verb=~"LIST|GET",subresource!~"proxy|attach|log|exec|portforward",scope="namespace",le="5"}[5m]))
              +
              sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="apiserver",verb=~"LIST|GET",subresource!~"proxy|attach|log|exec|portforward",scope="cluster",le="30"}[5m]))
            )
          )
          +
          # errors
          sum by (cluster) (rate(apiserver_request_total{job="apiserver",verb=~"LIST|GET",code=~"5.."}[5m]))
        )
        /
        sum by (cluster) (rate(apiserver_request_total{job="apiserver",verb=~"LIST|GET"}[5m]))
      labels:
        verb: read
      record: apiserver_request:burnrate5m
    - expr: |-
        (
          (
            # too slow
            sum by (cluster) (rate(apiserver_request_sli_duration_seconds_count{job="apiserver",verb=~"LIST|GET",subresource!~"proxy|attach|log|exec|portforward"}[6h]))
            -
            (
              (
                sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="apiserver",verb=~"LIST|GET",subresource!~"proxy|attach|log|exec|portforward",scope=~"resource|",le="1"}[6h]))
                or
                vector(0)
              )
              +
              sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="apiserver",verb=~"LIST|GET",subresource!~"proxy|attach|log|exec|portforward",scope="namespace",le="5"}[6h]))
              +
              sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="apiserver",verb=~"LIST|GET",subresource!~"proxy|attach|log|exec|portforward",scope="cluster",le="30"}[6h]))
            )
          )
          +
          # errors
          sum by (cluster) (rate(apiserver_request_total{job="apiserver",verb=~"LIST|GET",code=~"5.."}[6h]))
        )
        /
        sum by (cluster) (rate(apiserver_request_total{job="apiserver",verb=~"LIST|GET"}[6h]))
      labels:
        verb: read
      record: apiserver_request:burnrate6h
    - expr: |-
        (
          (
            # too slow
            sum by (cluster) (rate(apiserver_request_sli_duration_seconds_count{job="apiserver",verb=~"POST|PUT|PATCH|DELETE",subresource!~"proxy|attach|log|exec|portforward"}[1d]))
            -
            sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="apiserver",verb=~"POST|PUT|PATCH|DELETE",subresource!~"proxy|attach|log|exec|portforward",le="1"}[1d]))
          )
          +
          sum by (cluster) (rate(apiserver_request_total{job="apiserver",verb=~"POST|PUT|PATCH|DELETE",code=~"5.."}[1d]))
        )
        /
        sum by (cluster) (rate(apiserver_request_total{job="apiserver",verb=~"POST|PUT|PATCH|DELETE"}[1d]))
      labels:
        verb: write
      record: apiserver_request:burnrate1d
    - expr: |-
        (
          (
            # too slow
            sum by (cluster) (rate(apiserver_request_sli_duration_seconds_count{job="apiserver",verb=~"POST|PUT|PATCH|DELETE",subresource!~"proxy|attach|log|exec|portforward"}[1h]))
            -
            sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="apiserver",verb=~"POST|PUT|PATCH|DELETE",subresource!~"proxy|attach|log|exec|portforward",le="1"}[1h]))
          )
          +
          sum by (cluster) (rate(apiserver_request_total{job="apiserver",verb=~"POST|PUT|PATCH|DELETE",code=~"5.."}[1h]))
        )
        /
        sum by (cluster) (rate(apiserver_request_total{job="apiserver",verb=~"POST|PUT|PATCH|DELETE"}[1h]))
      labels:
        verb: write
      record: apiserver_request:burnrate1h
    - expr: |-
        (
          (
            # too slow
            sum by (cluster) (rate(apiserver_request_sli_duration_seconds_count{job="apiserver",verb=~"POST|PUT|PATCH|DELETE",subresource!~"proxy|attach|log|exec|portforward"}[2h]))
            -
            sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="apiserver",verb=~"POST|PUT|PATCH|DELETE",subresource!~"proxy|attach|log|exec|portforward",le="1"}[2h]))
          )
          +
          sum by (cluster) (rate(apiserver_request_total{job="apiserver",verb=~"POST|PUT|PATCH|DELETE",code=~"5.."}[2h]))
        )
        /
        sum by (cluster) (rate(apiserver_request_total{job="apiserver",verb=~"POST|PUT|PATCH|DELETE"}[2h]))
      labels:
        verb: write
      record: apiserver_request:burnrate2h
    - expr: |-
        (
          (
            # too slow
            sum by (cluster) (rate(apiserver_request_sli_duration_seconds_count{job="apiserver",verb=~"POST|PUT|PATCH|DELETE",subresource!~"proxy|attach|log|exec|portforward"}[30m]))
            -
            sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="apiserver",verb=~"POST|PUT|PATCH|DELETE",subresource!~"proxy|attach|log|exec|portforward",le="1"}[30m]))
          )
          +
          sum by (cluster) (rate(apiserver_request_total{job="apiserver",verb=~"POST|PUT|PATCH|DELETE",code=~"5.."}[30m]))
        )
        /
        sum by (cluster) (rate(apiserver_request_total{job="apiserver",verb=~"POST|PUT|PATCH|DELETE"}[30m]))
      labels:
        verb: write
      record: apiserver_request:burnrate30m
    - expr: |-
        (
          (
            # too slow
            sum by (cluster) (rate(apiserver_request_sli_duration_seconds_count{job="apiserver",verb=~"POST|PUT|PATCH|DELETE",subresource!~"proxy|attach|log|exec|portforward"}[3d]))
            -
            sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="apiserver",verb=~"POST|PUT|PATCH|DELETE",subresource!~"proxy|attach|log|exec|portforward",le="1"}[3d]))
          )
          +
          sum by (cluster) (rate(apiserver_request_total{job="apiserver",verb=~"POST|PUT|PATCH|DELETE",code=~"5.."}[3d]))
        )
        /
        sum by (cluster) (rate(apiserver_request_total{job="apiserver",verb=~"POST|PUT|PATCH|DELETE"}[3d]))
      labels:
        verb: write
      record: apiserver_request:burnrate3d
    - expr: |-
        (
          (
            # too slow
            sum by (cluster) (rate(apiserver_request_sli_duration_seconds_count{job="apiserver",verb=~"POST|PUT|PATCH|DELETE",subresource!~"proxy|attach|log|exec|portforward"}[5m]))
            -
            sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="apiserver",verb=~"POST|PUT|PATCH|DELETE",subresource!~"proxy|attach|log|exec|portforward",le="1"}[5m]))
          )
          +
          sum by (cluster) (rate(apiserver_request_total{job="apiserver",verb=~"POST|PUT|PATCH|DELETE",code=~"5.."}[5m]))
        )
        /
        sum by (cluster) (rate(apiserver_request_total{job="apiserver",verb=~"POST|PUT|PATCH|DELETE"}[5m]))
      labels:
        verb: write
      record: apiserver_request:burnrate5m
    - expr: |-
        (
          (
            # too slow
            sum by (cluster) (rate(apiserver_request_sli_duration_seconds_count{job="apiserver",verb=~"POST|PUT|PATCH|DELETE",subresource!~"proxy|attach|log|exec|portforward"}[6h]))
            -
            sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="apiserver",verb=~"POST|PUT|PATCH|DELETE",subresource!~"proxy|attach|log|exec|portforward",le="1"}[6h]))
          )
          +
          sum by (cluster) (rate(apiserver_request_total{job="apiserver",verb=~"POST|PUT|PATCH|DELETE",code=~"5.."}[6h]))
        )
        /
        sum by (cluster) (rate(apiserver_request_total{job="apiserver",verb=~"POST|PUT|PATCH|DELETE"}[6h]))
      labels:
        verb: write
      record: apiserver_request:burnrate6h
---
# Source: victoria-metrics-k8s-stack/templates/rules/kube-apiserver-histogram.rules.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-kube-apiserver-histogram
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: kube-apiserver-histogram.rules
    rules:
    - expr: histogram_quantile(0.99, sum by (cluster, le, resource) (rate(apiserver_request_sli_duration_seconds_bucket{job="apiserver",verb=~"LIST|GET",subresource!~"proxy|attach|log|exec|portforward"}[5m]))) > 0
      labels:
        quantile: '0.99'
        verb: read
      record: cluster_quantile:apiserver_request_sli_duration_seconds:histogram_quantile
    - expr: histogram_quantile(0.99, sum by (cluster, le, resource) (rate(apiserver_request_sli_duration_seconds_bucket{job="apiserver",verb=~"POST|PUT|PATCH|DELETE",subresource!~"proxy|attach|log|exec|portforward"}[5m]))) > 0
      labels:
        quantile: '0.99'
        verb: write
      record: cluster_quantile:apiserver_request_sli_duration_seconds:histogram_quantile
---
# Source: victoria-metrics-k8s-stack/templates/rules/kube-apiserver-slos.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-kube-apiserver-slos
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: kube-apiserver-slos
    rules:
    - alert: KubeAPIErrorBudgetBurn
      annotations:
        description: The API server is burning too much error budget.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubeapierrorbudgetburn
        summary: The API server is burning too much error budget.
      expr: |-
        sum(apiserver_request:burnrate1h) > (14.40 * 0.01000)
        and
        sum(apiserver_request:burnrate5m) > (14.40 * 0.01000)
      for: 2m
      labels:
        long: 1h
        severity: critical
        short: 5m
    - alert: KubeAPIErrorBudgetBurn
      annotations:
        description: The API server is burning too much error budget.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubeapierrorbudgetburn
        summary: The API server is burning too much error budget.
      expr: |-
        sum(apiserver_request:burnrate6h) > (6.00 * 0.01000)
        and
        sum(apiserver_request:burnrate30m) > (6.00 * 0.01000)
      for: 15m
      labels:
        long: 6h
        severity: critical
        short: 30m
    - alert: KubeAPIErrorBudgetBurn
      annotations:
        description: The API server is burning too much error budget.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubeapierrorbudgetburn
        summary: The API server is burning too much error budget.
      expr: |-
        sum(apiserver_request:burnrate1d) > (3.00 * 0.01000)
        and
        sum(apiserver_request:burnrate2h) > (3.00 * 0.01000)
      for: 1h
      labels:
        long: 1d
        severity: warning
        short: 2h
    - alert: KubeAPIErrorBudgetBurn
      annotations:
        description: The API server is burning too much error budget.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubeapierrorbudgetburn
        summary: The API server is burning too much error budget.
      expr: |-
        sum(apiserver_request:burnrate3d) > (1.00 * 0.01000)
        and
        sum(apiserver_request:burnrate6h) > (1.00 * 0.01000)
      for: 3h
      labels:
        long: 3d
        severity: warning
        short: 6h
---
# Source: victoria-metrics-k8s-stack/templates/rules/kube-prometheus-general.rules.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-kube-prometheus-general.r
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: kube-prometheus-general.rules
    rules:
    - expr: count without(instance, pod, node) (up == 1)
      record: count:up1
    - expr: count without(instance, pod, node) (up == 0)
      record: count:up0
---
# Source: victoria-metrics-k8s-stack/templates/rules/kube-prometheus-node-recording.rules.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-kube-prometheus-node-reco
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: kube-prometheus-node-recording.rules
    rules:
    - expr: sum(rate(node_cpu_seconds_total{mode!="idle",mode!="iowait",mode!="steal"}[3m])) BY (instance)
      record: instance:node_cpu:rate:sum
    - expr: sum(rate(node_network_receive_bytes_total[3m])) BY (instance)
      record: instance:node_network_receive_bytes:rate:sum
    - expr: sum(rate(node_network_transmit_bytes_total[3m])) BY (instance)
      record: instance:node_network_transmit_bytes:rate:sum
    - expr: sum(rate(node_cpu_seconds_total{mode!="idle",mode!="iowait",mode!="steal"}[5m])) WITHOUT (cpu, mode) / ON(instance) GROUP_LEFT() count(sum(node_cpu_seconds_total) BY (instance, cpu)) BY (instance)
      record: instance:node_cpu:ratio
    - expr: sum(rate(node_cpu_seconds_total{mode!="idle",mode!="iowait",mode!="steal"}[5m]))
      record: cluster:node_cpu:sum_rate5m
    - expr: cluster:node_cpu:sum_rate5m / count(sum(node_cpu_seconds_total) BY (instance, cpu))
      record: cluster:node_cpu:ratio
---
# Source: victoria-metrics-k8s-stack/templates/rules/kube-scheduler.rules.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-kube-scheduler.rules
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: kube-scheduler.rules
    rules:
    - expr: histogram_quantile(0.99, sum(rate(scheduler_e2e_scheduling_duration_seconds_bucket{job="kube-scheduler"}[5m])) without(instance, pod))
      labels:
        quantile: '0.99'
      record: cluster_quantile:scheduler_e2e_scheduling_duration_seconds:histogram_quantile
    - expr: histogram_quantile(0.99, sum(rate(scheduler_scheduling_algorithm_duration_seconds_bucket{job="kube-scheduler"}[5m])) without(instance, pod))
      labels:
        quantile: '0.99'
      record: cluster_quantile:scheduler_scheduling_algorithm_duration_seconds:histogram_quantile
    - expr: histogram_quantile(0.99, sum(rate(scheduler_binding_duration_seconds_bucket{job="kube-scheduler"}[5m])) without(instance, pod))
      labels:
        quantile: '0.99'
      record: cluster_quantile:scheduler_binding_duration_seconds:histogram_quantile
    - expr: histogram_quantile(0.9, sum(rate(scheduler_e2e_scheduling_duration_seconds_bucket{job="kube-scheduler"}[5m])) without(instance, pod))
      labels:
        quantile: '0.9'
      record: cluster_quantile:scheduler_e2e_scheduling_duration_seconds:histogram_quantile
    - expr: histogram_quantile(0.9, sum(rate(scheduler_scheduling_algorithm_duration_seconds_bucket{job="kube-scheduler"}[5m])) without(instance, pod))
      labels:
        quantile: '0.9'
      record: cluster_quantile:scheduler_scheduling_algorithm_duration_seconds:histogram_quantile
    - expr: histogram_quantile(0.9, sum(rate(scheduler_binding_duration_seconds_bucket{job="kube-scheduler"}[5m])) without(instance, pod))
      labels:
        quantile: '0.9'
      record: cluster_quantile:scheduler_binding_duration_seconds:histogram_quantile
    - expr: histogram_quantile(0.5, sum(rate(scheduler_e2e_scheduling_duration_seconds_bucket{job="kube-scheduler"}[5m])) without(instance, pod))
      labels:
        quantile: '0.5'
      record: cluster_quantile:scheduler_e2e_scheduling_duration_seconds:histogram_quantile
    - expr: histogram_quantile(0.5, sum(rate(scheduler_scheduling_algorithm_duration_seconds_bucket{job="kube-scheduler"}[5m])) without(instance, pod))
      labels:
        quantile: '0.5'
      record: cluster_quantile:scheduler_scheduling_algorithm_duration_seconds:histogram_quantile
    - expr: histogram_quantile(0.5, sum(rate(scheduler_binding_duration_seconds_bucket{job="kube-scheduler"}[5m])) without(instance, pod))
      labels:
        quantile: '0.5'
      record: cluster_quantile:scheduler_binding_duration_seconds:histogram_quantile
---
# Source: victoria-metrics-k8s-stack/templates/rules/kube-state-metrics.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-kube-state-metrics
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: kube-state-metrics
    rules:
    - alert: KubeStateMetricsListErrors
      annotations:
        description: kube-state-metrics is experiencing errors at an elevated rate in list operations. This is likely causing it to not be able to expose metrics about Kubernetes objects correctly or at all.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kube-state-metrics/kubestatemetricslisterrors
        summary: kube-state-metrics is experiencing errors in list operations.
      expr: |-
        (sum(rate(kube_state_metrics_list_total{job="kube-state-metrics",result="error"}[5m])) by (cluster)
          /
        sum(rate(kube_state_metrics_list_total{job="kube-state-metrics"}[5m])) by (cluster))
        > 0.01
      for: 15m
      labels:
        severity: critical
    - alert: KubeStateMetricsWatchErrors
      annotations:
        description: kube-state-metrics is experiencing errors at an elevated rate in watch operations. This is likely causing it to not be able to expose metrics about Kubernetes objects correctly or at all.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kube-state-metrics/kubestatemetricswatcherrors
        summary: kube-state-metrics is experiencing errors in watch operations.
      expr: |-
        (sum(rate(kube_state_metrics_watch_total{job="kube-state-metrics",result="error"}[5m])) by (cluster)
          /
        sum(rate(kube_state_metrics_watch_total{job="kube-state-metrics"}[5m])) by (cluster))
        > 0.01
      for: 15m
      labels:
        severity: critical
    - alert: KubeStateMetricsShardingMismatch
      annotations:
        description: kube-state-metrics pods are running with different --total-shards configuration, some Kubernetes objects may be exposed multiple times or not exposed at all.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kube-state-metrics/kubestatemetricsshardingmismatch
        summary: kube-state-metrics sharding is misconfigured.
      expr: stdvar (kube_state_metrics_total_shards{job="kube-state-metrics"}) by (cluster) != 0
      for: 15m
      labels:
        severity: critical
    - alert: KubeStateMetricsShardsMissing
      annotations:
        description: kube-state-metrics shards are missing, some Kubernetes objects are not being exposed.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kube-state-metrics/kubestatemetricsshardsmissing
        summary: kube-state-metrics shards are missing.
      expr: |-
        2^max(kube_state_metrics_total_shards{job="kube-state-metrics"}) by (cluster) - 1
          -
        sum( 2 ^ max by (cluster, shard_ordinal) (kube_state_metrics_shard_ordinal{job="kube-state-metrics"}) ) by (cluster)
        != 0
      for: 15m
      labels:
        severity: critical
---
# Source: victoria-metrics-k8s-stack/templates/rules/kubelet.rules.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-kubelet.rules
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: kubelet.rules
    rules:
    - expr: histogram_quantile(0.99, sum(rate(kubelet_pleg_relist_duration_seconds_bucket{job="kubelet", metrics_path="/metrics"}[5m])) by (cluster, instance, le) * on(cluster, instance) group_left(node) kubelet_node_name{job="kubelet", metrics_path="/metrics"})
      labels:
        quantile: '0.99'
      record: node_quantile:kubelet_pleg_relist_duration_seconds:histogram_quantile
    - expr: histogram_quantile(0.9, sum(rate(kubelet_pleg_relist_duration_seconds_bucket{job="kubelet", metrics_path="/metrics"}[5m])) by (cluster, instance, le) * on(cluster, instance) group_left(node) kubelet_node_name{job="kubelet", metrics_path="/metrics"})
      labels:
        quantile: '0.9'
      record: node_quantile:kubelet_pleg_relist_duration_seconds:histogram_quantile
    - expr: histogram_quantile(0.5, sum(rate(kubelet_pleg_relist_duration_seconds_bucket{job="kubelet", metrics_path="/metrics"}[5m])) by (cluster, instance, le) * on(cluster, instance) group_left(node) kubelet_node_name{job="kubelet", metrics_path="/metrics"})
      labels:
        quantile: '0.5'
      record: node_quantile:kubelet_pleg_relist_duration_seconds:histogram_quantile
---
# Source: victoria-metrics-k8s-stack/templates/rules/kubernetes-apps.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-kubernetes-apps
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: kubernetes-apps
    rules:
    - alert: KubePodCrashLooping
      annotations:
        description: 'Pod {{ $labels.namespace }}/{{ $labels.pod }} ({{ $labels.container }}) is in waiting state (reason: "CrashLoopBackOff").'
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubepodcrashlooping
        summary: Pod is crash looping.
      expr: max_over_time(kube_pod_container_status_waiting_reason{reason="CrashLoopBackOff", job="kube-state-metrics", namespace=~".*"}[5m]) >= 1
      for: 15m
      labels:
        severity: warning
    - alert: KubePodNotReady
      annotations:
        description: Pod {{ $labels.namespace }}/{{ $labels.pod }} has been in a non-ready state for longer than 15 minutes.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubepodnotready
        summary: Pod has been in a non-ready state for more than 15 minutes.
      expr: |-
        sum by (namespace, pod, cluster) (
          max by(namespace, pod, cluster) (
            kube_pod_status_phase{job="kube-state-metrics", namespace=~".*", phase=~"Pending|Unknown|Failed"}
          ) * on(namespace, pod, cluster) group_left(owner_kind) topk by(namespace, pod, cluster) (
            1, max by(namespace, pod, owner_kind, cluster) (kube_pod_owner{owner_kind!="Job"})
          )
        ) > 0
      for: 15m
      labels:
        severity: warning
    - alert: KubeDeploymentGenerationMismatch
      annotations:
        description: Deployment generation for {{ $labels.namespace }}/{{ $labels.deployment }} does not match, this indicates that the Deployment has failed but has not been rolled back.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubedeploymentgenerationmismatch
        summary: Deployment generation mismatch due to possible roll-back
      expr: |-
        kube_deployment_status_observed_generation{job="kube-state-metrics", namespace=~".*"}
          !=
        kube_deployment_metadata_generation{job="kube-state-metrics", namespace=~".*"}
      for: 15m
      labels:
        severity: warning
    - alert: KubeDeploymentReplicasMismatch
      annotations:
        description: Deployment {{ $labels.namespace }}/{{ $labels.deployment }} has not matched the expected number of replicas for longer than 15 minutes.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubedeploymentreplicasmismatch
        summary: Deployment has not matched the expected number of replicas.
      expr: |-
        (
          kube_deployment_spec_replicas{job="kube-state-metrics", namespace=~".*"}
            >
          kube_deployment_status_replicas_available{job="kube-state-metrics", namespace=~".*"}
        ) and (
          changes(kube_deployment_status_replicas_updated{job="kube-state-metrics", namespace=~".*"}[10m])
            ==
          0
        )
      for: 15m
      labels:
        severity: warning
    - alert: KubeDeploymentRolloutStuck
      annotations:
        description: Rollout of deployment {{ $labels.namespace }}/{{ $labels.deployment }} is not progressing for longer than 15 minutes.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubedeploymentrolloutstuck
        summary: Deployment rollout is not progressing.
      expr: |-
        kube_deployment_status_condition{condition="Progressing", status="false",job="kube-state-metrics", namespace=~".*"}
        != 0
      for: 15m
      labels:
        severity: warning
    - alert: KubeStatefulSetReplicasMismatch
      annotations:
        description: StatefulSet {{ $labels.namespace }}/{{ $labels.statefulset }} has not matched the expected number of replicas for longer than 15 minutes.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubestatefulsetreplicasmismatch
        summary: StatefulSet has not matched the expected number of replicas.
      expr: |-
        (
          kube_statefulset_status_replicas_ready{job="kube-state-metrics", namespace=~".*"}
            !=
          kube_statefulset_status_replicas{job="kube-state-metrics", namespace=~".*"}
        ) and (
          changes(kube_statefulset_status_replicas_updated{job="kube-state-metrics", namespace=~".*"}[10m])
            ==
          0
        )
      for: 15m
      labels:
        severity: warning
    - alert: KubeStatefulSetGenerationMismatch
      annotations:
        description: StatefulSet generation for {{ $labels.namespace }}/{{ $labels.statefulset }} does not match, this indicates that the StatefulSet has failed but has not been rolled back.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubestatefulsetgenerationmismatch
        summary: StatefulSet generation mismatch due to possible roll-back
      expr: |-
        kube_statefulset_status_observed_generation{job="kube-state-metrics", namespace=~".*"}
          !=
        kube_statefulset_metadata_generation{job="kube-state-metrics", namespace=~".*"}
      for: 15m
      labels:
        severity: warning
    - alert: KubeStatefulSetUpdateNotRolledOut
      annotations:
        description: StatefulSet {{ $labels.namespace }}/{{ $labels.statefulset }} update has not been rolled out.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubestatefulsetupdatenotrolledout
        summary: StatefulSet update has not been rolled out.
      expr: |-
        (
          max without (revision) (
            kube_statefulset_status_current_revision{job="kube-state-metrics", namespace=~".*"}
              unless
            kube_statefulset_status_update_revision{job="kube-state-metrics", namespace=~".*"}
          )
            *
          (
            kube_statefulset_replicas{job="kube-state-metrics", namespace=~".*"}
              !=
            kube_statefulset_status_replicas_updated{job="kube-state-metrics", namespace=~".*"}
          )
        )  and (
          changes(kube_statefulset_status_replicas_updated{job="kube-state-metrics", namespace=~".*"}[5m])
            ==
          0
        )
      for: 15m
      labels:
        severity: warning
    - alert: KubeDaemonSetRolloutStuck
      annotations:
        description: DaemonSet {{ $labels.namespace }}/{{ $labels.daemonset }} has not finished or progressed for at least 15 minutes.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubedaemonsetrolloutstuck
        summary: DaemonSet rollout is stuck.
      expr: |-
        (
          (
            kube_daemonset_status_current_number_scheduled{job="kube-state-metrics", namespace=~".*"}
             !=
            kube_daemonset_status_desired_number_scheduled{job="kube-state-metrics", namespace=~".*"}
          ) or (
            kube_daemonset_status_number_misscheduled{job="kube-state-metrics", namespace=~".*"}
             !=
            0
          ) or (
            kube_daemonset_status_updated_number_scheduled{job="kube-state-metrics", namespace=~".*"}
             !=
            kube_daemonset_status_desired_number_scheduled{job="kube-state-metrics", namespace=~".*"}
          ) or (
            kube_daemonset_status_number_available{job="kube-state-metrics", namespace=~".*"}
             !=
            kube_daemonset_status_desired_number_scheduled{job="kube-state-metrics", namespace=~".*"}
          )
        ) and (
          changes(kube_daemonset_status_updated_number_scheduled{job="kube-state-metrics", namespace=~".*"}[5m])
            ==
          0
        )
      for: 15m
      labels:
        severity: warning
    - alert: KubeContainerWaiting
      annotations:
        description: pod/{{ $labels.pod }} in namespace {{ $labels.namespace }} on container {{ $labels.container}} has been in waiting state for longer than 1 hour.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubecontainerwaiting
        summary: Pod container waiting longer than 1 hour
      expr: sum by (namespace, pod, container, cluster) (kube_pod_container_status_waiting_reason{job="kube-state-metrics", namespace=~".*"}) > 0
      for: 1h
      labels:
        severity: warning
    - alert: KubeDaemonSetNotScheduled
      annotations:
        description: '{{ $value }} Pods of DaemonSet {{ $labels.namespace }}/{{ $labels.daemonset }} are not scheduled.'
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubedaemonsetnotscheduled
        summary: DaemonSet pods are not scheduled.
      expr: |-
        kube_daemonset_status_desired_number_scheduled{job="kube-state-metrics", namespace=~".*"}
          -
        kube_daemonset_status_current_number_scheduled{job="kube-state-metrics", namespace=~".*"} > 0
      for: 10m
      labels:
        severity: warning
    - alert: KubeDaemonSetMisScheduled
      annotations:
        description: '{{ $value }} Pods of DaemonSet {{ $labels.namespace }}/{{ $labels.daemonset }} are running where they are not supposed to run.'
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubedaemonsetmisscheduled
        summary: DaemonSet pods are misscheduled.
      expr: kube_daemonset_status_number_misscheduled{job="kube-state-metrics", namespace=~".*"} > 0
      for: 15m
      labels:
        severity: warning
    - alert: KubeJobNotCompleted
      annotations:
        description: Job {{ $labels.namespace }}/{{ $labels.job_name }} is taking more than {{ "43200" | humanizeDuration }} to complete.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubejobnotcompleted
        summary: Job did not complete in time
      expr: |-
        time() - max by(namespace, job_name, cluster) (kube_job_status_start_time{job="kube-state-metrics", namespace=~".*"}
          and
        kube_job_status_active{job="kube-state-metrics", namespace=~".*"} > 0) > 43200
      labels:
        severity: warning
    - alert: KubeJobFailed
      annotations:
        description: Job {{ $labels.namespace }}/{{ $labels.job_name }} failed to complete. Removing failed job after investigation should clear this alert.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubejobfailed
        summary: Job failed to complete.
      expr: kube_job_failed{job="kube-state-metrics", namespace=~".*"}  > 0
      for: 15m
      labels:
        severity: warning
    - alert: KubeHpaReplicasMismatch
      annotations:
        description: HPA {{ $labels.namespace }}/{{ $labels.horizontalpodautoscaler  }} has not matched the desired number of replicas for longer than 15 minutes.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubehpareplicasmismatch
        summary: HPA has not matched desired number of replicas.
      expr: |-
        (kube_horizontalpodautoscaler_status_desired_replicas{job="kube-state-metrics", namespace=~".*"}
          !=
        kube_horizontalpodautoscaler_status_current_replicas{job="kube-state-metrics", namespace=~".*"})
          and
        (kube_horizontalpodautoscaler_status_current_replicas{job="kube-state-metrics", namespace=~".*"}
          >
        kube_horizontalpodautoscaler_spec_min_replicas{job="kube-state-metrics", namespace=~".*"})
          and
        (kube_horizontalpodautoscaler_status_current_replicas{job="kube-state-metrics", namespace=~".*"}
          <
        kube_horizontalpodautoscaler_spec_max_replicas{job="kube-state-metrics", namespace=~".*"})
          and
        changes(kube_horizontalpodautoscaler_status_current_replicas{job="kube-state-metrics", namespace=~".*"}[15m]) == 0
      for: 15m
      labels:
        severity: warning
    - alert: KubeHpaMaxedOut
      annotations:
        description: HPA {{ $labels.namespace }}/{{ $labels.horizontalpodautoscaler  }} has been running at max replicas for longer than 15 minutes.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubehpamaxedout
        summary: HPA is running at max replicas
      expr: |-
        kube_horizontalpodautoscaler_status_current_replicas{job="kube-state-metrics", namespace=~".*"}
          ==
        kube_horizontalpodautoscaler_spec_max_replicas{job="kube-state-metrics", namespace=~".*"}
      for: 15m
      labels:
        severity: warning
---
# Source: victoria-metrics-k8s-stack/templates/rules/kubernetes-resources.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-kubernetes-resources
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: kubernetes-resources
    rules:
    - alert: KubeCPUOvercommit
      annotations:
        description: Cluster {{ $labels.cluster }} has overcommitted CPU resource requests for Pods by {{ $value }} CPU shares and cannot tolerate node failure.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubecpuovercommit
        summary: Cluster has overcommitted CPU resource requests.
      expr: |-
        sum(namespace_cpu:kube_pod_container_resource_requests:sum{job="kube-state-metrics",}) by (cluster) - (sum(kube_node_status_allocatable{job="kube-state-metrics",resource="cpu"}) by (cluster) - max(kube_node_status_allocatable{job="kube-state-metrics",resource="cpu"}) by (cluster)) > 0
        and
        (sum(kube_node_status_allocatable{job="kube-state-metrics",resource="cpu"}) by (cluster) - max(kube_node_status_allocatable{job="kube-state-metrics",resource="cpu"}) by (cluster)) > 0
      for: 10m
      labels:
        severity: warning
    - alert: KubeMemoryOvercommit
      annotations:
        description: Cluster {{ $labels.cluster }} has overcommitted memory resource requests for Pods by {{ $value | humanize }} bytes and cannot tolerate node failure.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubememoryovercommit
        summary: Cluster has overcommitted memory resource requests.
      expr: |-
        sum(namespace_memory:kube_pod_container_resource_requests:sum{}) by (cluster) - (sum(kube_node_status_allocatable{resource="memory", job="kube-state-metrics"}) by (cluster) - max(kube_node_status_allocatable{resource="memory", job="kube-state-metrics"}) by (cluster)) > 0
        and
        (sum(kube_node_status_allocatable{resource="memory", job="kube-state-metrics"}) by (cluster) - max(kube_node_status_allocatable{resource="memory", job="kube-state-metrics"}) by (cluster)) > 0
      for: 10m
      labels:
        severity: warning
    - alert: KubeCPUQuotaOvercommit
      annotations:
        description: Cluster {{ $labels.cluster }}  has overcommitted CPU resource requests for Namespaces.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubecpuquotaovercommit
        summary: Cluster has overcommitted CPU resource requests.
      expr: |-
        sum(min without(resource) (kube_resourcequota{job="kube-state-metrics", type="hard", resource=~"(cpu|requests.cpu)"})) by (cluster)
          /
        sum(kube_node_status_allocatable{resource="cpu", job="kube-state-metrics"}) by (cluster)
          > 1.5
      for: 5m
      labels:
        severity: warning
    - alert: KubeMemoryQuotaOvercommit
      annotations:
        description: Cluster {{ $labels.cluster }}  has overcommitted memory resource requests for Namespaces.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubememoryquotaovercommit
        summary: Cluster has overcommitted memory resource requests.
      expr: |-
        sum(min without(resource) (kube_resourcequota{job="kube-state-metrics", type="hard", resource=~"(memory|requests.memory)"})) by (cluster)
          /
        sum(kube_node_status_allocatable{resource="memory", job="kube-state-metrics"}) by (cluster)
          > 1.5
      for: 5m
      labels:
        severity: warning
    - alert: KubeQuotaAlmostFull
      annotations:
        description: Namespace {{ $labels.namespace }} is using {{ $value | humanizePercentage }} of its {{ $labels.resource }} quota.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubequotaalmostfull
        summary: Namespace quota is going to be full.
      expr: |-
        kube_resourcequota{job="kube-state-metrics", type="used"}
          / ignoring(instance, job, type)
        (kube_resourcequota{job="kube-state-metrics", type="hard"} > 0)
          > 0.9 < 1
      for: 15m
      labels:
        severity: info
    - alert: KubeQuotaFullyUsed
      annotations:
        description: Namespace {{ $labels.namespace }} is using {{ $value | humanizePercentage }} of its {{ $labels.resource }} quota.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubequotafullyused
        summary: Namespace quota is fully used.
      expr: |-
        kube_resourcequota{job="kube-state-metrics", type="used"}
          / ignoring(instance, job, type)
        (kube_resourcequota{job="kube-state-metrics", type="hard"} > 0)
          == 1
      for: 15m
      labels:
        severity: info
    - alert: KubeQuotaExceeded
      annotations:
        description: Namespace {{ $labels.namespace }} is using {{ $value | humanizePercentage }} of its {{ $labels.resource }} quota.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubequotaexceeded
        summary: Namespace quota has exceeded the limits.
      expr: |-
        kube_resourcequota{job="kube-state-metrics", type="used"}
          / ignoring(instance, job, type)
        (kube_resourcequota{job="kube-state-metrics", type="hard"} > 0)
          > 1
      for: 15m
      labels:
        severity: warning
    - alert: CPUThrottlingHigh
      annotations:
        description: '{{ $value | humanizePercentage }} throttling of CPU in namespace {{ $labels.namespace }} for container {{ $labels.container }} in pod {{ $labels.pod }}.'
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/cputhrottlinghigh
        summary: Processes experience elevated CPU throttling.
      expr: |-
        sum(increase(container_cpu_cfs_throttled_periods_total{container!="", }[5m])) by (cluster, container, pod, namespace)
          /
        sum(increase(container_cpu_cfs_periods_total{}[5m])) by (cluster, container, pod, namespace)
          > ( 25 / 100 )
      for: 15m
      labels:
        severity: info
---
# Source: victoria-metrics-k8s-stack/templates/rules/kubernetes-storage.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-kubernetes-storage
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: kubernetes-storage
    rules:
    - alert: KubePersistentVolumeFillingUp
      annotations:
        description: The PersistentVolume claimed by {{ $labels.persistentvolumeclaim }} in Namespace {{ $labels.namespace }} {{ with $labels.cluster -}} on Cluster {{ . }} {{- end }} is only {{ $value | humanizePercentage }} free.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubepersistentvolumefillingup
        summary: PersistentVolume is filling up.
      expr: |-
        (
          kubelet_volume_stats_available_bytes{job="kubelet", namespace=~".*", metrics_path="/metrics"}
            /
          kubelet_volume_stats_capacity_bytes{job="kubelet", namespace=~".*", metrics_path="/metrics"}
        ) < 0.03
        and
        kubelet_volume_stats_used_bytes{job="kubelet", namespace=~".*", metrics_path="/metrics"} > 0
        unless on(cluster, namespace, persistentvolumeclaim)
        kube_persistentvolumeclaim_access_mode{ access_mode="ReadOnlyMany"} == 1
        unless on(cluster, namespace, persistentvolumeclaim)
        kube_persistentvolumeclaim_labels{label_excluded_from_alerts="true"} == 1
      for: 1m
      labels:
        severity: critical
    - alert: KubePersistentVolumeFillingUp
      annotations:
        description: Based on recent sampling, the PersistentVolume claimed by {{ $labels.persistentvolumeclaim }} in Namespace {{ $labels.namespace }} {{ with $labels.cluster -}} on Cluster {{ . }} {{- end }} is expected to fill up within four days. Currently {{ $value | humanizePercentage }} is available.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubepersistentvolumefillingup
        summary: PersistentVolume is filling up.
      expr: |-
        (
          kubelet_volume_stats_available_bytes{job="kubelet", namespace=~".*", metrics_path="/metrics"}
            /
          kubelet_volume_stats_capacity_bytes{job="kubelet", namespace=~".*", metrics_path="/metrics"}
        ) < 0.15
        and
        kubelet_volume_stats_used_bytes{job="kubelet", namespace=~".*", metrics_path="/metrics"} > 0
        and
        predict_linear(kubelet_volume_stats_available_bytes{job="kubelet", namespace=~".*", metrics_path="/metrics"}[6h], 4 * 24 * 3600) < 0
        unless on(cluster, namespace, persistentvolumeclaim)
        kube_persistentvolumeclaim_access_mode{ access_mode="ReadOnlyMany"} == 1
        unless on(cluster, namespace, persistentvolumeclaim)
        kube_persistentvolumeclaim_labels{label_excluded_from_alerts="true"} == 1
      for: 1h
      labels:
        severity: warning
    - alert: KubePersistentVolumeInodesFillingUp
      annotations:
        description: The PersistentVolume claimed by {{ $labels.persistentvolumeclaim }} in Namespace {{ $labels.namespace }} {{ with $labels.cluster -}} on Cluster {{ . }} {{- end }} only has {{ $value | humanizePercentage }} free inodes.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubepersistentvolumeinodesfillingup
        summary: PersistentVolumeInodes are filling up.
      expr: |-
        (
          kubelet_volume_stats_inodes_free{job="kubelet", namespace=~".*", metrics_path="/metrics"}
            /
          kubelet_volume_stats_inodes{job="kubelet", namespace=~".*", metrics_path="/metrics"}
        ) < 0.03
        and
        kubelet_volume_stats_inodes_used{job="kubelet", namespace=~".*", metrics_path="/metrics"} > 0
        unless on(cluster, namespace, persistentvolumeclaim)
        kube_persistentvolumeclaim_access_mode{ access_mode="ReadOnlyMany"} == 1
        unless on(cluster, namespace, persistentvolumeclaim)
        kube_persistentvolumeclaim_labels{label_excluded_from_alerts="true"} == 1
      for: 1m
      labels:
        severity: critical
    - alert: KubePersistentVolumeInodesFillingUp
      annotations:
        description: Based on recent sampling, the PersistentVolume claimed by {{ $labels.persistentvolumeclaim }} in Namespace {{ $labels.namespace }} {{ with $labels.cluster -}} on Cluster {{ . }} {{- end }} is expected to run out of inodes within four days. Currently {{ $value | humanizePercentage }} of its inodes are free.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubepersistentvolumeinodesfillingup
        summary: PersistentVolumeInodes are filling up.
      expr: |-
        (
          kubelet_volume_stats_inodes_free{job="kubelet", namespace=~".*", metrics_path="/metrics"}
            /
          kubelet_volume_stats_inodes{job="kubelet", namespace=~".*", metrics_path="/metrics"}
        ) < 0.15
        and
        kubelet_volume_stats_inodes_used{job="kubelet", namespace=~".*", metrics_path="/metrics"} > 0
        and
        predict_linear(kubelet_volume_stats_inodes_free{job="kubelet", namespace=~".*", metrics_path="/metrics"}[6h], 4 * 24 * 3600) < 0
        unless on(cluster, namespace, persistentvolumeclaim)
        kube_persistentvolumeclaim_access_mode{ access_mode="ReadOnlyMany"} == 1
        unless on(cluster, namespace, persistentvolumeclaim)
        kube_persistentvolumeclaim_labels{label_excluded_from_alerts="true"} == 1
      for: 1h
      labels:
        severity: warning
    - alert: KubePersistentVolumeErrors
      annotations:
        description: The persistent volume {{ $labels.persistentvolume }} {{ with $labels.cluster -}} on Cluster {{ . }} {{- end }} has status {{ $labels.phase }}.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubepersistentvolumeerrors
        summary: PersistentVolume is having issues with provisioning.
      expr: kube_persistentvolume_status_phase{phase=~"Failed|Pending",job="kube-state-metrics"} > 0
      for: 5m
      labels:
        severity: critical
---
# Source: victoria-metrics-k8s-stack/templates/rules/kubernetes-system-apiserver.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-kubernetes-system-apiserv
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: kubernetes-system-apiserver
    rules:
    - alert: KubeClientCertificateExpiration
      annotations:
        description: A client certificate used to authenticate to kubernetes apiserver is expiring in less than 7.0 days.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubeclientcertificateexpiration
        summary: Client certificate is about to expire.
      expr: apiserver_client_certificate_expiration_seconds_count{job="apiserver"} > 0 and on(job) histogram_quantile(0.01, sum by (job, le) (rate(apiserver_client_certificate_expiration_seconds_bucket{job="apiserver"}[5m]))) < 604800
      for: 5m
      labels:
        severity: warning
    - alert: KubeClientCertificateExpiration
      annotations:
        description: A client certificate used to authenticate to kubernetes apiserver is expiring in less than 24.0 hours.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubeclientcertificateexpiration
        summary: Client certificate is about to expire.
      expr: apiserver_client_certificate_expiration_seconds_count{job="apiserver"} > 0 and on(job) histogram_quantile(0.01, sum by (job, le) (rate(apiserver_client_certificate_expiration_seconds_bucket{job="apiserver"}[5m]))) < 86400
      for: 5m
      labels:
        severity: critical
    - alert: KubeAggregatedAPIErrors
      annotations:
        description: Kubernetes aggregated API {{ $labels.name }}/{{ $labels.namespace }} has reported errors. It has appeared unavailable {{ $value | humanize }} times averaged over the past 10m.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubeaggregatedapierrors
        summary: Kubernetes aggregated API has reported errors.
      expr: sum by(name, namespace, cluster)(increase(aggregator_unavailable_apiservice_total{job="apiserver"}[10m])) > 4
      labels:
        severity: warning
    - alert: KubeAggregatedAPIDown
      annotations:
        description: Kubernetes aggregated API {{ $labels.name }}/{{ $labels.namespace }} has been only {{ $value | humanize }}% available over the last 10m.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubeaggregatedapidown
        summary: Kubernetes aggregated API is down.
      expr: (1 - max by(name, namespace, cluster)(avg_over_time(aggregator_unavailable_apiservice{job="apiserver"}[10m]))) * 100 < 85
      for: 5m
      labels:
        severity: warning
    - alert: KubeAPIDown
      annotations:
        description: KubeAPI has disappeared from Prometheus target discovery.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubeapidown
        summary: Target disappeared from Prometheus target discovery.
      expr: absent(up{job="apiserver"} == 1)
      for: 15m
      labels:
        severity: critical
    - alert: KubeAPITerminatedRequests
      annotations:
        description: The kubernetes apiserver has terminated {{ $value | humanizePercentage }} of its incoming requests.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubeapiterminatedrequests
        summary: The kubernetes apiserver has terminated {{ $value | humanizePercentage }} of its incoming requests.
      expr: sum(rate(apiserver_request_terminations_total{job="apiserver"}[10m]))  / (  sum(rate(apiserver_request_total{job="apiserver"}[10m])) + sum(rate(apiserver_request_terminations_total{job="apiserver"}[10m])) ) > 0.20
      for: 5m
      labels:
        severity: warning
---
# Source: victoria-metrics-k8s-stack/templates/rules/kubernetes-system-controller-manager.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-kubernetes-system-control
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: kubernetes-system-controller-manager
    rules:
    - alert: KubeControllerManagerDown
      annotations:
        description: KubeControllerManager has disappeared from Prometheus target discovery.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubecontrollermanagerdown
        summary: Target disappeared from Prometheus target discovery.
      expr: absent(up{job="kube-controller-manager"} == 1)
      for: 15m
      labels:
        severity: critical
---
# Source: victoria-metrics-k8s-stack/templates/rules/kubernetes-system-kubelet.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-kubernetes-system-kubelet
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: kubernetes-system-kubelet
    rules:
    - alert: KubeNodeNotReady
      annotations:
        description: '{{ $labels.node }} has been unready for more than 15 minutes.'
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubenodenotready
        summary: Node is not ready.
      expr: kube_node_status_condition{job="kube-state-metrics",condition="Ready",status="true"} == 0
      for: 15m
      labels:
        severity: warning
    - alert: KubeNodeUnreachable
      annotations:
        description: '{{ $labels.node }} is unreachable and some workloads may be rescheduled.'
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubenodeunreachable
        summary: Node is unreachable.
      expr: (kube_node_spec_taint{job="kube-state-metrics",key="node.kubernetes.io/unreachable",effect="NoSchedule"} unless ignoring(key,value) kube_node_spec_taint{job="kube-state-metrics",key=~"ToBeDeletedByClusterAutoscaler|cloud.google.com/impending-node-termination|aws-node-termination-handler/spot-itn"}) == 1
      for: 15m
      labels:
        severity: warning
    - alert: KubeletTooManyPods
      annotations:
        description: Kubelet '{{ $labels.node }}' is running at {{ $value | humanizePercentage }} of its Pod capacity.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubelettoomanypods
        summary: Kubelet is running at capacity.
      expr: |-
        count by(cluster, node) (
          (kube_pod_status_phase{job="kube-state-metrics",phase="Running"} == 1) * on(instance,pod,namespace,cluster) group_left(node) topk by(instance,pod,namespace,cluster) (1, kube_pod_info{job="kube-state-metrics"})
        )
        /
        max by(cluster, node) (
          kube_node_status_capacity{job="kube-state-metrics",resource="pods"} != 1
        ) > 0.95
      for: 15m
      labels:
        severity: info
    - alert: KubeNodeReadinessFlapping
      annotations:
        description: The readiness status of node {{ $labels.node }} has changed {{ $value }} times in the last 15 minutes.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubenodereadinessflapping
        summary: Node readiness status is flapping.
      expr: sum(changes(kube_node_status_condition{job="kube-state-metrics",status="true",condition="Ready"}[15m])) by (cluster, node) > 2
      for: 15m
      labels:
        severity: warning
    - alert: KubeletPlegDurationHigh
      annotations:
        description: The Kubelet Pod Lifecycle Event Generator has a 99th percentile duration of {{ $value }} seconds on node {{ $labels.node }}.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubeletplegdurationhigh
        summary: Kubelet Pod Lifecycle Event Generator is taking too long to relist.
      expr: node_quantile:kubelet_pleg_relist_duration_seconds:histogram_quantile{quantile="0.99"} >= 10
      for: 5m
      labels:
        severity: warning
    - alert: KubeletPodStartUpLatencyHigh
      annotations:
        description: Kubelet Pod startup 99th percentile latency is {{ $value }} seconds on node {{ $labels.node }}.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubeletpodstartuplatencyhigh
        summary: Kubelet Pod startup latency is too high.
      expr: histogram_quantile(0.99, sum(rate(kubelet_pod_worker_duration_seconds_bucket{job="kubelet", metrics_path="/metrics"}[5m])) by (cluster, instance, le)) * on(cluster, instance) group_left(node) kubelet_node_name{job="kubelet", metrics_path="/metrics"} > 60
      for: 15m
      labels:
        severity: warning
    - alert: KubeletClientCertificateExpiration
      annotations:
        description: Client certificate for Kubelet on node {{ $labels.node }} expires in {{ $value | humanizeDuration }}.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubeletclientcertificateexpiration
        summary: Kubelet client certificate is about to expire.
      expr: kubelet_certificate_manager_client_ttl_seconds < 604800
      labels:
        severity: warning
    - alert: KubeletClientCertificateExpiration
      annotations:
        description: Client certificate for Kubelet on node {{ $labels.node }} expires in {{ $value | humanizeDuration }}.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubeletclientcertificateexpiration
        summary: Kubelet client certificate is about to expire.
      expr: kubelet_certificate_manager_client_ttl_seconds < 86400
      labels:
        severity: critical
    - alert: KubeletServerCertificateExpiration
      annotations:
        description: Server certificate for Kubelet on node {{ $labels.node }} expires in {{ $value | humanizeDuration }}.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubeletservercertificateexpiration
        summary: Kubelet server certificate is about to expire.
      expr: kubelet_certificate_manager_server_ttl_seconds < 604800
      labels:
        severity: warning
    - alert: KubeletServerCertificateExpiration
      annotations:
        description: Server certificate for Kubelet on node {{ $labels.node }} expires in {{ $value | humanizeDuration }}.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubeletservercertificateexpiration
        summary: Kubelet server certificate is about to expire.
      expr: kubelet_certificate_manager_server_ttl_seconds < 86400
      labels:
        severity: critical
    - alert: KubeletClientCertificateRenewalErrors
      annotations:
        description: Kubelet on node {{ $labels.node }} has failed to renew its client certificate ({{ $value | humanize }} errors in the last 5 minutes).
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubeletclientcertificaterenewalerrors
        summary: Kubelet has failed to renew its client certificate.
      expr: increase(kubelet_certificate_manager_client_expiration_renew_errors[5m]) > 0
      for: 15m
      labels:
        severity: warning
    - alert: KubeletServerCertificateRenewalErrors
      annotations:
        description: Kubelet on node {{ $labels.node }} has failed to renew its server certificate ({{ $value | humanize }} errors in the last 5 minutes).
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubeletservercertificaterenewalerrors
        summary: Kubelet has failed to renew its server certificate.
      expr: increase(kubelet_server_expiration_renew_errors[5m]) > 0
      for: 15m
      labels:
        severity: warning
    - alert: KubeletDown
      annotations:
        description: Kubelet has disappeared from Prometheus target discovery.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubeletdown
        summary: Target disappeared from Prometheus target discovery.
      expr: absent(up{job="kubelet", metrics_path="/metrics"} == 1)
      for: 15m
      labels:
        severity: critical
---
# Source: victoria-metrics-k8s-stack/templates/rules/kubernetes-system-scheduler.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-kubernetes-system-schedul
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: kubernetes-system-scheduler
    rules:
    - alert: KubeSchedulerDown
      annotations:
        description: KubeScheduler has disappeared from Prometheus target discovery.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubeschedulerdown
        summary: Target disappeared from Prometheus target discovery.
      expr: absent(up{job="kube-scheduler"} == 1)
      for: 15m
      labels:
        severity: critical
---
# Source: victoria-metrics-k8s-stack/templates/rules/kubernetes-system.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-kubernetes-system
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: kubernetes-system
    rules:
    - alert: KubeVersionMismatch
      annotations:
        description: There are {{ $value }} different semantic versions of Kubernetes components running.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubeversionmismatch
        summary: Different semantic versions of Kubernetes components running.
      expr: count by (cluster) (count by (git_version, cluster) (label_replace(kubernetes_build_info{job!~"kube-dns|coredns"},"git_version","$1","git_version","(v[0-9]*.[0-9]*).*"))) > 1
      for: 15m
      labels:
        severity: warning
    - alert: KubeClientErrors
      annotations:
        description: Kubernetes API server client '{{ $labels.job }}/{{ $labels.instance }}' is experiencing {{ $value | humanizePercentage }} errors.'
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/kubernetes/kubeclienterrors
        summary: Kubernetes API server client is experiencing errors.
      expr: |-
        (sum(rate(rest_client_requests_total{job="apiserver",code=~"5.."}[5m])) by (cluster, instance, job, namespace)
          /
        sum(rate(rest_client_requests_total{job="apiserver"}[5m])) by (cluster, instance, job, namespace))
        > 0.01
      for: 15m
      labels:
        severity: warning
---
# Source: victoria-metrics-k8s-stack/templates/rules/node-exporter.rules.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-node-exporter.rules
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: node-exporter.rules
    rules:
    - expr: |-
        count without (cpu, mode) (
          node_cpu_seconds_total{job="node-exporter",mode="idle"}
        )
      record: instance:node_num_cpu:sum
    - expr: |-
        1 - avg without (cpu) (
          sum without (mode) (rate(node_cpu_seconds_total{job="node-exporter", mode=~"idle|iowait|steal"}[5m]))
        )
      record: instance:node_cpu_utilisation:rate5m
    - expr: |-
        (
          node_load1{job="node-exporter"}
        /
          instance:node_num_cpu:sum{job="node-exporter"}
        )
      record: instance:node_load1_per_cpu:ratio
    - expr: |-
        1 - (
          (
            node_memory_MemAvailable_bytes{job="node-exporter"}
            or
            (
              node_memory_Buffers_bytes{job="node-exporter"}
              +
              node_memory_Cached_bytes{job="node-exporter"}
              +
              node_memory_MemFree_bytes{job="node-exporter"}
              +
              node_memory_Slab_bytes{job="node-exporter"}
            )
          )
        /
          node_memory_MemTotal_bytes{job="node-exporter"}
        )
      record: instance:node_memory_utilisation:ratio
    - expr: rate(node_vmstat_pgmajfault{job="node-exporter"}[5m])
      record: instance:node_vmstat_pgmajfault:rate5m
    - expr: rate(node_disk_io_time_seconds_total{job="node-exporter", device=~"(/dev/)?(mmcblk.p.+|nvme.+|rbd.+|sd.+|vd.+|xvd.+|dm-.+|md.+|dasd.+)"}[5m])
      record: instance_device:node_disk_io_time_seconds:rate5m
    - expr: rate(node_disk_io_time_weighted_seconds_total{job="node-exporter", device=~"(/dev/)?(mmcblk.p.+|nvme.+|rbd.+|sd.+|vd.+|xvd.+|dm-.+|md.+|dasd.+)"}[5m])
      record: instance_device:node_disk_io_time_weighted_seconds:rate5m
    - expr: |-
        sum without (device) (
          rate(node_network_receive_bytes_total{job="node-exporter", device!="lo"}[5m])
        )
      record: instance:node_network_receive_bytes_excluding_lo:rate5m
    - expr: |-
        sum without (device) (
          rate(node_network_transmit_bytes_total{job="node-exporter", device!="lo"}[5m])
        )
      record: instance:node_network_transmit_bytes_excluding_lo:rate5m
    - expr: |-
        sum without (device) (
          rate(node_network_receive_drop_total{job="node-exporter", device!="lo"}[5m])
        )
      record: instance:node_network_receive_drop_excluding_lo:rate5m
    - expr: |-
        sum without (device) (
          rate(node_network_transmit_drop_total{job="node-exporter", device!="lo"}[5m])
        )
      record: instance:node_network_transmit_drop_excluding_lo:rate5m
---
# Source: victoria-metrics-k8s-stack/templates/rules/node-exporter.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-node-exporter
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: node-exporter
    rules:
    - alert: NodeFilesystemSpaceFillingUp
      annotations:
        description: Filesystem on {{ $labels.device }}, mounted on {{ $labels.mountpoint }}, at {{ $labels.instance }} has only {{ printf "%.2f" $value }}% available space left and is filling up.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/node/nodefilesystemspacefillingup
        summary: Filesystem is predicted to run out of space within the next 24 hours.
      expr: |-
        (
          node_filesystem_avail_bytes{job="node-exporter",fstype!="",mountpoint!=""} / node_filesystem_size_bytes{job="node-exporter",fstype!="",mountpoint!=""} * 100 < 15
        and
          predict_linear(node_filesystem_avail_bytes{job="node-exporter",fstype!="",mountpoint!=""}[6h], 24*60*60) < 0
        and
          node_filesystem_readonly{job="node-exporter",fstype!="",mountpoint!=""} == 0
        )
      for: 1h
      labels:
        severity: warning
    - alert: NodeFilesystemSpaceFillingUp
      annotations:
        description: Filesystem on {{ $labels.device }}, mounted on {{ $labels.mountpoint }}, at {{ $labels.instance }} has only {{ printf "%.2f" $value }}% available space left and is filling up fast.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/node/nodefilesystemspacefillingup
        summary: Filesystem is predicted to run out of space within the next 4 hours.
      expr: |-
        (
          node_filesystem_avail_bytes{job="node-exporter",fstype!="",mountpoint!=""} / node_filesystem_size_bytes{job="node-exporter",fstype!="",mountpoint!=""} * 100 < 10
        and
          predict_linear(node_filesystem_avail_bytes{job="node-exporter",fstype!="",mountpoint!=""}[6h], 4*60*60) < 0
        and
          node_filesystem_readonly{job="node-exporter",fstype!="",mountpoint!=""} == 0
        )
      for: 1h
      labels:
        severity: critical
    - alert: NodeFilesystemAlmostOutOfSpace
      annotations:
        description: Filesystem on {{ $labels.device }}, mounted on {{ $labels.mountpoint }}, at {{ $labels.instance }} has only {{ printf "%.2f" $value }}% available space left.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/node/nodefilesystemalmostoutofspace
        summary: Filesystem has less than 5% space left.
      expr: |-
        (
          node_filesystem_avail_bytes{job="node-exporter",fstype!="",mountpoint!=""} / node_filesystem_size_bytes{job="node-exporter",fstype!="",mountpoint!=""} * 100 < 5
        and
          node_filesystem_readonly{job="node-exporter",fstype!="",mountpoint!=""} == 0
        )
      for: 30m
      labels:
        severity: warning
    - alert: NodeFilesystemAlmostOutOfSpace
      annotations:
        description: Filesystem on {{ $labels.device }}, mounted on {{ $labels.mountpoint }}, at {{ $labels.instance }} has only {{ printf "%.2f" $value }}% available space left.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/node/nodefilesystemalmostoutofspace
        summary: Filesystem has less than 3% space left.
      expr: |-
        (
          node_filesystem_avail_bytes{job="node-exporter",fstype!="",mountpoint!=""} / node_filesystem_size_bytes{job="node-exporter",fstype!="",mountpoint!=""} * 100 < 3
        and
          node_filesystem_readonly{job="node-exporter",fstype!="",mountpoint!=""} == 0
        )
      for: 30m
      labels:
        severity: critical
    - alert: NodeFilesystemFilesFillingUp
      annotations:
        description: Filesystem on {{ $labels.device }}, mounted on {{ $labels.mountpoint }}, at {{ $labels.instance }} has only {{ printf "%.2f" $value }}% available inodes left and is filling up.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/node/nodefilesystemfilesfillingup
        summary: Filesystem is predicted to run out of inodes within the next 24 hours.
      expr: |-
        (
          node_filesystem_files_free{job="node-exporter",fstype!="",mountpoint!=""} / node_filesystem_files{job="node-exporter",fstype!="",mountpoint!=""} * 100 < 40
        and
          predict_linear(node_filesystem_files_free{job="node-exporter",fstype!="",mountpoint!=""}[6h], 24*60*60) < 0
        and
          node_filesystem_readonly{job="node-exporter",fstype!="",mountpoint!=""} == 0
        )
      for: 1h
      labels:
        severity: warning
    - alert: NodeFilesystemFilesFillingUp
      annotations:
        description: Filesystem on {{ $labels.device }}, mounted on {{ $labels.mountpoint }}, at {{ $labels.instance }} has only {{ printf "%.2f" $value }}% available inodes left and is filling up fast.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/node/nodefilesystemfilesfillingup
        summary: Filesystem is predicted to run out of inodes within the next 4 hours.
      expr: |-
        (
          node_filesystem_files_free{job="node-exporter",fstype!="",mountpoint!=""} / node_filesystem_files{job="node-exporter",fstype!="",mountpoint!=""} * 100 < 20
        and
          predict_linear(node_filesystem_files_free{job="node-exporter",fstype!="",mountpoint!=""}[6h], 4*60*60) < 0
        and
          node_filesystem_readonly{job="node-exporter",fstype!="",mountpoint!=""} == 0
        )
      for: 1h
      labels:
        severity: critical
    - alert: NodeFilesystemAlmostOutOfFiles
      annotations:
        description: Filesystem on {{ $labels.device }}, mounted on {{ $labels.mountpoint }}, at {{ $labels.instance }} has only {{ printf "%.2f" $value }}% available inodes left.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/node/nodefilesystemalmostoutoffiles
        summary: Filesystem has less than 5% inodes left.
      expr: |-
        (
          node_filesystem_files_free{job="node-exporter",fstype!="",mountpoint!=""} / node_filesystem_files{job="node-exporter",fstype!="",mountpoint!=""} * 100 < 5
        and
          node_filesystem_readonly{job="node-exporter",fstype!="",mountpoint!=""} == 0
        )
      for: 1h
      labels:
        severity: warning
    - alert: NodeFilesystemAlmostOutOfFiles
      annotations:
        description: Filesystem on {{ $labels.device }}, mounted on {{ $labels.mountpoint }}, at {{ $labels.instance }} has only {{ printf "%.2f" $value }}% available inodes left.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/node/nodefilesystemalmostoutoffiles
        summary: Filesystem has less than 3% inodes left.
      expr: |-
        (
          node_filesystem_files_free{job="node-exporter",fstype!="",mountpoint!=""} / node_filesystem_files{job="node-exporter",fstype!="",mountpoint!=""} * 100 < 3
        and
          node_filesystem_readonly{job="node-exporter",fstype!="",mountpoint!=""} == 0
        )
      for: 1h
      labels:
        severity: critical
    - alert: NodeNetworkReceiveErrs
      annotations:
        description: '{{ $labels.instance }} interface {{ $labels.device }} has encountered {{ printf "%.0f" $value }} receive errors in the last two minutes.'
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/node/nodenetworkreceiveerrs
        summary: Network interface is reporting many receive errors.
      expr: rate(node_network_receive_errs_total{job="node-exporter"}[2m]) / rate(node_network_receive_packets_total{job="node-exporter"}[2m]) > 0.01
      for: 1h
      labels:
        severity: warning
    - alert: NodeNetworkTransmitErrs
      annotations:
        description: '{{ $labels.instance }} interface {{ $labels.device }} has encountered {{ printf "%.0f" $value }} transmit errors in the last two minutes.'
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/node/nodenetworktransmiterrs
        summary: Network interface is reporting many transmit errors.
      expr: rate(node_network_transmit_errs_total{job="node-exporter"}[2m]) / rate(node_network_transmit_packets_total{job="node-exporter"}[2m]) > 0.01
      for: 1h
      labels:
        severity: warning
    - alert: NodeHighNumberConntrackEntriesUsed
      annotations:
        description: '{{ $value | humanizePercentage }} of conntrack entries are used.'
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/node/nodehighnumberconntrackentriesused
        summary: Number of conntrack are getting close to the limit.
      expr: (node_nf_conntrack_entries{job="node-exporter"} / node_nf_conntrack_entries_limit) > 0.75
      labels:
        severity: warning
    - alert: NodeTextFileCollectorScrapeError
      annotations:
        description: Node Exporter text file collector on {{ $labels.instance }} failed to scrape.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/node/nodetextfilecollectorscrapeerror
        summary: Node Exporter text file collector failed to scrape.
      expr: node_textfile_scrape_error{job="node-exporter"} == 1
      labels:
        severity: warning
    - alert: NodeClockSkewDetected
      annotations:
        description: Clock at {{ $labels.instance }} is out of sync by more than 0.05s. Ensure NTP is configured correctly on this host.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/node/nodeclockskewdetected
        summary: Clock skew detected.
      expr: |-
        (
          node_timex_offset_seconds{job="node-exporter"} > 0.05
        and
          deriv(node_timex_offset_seconds{job="node-exporter"}[5m]) >= 0
        )
        or
        (
          node_timex_offset_seconds{job="node-exporter"} < -0.05
        and
          deriv(node_timex_offset_seconds{job="node-exporter"}[5m]) <= 0
        )
      for: 10m
      labels:
        severity: warning
    - alert: NodeClockNotSynchronising
      annotations:
        description: Clock at {{ $labels.instance }} is not synchronising. Ensure NTP is configured on this host.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/node/nodeclocknotsynchronising
        summary: Clock not synchronising.
      expr: |-
        min_over_time(node_timex_sync_status{job="node-exporter"}[5m]) == 0
        and
        node_timex_maxerror_seconds{job="node-exporter"} >= 16
      for: 10m
      labels:
        severity: warning
    - alert: NodeRAIDDegraded
      annotations:
        description: RAID array '{{ $labels.device }}' at {{ $labels.instance }} is in degraded state due to one or more disks failures. Number of spare drives is insufficient to fix issue automatically.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/node/noderaiddegraded
        summary: RAID Array is degraded.
      expr: node_md_disks_required{job="node-exporter",device=~"(/dev/)?(mmcblk.p.+|nvme.+|rbd.+|sd.+|vd.+|xvd.+|dm-.+|md.+|dasd.+)"} - ignoring (state) (node_md_disks{state="active",job="node-exporter",device=~"(/dev/)?(mmcblk.p.+|nvme.+|rbd.+|sd.+|vd.+|xvd.+|dm-.+|md.+|dasd.+)"}) > 0
      for: 15m
      labels:
        severity: critical
    - alert: NodeRAIDDiskFailure
      annotations:
        description: At least one device in RAID array at {{ $labels.instance }} failed. Array '{{ $labels.device }}' needs attention and possibly a disk swap.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/node/noderaiddiskfailure
        summary: Failed device in RAID array.
      expr: node_md_disks{state="failed",job="node-exporter",device=~"(/dev/)?(mmcblk.p.+|nvme.+|rbd.+|sd.+|vd.+|xvd.+|dm-.+|md.+|dasd.+)"} > 0
      labels:
        severity: warning
    - alert: NodeFileDescriptorLimit
      annotations:
        description: File descriptors limit at {{ $labels.instance }} is currently at {{ printf "%.2f" $value }}%.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/node/nodefiledescriptorlimit
        summary: Kernel is predicted to exhaust file descriptors limit soon.
      expr: |-
        (
          node_filefd_allocated{job="node-exporter"} * 100 / node_filefd_maximum{job="node-exporter"} > 70
        )
      for: 15m
      labels:
        severity: warning
    - alert: NodeFileDescriptorLimit
      annotations:
        description: File descriptors limit at {{ $labels.instance }} is currently at {{ printf "%.2f" $value }}%.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/node/nodefiledescriptorlimit
        summary: Kernel is predicted to exhaust file descriptors limit soon.
      expr: |-
        (
          node_filefd_allocated{job="node-exporter"} * 100 / node_filefd_maximum{job="node-exporter"} > 90
        )
      for: 15m
      labels:
        severity: critical
    - alert: NodeCPUHighUsage
      annotations:
        description: 'CPU usage at {{ $labels.instance }} has been above 90% for the last 15 minutes, is currently at {{ printf "%.2f" $value }}%.

          '
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/node/nodecpuhighusage
        summary: High CPU usage.
      expr: sum without(mode) (avg without (cpu) (rate(node_cpu_seconds_total{job="node-exporter", mode!="idle"}[2m]))) * 100 > 90
      for: 15m
      labels:
        severity: info
    - alert: NodeSystemSaturation
      annotations:
        description: 'System load per core at {{ $labels.instance }} has been above 2 for the last 15 minutes, is currently at {{ printf "%.2f" $value }}.

          This might indicate this instance resources saturation and can cause it becoming unresponsive.

          '
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/node/nodesystemsaturation
        summary: System saturated, load per core is very high.
      expr: |-
        node_load1{job="node-exporter"}
        / count without (cpu, mode) (node_cpu_seconds_total{job="node-exporter", mode="idle"}) > 2
      for: 15m
      labels:
        severity: warning
    - alert: NodeMemoryMajorPagesFaults
      annotations:
        description: 'Memory major pages are occurring at very high rate at {{ $labels.instance }}, 500 major page faults per second for the last 15 minutes, is currently at {{ printf "%.2f" $value }}.

          Please check that there is enough memory available at this instance.

          '
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/node/nodememorymajorpagesfaults
        summary: Memory major page faults are occurring at very high rate.
      expr: rate(node_vmstat_pgmajfault{job="node-exporter"}[5m]) > 500
      for: 15m
      labels:
        severity: warning
    - alert: NodeMemoryHighUtilization
      annotations:
        description: 'Memory is filling up at {{ $labels.instance }}, has been above 90% for the last 15 minutes, is currently at {{ printf "%.2f" $value }}%.

          '
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/node/nodememoryhighutilization
        summary: Host is running out of memory.
      expr: 100 - (node_memory_MemAvailable_bytes{job="node-exporter"} / node_memory_MemTotal_bytes{job="node-exporter"} * 100) > 90
      for: 15m
      labels:
        severity: warning
    - alert: NodeDiskIOSaturation
      annotations:
        description: 'Disk IO queue (aqu-sq) is high on {{ $labels.device }} at {{ $labels.instance }}, has been above 10 for the last 30 minutes, is currently at {{ printf "%.2f" $value }}.

          This symptom might indicate disk saturation.

          '
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/node/nodediskiosaturation
        summary: Disk IO queue is high.
      expr: rate(node_disk_io_time_weighted_seconds_total{job="node-exporter", device=~"(/dev/)?(mmcblk.p.+|nvme.+|rbd.+|sd.+|vd.+|xvd.+|dm-.+|md.+|dasd.+)"}[5m]) > 10
      for: 30m
      labels:
        severity: warning
    - alert: NodeSystemdServiceFailed
      annotations:
        description: Systemd service {{ $labels.name }} has entered failed state at {{ $labels.instance }}
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/node/nodesystemdservicefailed
        summary: Systemd service has entered failed state.
      expr: node_systemd_unit_state{job="node-exporter", state="failed"} == 1
      for: 5m
      labels:
        severity: warning
    - alert: NodeBondingDegraded
      annotations:
        description: Bonding interface {{ $labels.master }} on {{ $labels.instance }} is in degraded state due to one or more slave failures.
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/node/nodebondingdegraded
        summary: Bonding interface is degraded
      expr: (node_bonding_slaves - node_bonding_active) != 0
      for: 5m
      labels:
        severity: warning
---
# Source: victoria-metrics-k8s-stack/templates/rules/node-network.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-node-network
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: node-network
    rules:
    - alert: NodeNetworkInterfaceFlapping
      annotations:
        description: Network interface "{{ $labels.device }}" changing its up status often on node-exporter {{ $labels.namespace }}/{{ $labels.pod }}
        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/general/nodenetworkinterfaceflapping
        summary: Network interface is often changing its status
      expr: changes(node_network_up{job="node-exporter",device!~"veth.+"}[2m]) > 2
      for: 2m
      labels:
        severity: warning
---
# Source: victoria-metrics-k8s-stack/templates/rules/node.rules.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-node.rules
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: node.rules
    rules:
    - expr: |-
        topk by(cluster, namespace, pod) (1,
          max by (cluster, node, namespace, pod) (
            label_replace(kube_pod_info{job="kube-state-metrics",node!=""}, "pod", "$1", "pod", "(.*)")
        ))
      record: 'node_namespace_pod:kube_pod_info:'
    - expr: |-
        count by (cluster, node) (
          node_cpu_seconds_total{mode="idle",job="node-exporter"}
          * on (cluster, namespace, pod) group_left(node)
          topk by(cluster, namespace, pod) (1, node_namespace_pod:kube_pod_info:)
        )
      record: node:node_num_cpu:sum
    - expr: |-
        sum(
          node_memory_MemAvailable_bytes{job="node-exporter"} or
          (
            node_memory_Buffers_bytes{job="node-exporter"} +
            node_memory_Cached_bytes{job="node-exporter"} +
            node_memory_MemFree_bytes{job="node-exporter"} +
            node_memory_Slab_bytes{job="node-exporter"}
          )
        ) by (cluster)
      record: :node_memory_MemAvailable_bytes:sum
    - expr: |-
        avg by (cluster, node) (
          sum without (mode) (
            rate(node_cpu_seconds_total{mode!="idle",mode!="iowait",mode!="steal",job="node-exporter"}[5m])
          )
        )
      record: node:node_cpu_utilization:ratio_rate5m
    - expr: |-
        avg by (cluster) (
          node:node_cpu_utilization:ratio_rate5m
        )
      record: cluster:node_cpu:ratio_rate5m
---
# Source: victoria-metrics-k8s-stack/templates/rules/vm-health.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-vm-health
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: vm-health
    rules:
    - alert: TooManyRestarts
      annotations:
        description: 'Job {{ $labels.job }} (instance {{ $labels.instance }}) has restarted more than twice in the last 15 minutes. It might be crashlooping.

          '
        summary: '{{ $labels.job }} too many restarts (instance {{ $labels.instance }})'
      expr: changes(process_start_time_seconds{job=~".*(victoriametrics|vmselect|vminsert|vmstorage|vmagent|vmalert|vmsingle|vmalertmanager|vmauth).*"}[15m]) > 2
      labels:
        severity: critical
    - alert: ServiceDown
      annotations:
        description: '{{ $labels.instance }} of job {{ $labels.job }} has been down for more than 2 minutes.'
        summary: Service {{ $labels.job }} is down on {{ $labels.instance }}
      expr: up{job=~".*(victoriametrics|vmselect|vminsert|vmstorage|vmagent|vmalert|vmsingle|vmalertmanager|vmauth).*"} == 0
      for: 2m
      labels:
        severity: critical
    - alert: ProcessNearFDLimits
      annotations:
        description: 'Exhausting OS file descriptors limit can cause severe degradation of the process.

          Consider to increase the limit as fast as possible.

          '
        summary: Number of free file descriptors is less than 100 for "{{ $labels.job }}"("{{ $labels.instance }}") for the last 5m
      expr: (process_max_fds - process_open_fds) < 100
      for: 5m
      labels:
        severity: critical
    - alert: TooHighMemoryUsage
      annotations:
        description: 'Too high memory usage may result into multiple issues such as OOMs or degraded performance.

          Consider to either increase available memory or decrease the load on the process.

          '
        summary: It is more than 80% of memory used by "{{ $labels.job }}"("{{ $labels.instance }}")
      expr: (min_over_time(process_resident_memory_anon_bytes[10m]) / vm_available_memory_bytes) > 0.8
      for: 5m
      labels:
        severity: critical
    - alert: TooHighCPUUsage
      annotations:
        description: 'Too high CPU usage may be a sign of insufficient resources and make process unstable. Consider to either increase available CPU resources or decrease the load on the process.

          '
        summary: More than 90% of CPU is used by "{{ $labels.job }}"("{{ $labels.instance }}") during the last 5m
      expr: rate(process_cpu_seconds_total[5m]) / process_cpu_cores_available > 0.9
      for: 5m
      labels:
        severity: critical
    - alert: TooManyLogs
      annotations:
        description: 'Logging rate for job \"{{ $labels.job }}\" ({{ $labels.instance }}) is {{ $value }} for last 15m. Worth to check logs for specific error messages.

          '
        summary: Too many logs printed for job "{{ $labels.job }}" ({{ $labels.instance }})
      expr: sum(increase(vm_log_messages_total{level="error"}[5m])) without (app_version, location) > 0
      for: 15m
      labels:
        severity: warning
    - alert: TooManyTSIDMisses
      annotations:
        description: 'The rate of TSID misses during query lookups is too high for \"{{ $labels.job }}\" ({{ $labels.instance }}).

          Make sure you''re running VictoriaMetrics of v1.85.3 or higher.

          Related issue https://github.com/VictoriaMetrics/VictoriaMetrics/issues/3502

          '
        summary: Too many TSID misses for job "{{ $labels.job }}" ({{ $labels.instance }})
      expr: rate(vm_missing_tsids_for_metric_id_total[5m]) > 0
      for: 10m
      labels:
        severity: critical
    - alert: ConcurrentInsertsHitTheLimit
      annotations:
        description: "The limit of concurrent inserts on instance {{ $labels.instance }} depends on the number of CPUs.\nUsually, when component constantly hits the limit it is likely the component is overloaded and requires more CPU.\nIn some cases for components like vmagent or vminsert the alert might trigger if there are too many clients\nmaking write attempts. If vmagent's or vminsert's CPU usage and network saturation are at normal level, then \nit might be worth adjusting `-maxConcurrentInserts` cmd-line flag.\n"
        summary: '{{ $labels.job }} on instance {{ $labels.instance }} is constantly hitting concurrent inserts limit'
      expr: avg_over_time(vm_concurrent_insert_current[1m]) >= vm_concurrent_insert_capacity
      for: 15m
      labels:
        severity: warning
    - alert: IndexDBRecordsDrop
      annotations:
        description: "VictoriaMetrics could skip registering new timeseries during ingestion if they fail the validation process. \nFor example, `reason=too_long_item` means that time series cannot exceed 64KB. Please, reduce the number \nof labels or label values for such series. Or enforce these limits via `-maxLabelsPerTimeseries` and \n`-maxLabelValueLen` command-line flags.\n"
        summary: IndexDB skipped registering items during data ingestion with reason={{ $labels.reason }}.
      expr: increase(vm_indexdb_items_dropped_total[5m]) > 0
      labels:
        severity: critical
    - alert: TooLongLabelValues
      annotations:
        description: "The maximum length of a label value is limited via `-maxLabelValueLen` cmd-line flag. \nLonger label values are truncated and may result into time series overlapping.\nPlease, check your logs to find which labels were truncated and  \neither reduce the size of label values or increase `-maxLabelValueLen`.\n"
        summary: VictoriaMetrics truncates too long label values
      expr: increase(vm_too_long_label_values_total[5m]) > 0
      labels:
        severity: critical
    - alert: TooLongLabelNames
      annotations:
        description: The maximum length of a label name is limited by 256 bytes.  Longer label names are truncated and may result into time series overlapping.
        summary: VictoriaMetrics truncates too long label names
      expr: increase(vm_too_long_label_names_total[5m]) > 0
      labels:
        severity: critical
---
# Source: victoria-metrics-k8s-stack/templates/rules/vmagent.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-vmagent
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - concurrency: 2
    interval: 30s
    name: vmagent
    rules:
    - alert: PersistentQueueIsDroppingData
      annotations:
        dashboard: grafana.domain.com/d/G7Z9GzMGz?viewPanel=49&var-instance={{ $labels.instance }}
        description: Vmagent dropped {{ $value | humanize1024 }} from persistent queue on instance {{ $labels.instance }} for the last 10m.
        summary: Instance {{ $labels.instance }} is dropping data from persistent queue
      expr: sum(increase(vm_persistentqueue_bytes_dropped_total[5m])) without (path) > 0
      for: 10m
      labels:
        severity: critical
    - alert: RejectedRemoteWriteDataBlocksAreDropped
      annotations:
        dashboard: grafana.domain.com/d/G7Z9GzMGz?viewPanel=79&var-instance={{ $labels.instance }}
        summary: Job "{{ $labels.job }}" on instance {{ $labels.instance }} drops the rejected by remote-write server data blocks. Check the logs to find the reason for rejects.
      expr: sum(increase(vmagent_remotewrite_packets_dropped_total[5m])) without (url) > 0
      for: 15m
      labels:
        severity: warning
    - alert: TooManyScrapeErrors
      annotations:
        dashboard: grafana.domain.com/d/G7Z9GzMGz?viewPanel=31&var-instance={{ $labels.instance }}
        summary: Job "{{ $labels.job }}" on instance {{ $labels.instance }} fails to scrape targets for last 15m
      expr: increase(vm_promscrape_scrapes_failed_total[5m]) > 0
      for: 15m
      labels:
        severity: warning
    - alert: TooManyWriteErrors
      annotations:
        dashboard: grafana.domain.com/d/G7Z9GzMGz?viewPanel=77&var-instance={{ $labels.instance }}
        summary: Job "{{ $labels.job }}" on instance {{ $labels.instance }} responds with errors to write requests for last 15m.
      expr: |-
        (sum(increase(vm_ingestserver_request_errors_total[5m])) without (name,net,type)
        +
        sum(increase(vmagent_http_request_errors_total[5m])) without (path,protocol)) > 0
      for: 15m
      labels:
        severity: warning
    - alert: TooManyRemoteWriteErrors
      annotations:
        dashboard: grafana.domain.com/d/G7Z9GzMGz?viewPanel=61&var-instance={{ $labels.instance }}
        description: "Vmagent fails to push data via remote write protocol to destination \"{{ $labels.url }}\"\n Ensure that destination is up and reachable."
        summary: Job "{{ $labels.job }}" on instance {{ $labels.instance }} fails to push to remote storage
      expr: rate(vmagent_remotewrite_retries_count_total[5m]) > 0
      for: 15m
      labels:
        severity: warning
    - alert: RemoteWriteConnectionIsSaturated
      annotations:
        dashboard: grafana.domain.com/d/G7Z9GzMGz?viewPanel=84&var-instance={{ $labels.instance }}
        description: "The remote write connection between vmagent \"{{ $labels.job }}\" (instance {{ $labels.instance }}) and destination \"{{ $labels.url }}\" is saturated by more than 90% and vmagent won't be able to keep up.\n This usually means that `-remoteWrite.queues` command-line flag must be increased in order to increase the number of connections per each remote storage."
        summary: Remote write connection from "{{ $labels.job }}" (instance {{ $labels.instance }}) to {{ $labels.url }} is saturated
      expr: "(\n rate(vmagent_remotewrite_send_duration_seconds_total[5m])\n / \n vmagent_remotewrite_queues\n) > 0.9"
      for: 15m
      labels:
        severity: warning
    - alert: PersistentQueueForWritesIsSaturated
      annotations:
        dashboard: grafana.domain.com/d/G7Z9GzMGz?viewPanel=98&var-instance={{ $labels.instance }}
        description: Persistent queue writes for vmagent "{{ $labels.job }}" (instance {{ $labels.instance }}) are saturated by more than 90% and vmagent won't be able to keep up with flushing data on disk. In this case, consider to decrease load on the vmagent or improve the disk throughput.
        summary: Persistent queue writes for instance {{ $labels.instance }} are saturated
      expr: rate(vm_persistentqueue_write_duration_seconds_total[5m]) > 0.9
      for: 15m
      labels:
        severity: warning
    - alert: PersistentQueueForReadsIsSaturated
      annotations:
        dashboard: grafana.domain.com/d/G7Z9GzMGz?viewPanel=99&var-instance={{ $labels.instance }}
        description: Persistent queue reads for vmagent "{{ $labels.job }}" (instance {{ $labels.instance }}) are saturated by more than 90% and vmagent won't be able to keep up with reading data from the disk. In this case, consider to decrease load on the vmagent or improve the disk throughput.
        summary: Persistent queue reads for instance {{ $labels.instance }} are saturated
      expr: rate(vm_persistentqueue_read_duration_seconds_total[5m]) > 0.9
      for: 15m
      labels:
        severity: warning
    - alert: SeriesLimitHourReached
      annotations:
        dashboard: grafana.domain.com/d/G7Z9GzMGz?viewPanel=88&var-instance={{ $labels.instance }}
        description: Max series limit set via -remoteWrite.maxHourlySeries flag is close to reaching the max value. Then samples for new time series will be dropped instead of sending them to remote storage systems.
        summary: Instance {{ $labels.instance }} reached 90% of the limit
      expr: (vmagent_hourly_series_limit_current_series / vmagent_hourly_series_limit_max_series) > 0.9
      labels:
        severity: critical
    - alert: SeriesLimitDayReached
      annotations:
        dashboard: grafana.domain.com/d/G7Z9GzMGz?viewPanel=90&var-instance={{ $labels.instance }}
        description: Max series limit set via -remoteWrite.maxDailySeries flag is close to reaching the max value. Then samples for new time series will be dropped instead of sending them to remote storage systems.
        summary: Instance {{ $labels.instance }} reached 90% of the limit
      expr: (vmagent_daily_series_limit_current_series / vmagent_daily_series_limit_max_series) > 0.9
      labels:
        severity: critical
    - alert: ConfigurationReloadFailure
      annotations:
        description: Configuration hot-reload failed for vmagent on instance {{ $labels.instance }}. Check vmagent's logs for detailed error message.
        summary: Configuration reload failed for vmagent instance {{ $labels.instance }}
      expr: |-
        vm_promscrape_config_last_reload_successful != 1
        or
        vmagent_relabel_config_last_reload_successful != 1
      labels:
        severity: warning
    - alert: StreamAggrFlushTimeout
      annotations:
        description: 'Stream aggregation process can''t keep up with the load and might produce incorrect aggregation results. Check logs for more details. Possible solutions: increase aggregation interval; aggregate smaller number of series; reduce samples'' ingestion rate to stream aggregation.'
        summary: Streaming aggregation at "{{ $labels.job }}" (instance {{ $labels.instance }}) can't be finished within the configured aggregation interval.
      expr: increase(vm_streamaggr_flush_timeouts_total[5m]) > 0
      labels:
        severity: warning
    - alert: StreamAggrDedupFlushTimeout
      annotations:
        description: 'Deduplication process can''t keep up with the load and might produce incorrect results. Check docs https://docs.victoriametrics.com/stream-aggregation/#deduplication and logs for more details. Possible solutions: increase deduplication interval; deduplicate smaller number of series; reduce samples'' ingestion rate.'
        summary: Deduplication "{{ $labels.job }}" (instance {{ $labels.instance }}) can't be finished within configured deduplication interval.
      expr: increase(vm_streamaggr_dedup_flush_timeouts_total[5m]) > 0
      labels:
        severity: warning
---
# Source: victoria-metrics-k8s-stack/templates/rules/vmcluster.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-vmcluster
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - concurrency: 2
    interval: 30s
    name: vmcluster
    rules:
    - alert: DiskRunsOutOfSpaceIn3Days
      annotations:
        dashboard: grafana.domain.com/d/oS7Bi_0Wz?viewPanel=113&var-instance={{ $labels.instance }}
        description: "Taking into account current ingestion rate, free disk space will be enough only for {{ $value | humanizeDuration }} on instance {{ $labels.instance }}.\n Consider to limit the ingestion rate, decrease retention or scale the disk space up if possible."
        summary: Instance {{ $labels.instance }} will run out of disk space in 3 days
      expr: |-
        vm_free_disk_space_bytes / ignoring(path)
        (
          rate(vm_rows_added_to_storage_total[1d])
          * scalar(
            sum(vm_data_size_bytes{type!~"indexdb.*"}) /
            sum(vm_rows{type!~"indexdb.*"})
           )
        ) < 3 * 24 * 3600 > 0
      for: 30m
      labels:
        severity: critical
    - alert: DiskRunsOutOfSpace
      annotations:
        dashboard: grafana.domain.com/d/oS7Bi_0Wz?viewPanel=200&var-instance={{ $labels.instance }}"
        description: "Disk utilisation on instance {{ $labels.instance }} is more than 80%.\n Having less than 20% of free disk space could cripple merges processes and overall performance. Consider to limit the ingestion rate, decrease retention or scale the disk space if possible."
        summary: Instance {{ $labels.instance }} (job={{ $labels.job }}) will run out of disk space soon
      expr: |-
        sum(vm_data_size_bytes) by(job, instance) /
        (
         sum(vm_free_disk_space_bytes) by(job, instance) +
         sum(vm_data_size_bytes) by(job, instance)
        ) > 0.8
      for: 30m
      labels:
        severity: critical
    - alert: RequestErrorsToAPI
      annotations:
        dashboard: grafana.domain.com/d/oS7Bi_0Wz?viewPanel=52&var-instance={{ $labels.instance }}
        description: Requests to path {{ $labels.path }} are receiving errors. Please verify if clients are sending correct requests.
        summary: Too many errors served for {{ $labels.job }} path {{ $labels.path }} (instance {{ $labels.instance }})
      expr: increase(vm_http_request_errors_total[5m]) > 0
      for: 15m
      labels:
        severity: warning
        show_at: dashboard
    - alert: RPCErrors
      annotations:
        dashboard: grafana.domain.com/d/oS7Bi_0Wz?viewPanel=44&var-instance={{ $labels.instance }}
        description: "RPC errors are interconnection errors between cluster components.\n Possible reasons for errors are misconfiguration, overload, network blips or unreachable components."
        summary: Too many RPC errors for {{ $labels.job }} (instance {{ $labels.instance }})
      expr: |-
        (
         sum(increase(vm_rpc_connection_errors_total[5m])) by(job, instance)
         +
         sum(increase(vm_rpc_dial_errors_total[5m])) by(job, instance)
         +
         sum(increase(vm_rpc_handshake_errors_total[5m])) by(job, instance)
        ) > 0
      for: 15m
      labels:
        severity: warning
        show_at: dashboard
    - alert: RowsRejectedOnIngestion
      annotations:
        dashboard: grafana.domain.com/d/oS7Bi_0Wz?viewPanel=135&var-instance={{ $labels.instance }}
        description: 'VM is rejecting to ingest rows on "{{ $labels.instance }}" due to the following reason: "{{ $labels.reason }}"'
        summary: Some rows are rejected on "{{ $labels.instance }}" on ingestion attempt
      expr: rate(vm_rows_ignored_total[5m]) > 0
      for: 15m
      labels:
        severity: warning
    - alert: TooHighChurnRate
      annotations:
        dashboard: grafana.domain.com/d/oS7Bi_0Wz?viewPanel=102
        description: "VM constantly creates new time series.\n This effect is known as Churn Rate.\n High Churn Rate tightly connected with database performance and may result in unexpected OOM's or slow queries."
        summary: Churn rate is more than 10% for the last 15m
      expr: |-
        (
           sum(rate(vm_new_timeseries_created_total[5m]))
           /
           sum(rate(vm_rows_inserted_total[5m]))
         ) > 0.1
      for: 15m
      labels:
        severity: warning
    - alert: TooHighChurnRate24h
      annotations:
        dashboard: grafana.domain.com/d/oS7Bi_0Wz?viewPanel=102
        description: "The number of created new time series over last 24h is 3x times higher than current number of active series.\n This effect is known as Churn Rate.\n High Churn Rate tightly connected with database performance and may result in unexpected OOM's or slow queries."
        summary: Too high number of new series created over last 24h
      expr: |-
        sum(increase(vm_new_timeseries_created_total[24h]))
        >
        (sum(vm_cache_entries{type="storage/hour_metric_ids"}) * 3)
      for: 15m
      labels:
        severity: warning
    - alert: TooHighSlowInsertsRate
      annotations:
        dashboard: grafana.domain.com/d/oS7Bi_0Wz?viewPanel=108
        description: High rate of slow inserts may be a sign of resource exhaustion for the current load. It is likely more RAM is needed for optimal handling of the current number of active time series. See also https://github.com/VictoriaMetrics/VictoriaMetrics/issues/3976#issuecomment-1476883183
        summary: Percentage of slow inserts is more than 5% for the last 15m
      expr: |-
        (
           sum(rate(vm_slow_row_inserts_total[5m]))
           /
           sum(rate(vm_rows_inserted_total[5m]))
         ) > 0.05
      for: 15m
      labels:
        severity: warning
    - alert: LabelsLimitExceededOnIngestion
      annotations:
        dashboard: grafana.domain.com/d/oS7Bi_0Wz?viewPanel=116&var-instance={{ $labels.instance }}
        description: "VictoriaMetrics limits the number of labels per each metric with `-maxLabelsPerTimeseries` command-line flag.\n This prevents from ingesting metrics with too many labels. Please verify that `-maxLabelsPerTimeseries` is configured correctly or that clients which send these metrics aren't misbehaving."
        summary: Metrics ingested to vminsert on {{ $labels.instance }} are exceeding labels limit
      expr: increase(vm_metrics_with_dropped_labels_total[5m]) > 0
      for: 15m
      labels:
        severity: warning
    - alert: VminsertVmstorageConnectionIsSaturated
      annotations:
        dashboard: grafana.domain.com/d/oS7Bi_0Wz?viewPanel=139&var-instance={{ $labels.instance }}
        description: "The connection between vminsert (instance {{ $labels.instance }}) and vmstorage (instance {{ $labels.addr }}) is saturated by more than 90% and vminsert won't be able to keep up.\n This usually means that more vminsert or vmstorage nodes must be added to the cluster in order to increase the total number of vminsert -> vmstorage links."
        summary: Connection between vminsert on {{ $labels.instance }} and vmstorage on {{ $labels.addr }} is saturated
      expr: rate(vm_rpc_send_duration_seconds_total[5m]) > 0.9
      for: 15m
      labels:
        severity: warning
        show_at: dashboard
---
# Source: victoria-metrics-k8s-stack/templates/rules/vmsingle.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  namespace: default
  name: my-release-victoria-metrics-k8s-stack-vmsingle
  labels:
    app: victoria-metrics-k8s-stack
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - concurrency: 2
    interval: 30s
    name: vmsingle
    rules:
    - alert: DiskRunsOutOfSpaceIn3Days
      annotations:
        dashboard: grafana.domain.com/d/wNf0q_kZk?viewPanel=73&var-instance={{ $labels.instance }}
        description: "Taking into account current ingestion rate, free disk space will be enough only for {{ $value | humanizeDuration }} on instance {{ $labels.instance }}.\n Consider to limit the ingestion rate, decrease retention or scale the disk space if possible."
        summary: Instance {{ $labels.instance }} will run out of disk space soon
      expr: |-
        vm_free_disk_space_bytes / ignoring(path)
        (
          rate(vm_rows_added_to_storage_total[1d])
          * scalar(
            sum(vm_data_size_bytes{type!~"indexdb.*"}) /
            sum(vm_rows{type!~"indexdb.*"})
           )
        ) < 3 * 24 * 3600 > 0
      for: 30m
      labels:
        severity: critical
    - alert: DiskRunsOutOfSpace
      annotations:
        dashboard: grafana.domain.com/d/wNf0q_kZk?viewPanel=53&var-instance={{ $labels.instance }}
        description: "Disk utilisation on instance {{ $labels.instance }} is more than 80%.\n Having less than 20% of free disk space could cripple merge processes and overall performance. Consider to limit the ingestion rate, decrease retention or scale the disk space if possible."
        summary: Instance {{ $labels.instance }} (job={{ $labels.job }}) will run out of disk space soon
      expr: |-
        sum(vm_data_size_bytes) by(job, instance) /
        (
         sum(vm_free_disk_space_bytes) by(job, instance) +
         sum(vm_data_size_bytes) by(job, instance)
        ) > 0.8
      for: 30m
      labels:
        severity: critical
    - alert: RequestErrorsToAPI
      annotations:
        dashboard: grafana.domain.com/d/wNf0q_kZk?viewPanel=35&var-instance={{ $labels.instance }}
        description: Requests to path {{ $labels.path }} are receiving errors. Please verify if clients are sending correct requests.
        summary: Too many errors served for path {{ $labels.path }} (instance {{ $labels.instance }})
      expr: increase(vm_http_request_errors_total[5m]) > 0
      for: 15m
      labels:
        severity: warning
    - alert: RowsRejectedOnIngestion
      annotations:
        dashboard: grafana.domain.com/d/wNf0q_kZk?viewPanel=58&var-instance={{ $labels.instance }}
        description: 'VM is rejecting to ingest rows on "{{ $labels.instance }}" due to the following reason: "{{ $labels.reason }}"'
        summary: Some rows are rejected on "{{ $labels.instance }}" on ingestion attempt
      expr: rate(vm_rows_ignored_total[5m]) > 0
      for: 15m
      labels:
        severity: warning
    - alert: TooHighChurnRate
      annotations:
        dashboard: grafana.domain.com/d/wNf0q_kZk?viewPanel=66&var-instance={{ $labels.instance }}
        description: "VM constantly creates new time series on \"{{ $labels.instance }}\".\n This effect is known as Churn Rate.\n High Churn Rate tightly connected with database performance and may result in unexpected OOM's or slow queries."
        summary: Churn rate is more than 10% on "{{ $labels.instance }}" for the last 15m
      expr: |-
        (
           sum(rate(vm_new_timeseries_created_total[5m])) by(instance)
           /
           sum(rate(vm_rows_inserted_total[5m])) by (instance)
         ) > 0.1
      for: 15m
      labels:
        severity: warning
    - alert: TooHighChurnRate24h
      annotations:
        dashboard: grafana.domain.com/d/wNf0q_kZk?viewPanel=66&var-instance={{ $labels.instance }}
        description: "The number of created new time series over last 24h is 3x times higher than current number of active series on \"{{ $labels.instance }}\".\n This effect is known as Churn Rate.\n High Churn Rate tightly connected with database performance and may result in unexpected OOM's or slow queries."
        summary: Too high number of new series on "{{ $labels.instance }}" created over last 24h
      expr: |-
        sum(increase(vm_new_timeseries_created_total[24h])) by(instance)
        >
        (sum(vm_cache_entries{type="storage/hour_metric_ids"}) by(instance) * 3)
      for: 15m
      labels:
        severity: warning
    - alert: TooHighSlowInsertsRate
      annotations:
        dashboard: grafana.domain.com/d/wNf0q_kZk?viewPanel=68&var-instance={{ $labels.instance }}
        description: High rate of slow inserts on "{{ $labels.instance }}" may be a sign of resource exhaustion for the current load. It is likely more RAM is needed for optimal handling of the current number of active time series. See also https://github.com/VictoriaMetrics/VictoriaMetrics/issues/3976#issuecomment-1476883183
        summary: Percentage of slow inserts is more than 5% on "{{ $labels.instance }}" for the last 15m
      expr: |-
        (
           sum(rate(vm_slow_row_inserts_total[5m])) by(instance)
           /
           sum(rate(vm_rows_inserted_total[5m])) by (instance)
         ) > 0.05
      for: 15m
      labels:
        severity: warning
    - alert: LabelsLimitExceededOnIngestion
      annotations:
        dashboard: grafana.domain.com/d/wNf0q_kZk?viewPanel=74&var-instance={{ $labels.instance }}
        description: "VictoriaMetrics limits the number of labels per each metric with `-maxLabelsPerTimeseries` command-line flag.\n This prevents ingestion of metrics with too many labels. Please verify that `-maxLabelsPerTimeseries` is configured correctly or that clients which send these metrics aren't misbehaving."
        summary: Metrics ingested in ({{ $labels.instance }}) are exceeding labels limit
      expr: increase(vm_metrics_with_dropped_labels_total[5m]) > 0
      for: 15m
      labels:
        severity: warning
---
# Source: victoria-metrics-k8s-stack/templates/servicemonitors/apiserver.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMServiceScrape
metadata:
  name: my-release-victoria-metrics-k8s-stack-apiserver
  namespace: default
  labels: 
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec: 
  endpoints:
  - bearerTokenFile: /var/run/secrets/kubernetes.io/serviceaccount/token
    port: https
    scheme: https
    tlsConfig:
      caFile: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
      serverName: kubernetes
  jobLabel: component
  namespaceSelector:
    matchNames:
    - default
  selector:
    matchLabels:
      component: apiserver
      provider: kubernetes
---
# Source: victoria-metrics-k8s-stack/templates/servicemonitors/coredns.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMServiceScrape
metadata:
  name: my-release-victoria-metrics-k8s-stack-coredns
  namespace: default
  labels: 
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  selector:
    matchLabels:
      app: my-release-victoria-metrics-k8s-stack-coredns
      app.kubernetes.io/instance: "my-release"
  namespaceSelector:
    matchNames:
      - "kube-system"
  endpoints:
  - bearerTokenFile: /var/run/secrets/kubernetes.io/serviceaccount/token
    port: http-metrics
  jobLabel: jobLabel
---
# Source: victoria-metrics-k8s-stack/templates/servicemonitors/grafana.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMServiceScrape
metadata:
  name: my-release-victoria-metrics-k8s-stack-grafana
  namespace: default
  labels: 
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  selector:
    matchLabels:
      app.kubernetes.io/name: grafana
      app.kubernetes.io/instance: "my-release"
  endpoints:
  - port: service
---
# Source: victoria-metrics-k8s-stack/templates/servicemonitors/kube-controller-manager.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMServiceScrape
metadata:
  name: my-release-victoria-metrics-k8s-stack-kube-controller-manager
  namespace: default
  labels: 
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  selector:
    matchLabels:
      app: my-release-victoria-metrics-k8s-stack-kube-controller-manager
      app.kubernetes.io/instance: "my-release"
  namespaceSelector:
    matchNames:
      - "kube-system"
  endpoints:
  - bearerTokenFile: /var/run/secrets/kubernetes.io/serviceaccount/token
    port: http-metrics
    scheme: https
    tlsConfig:
      caFile: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
      serverName: kubernetes
  jobLabel: jobLabel
---
# Source: victoria-metrics-k8s-stack/templates/servicemonitors/kube-etcd.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMServiceScrape
metadata:
  name: my-release-victoria-metrics-k8s-stack-kube-etcd
  namespace: default
  labels: 
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  selector:
    matchLabels:
      app: my-release-victoria-metrics-k8s-stack-kube-etcd
      app.kubernetes.io/instance: "my-release"
  namespaceSelector:
    matchNames:
      - "kube-system"
  endpoints:
  - bearerTokenFile: /var/run/secrets/kubernetes.io/serviceaccount/token
    port: http-metrics
    scheme: https
    tlsConfig:
      caFile: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
  jobLabel: jobLabel
---
# Source: victoria-metrics-k8s-stack/templates/servicemonitors/kube-scheduler.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMServiceScrape
metadata:
  name: my-release-victoria-metrics-k8s-stack-kube-scheduler
  namespace: default
  labels: 
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  selector:
    matchLabels:
      app: my-release-victoria-metrics-k8s-stack-kube-scheduler
      app.kubernetes.io/instance: "my-release"
  namespaceSelector:
    matchNames:
      - "kube-system"
  endpoints:
  - bearerTokenFile: /var/run/secrets/kubernetes.io/serviceaccount/token
    port: http-metrics
    scheme: https
    tlsConfig:
      caFile: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
  jobLabel: jobLabel
---
# Source: victoria-metrics-k8s-stack/templates/servicemonitors/kube-state-metrics.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMServiceScrape
metadata:
  name: my-release-victoria-metrics-k8s-stack-kube-state-metrics
  namespace: default
  labels: 
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  selector:
    matchLabels:
      app.kubernetes.io/name: kube-state-metrics
      app.kubernetes.io/instance: "my-release"
  endpoints:
  - port: http
    honorLabels: true
    metricRelabelConfigs:
      - action: labeldrop
        regex: (uid|container_id|image_id)
  jobLabel: app.kubernetes.io/name
---
# Source: victoria-metrics-k8s-stack/templates/servicemonitors/nodeexporter.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMServiceScrape
metadata:
  name: my-release-victoria-metrics-k8s-stack-node-exporter
  namespace: default
  labels: 
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  selector:
    matchLabels:
      app.kubernetes.io/name: prometheus-node-exporter
  endpoints:
  - metricRelabelConfigs:
    - action: drop
      regex: /var/lib/kubelet/pods.+
      source_labels:
      - mountpoint
    port: metrics
  jobLabel: jobLabel
---
# Source: victoria-metrics-k8s-stack/templates/victoria-metrics-operator/servicescrape.yaml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMServiceScrape
metadata:
  name: my-release-victoria-metrics-k8s-stack-operator
  namespace: default
  labels: 
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:
  selector:
    matchLabels:
      app.kubernetes.io/instance: "my-release"
      app.kubernetes.io/name: victoria-metrics-operator
  endpoints:
    - port: http
  namespaceSelector:
    matchNames:
      - default
---
# Source: victoria-metrics-k8s-stack/templates/victoria-metrics-operator/vmsingle/vmsingle.yml
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMSingle
metadata:
  name: my-release-victoria-metrics-k8s-stack
  namespace: default
  labels: 
    helm.sh/chart: victoria-metrics-k8s-stack-0.23.2
    app.kubernetes.io/name: victoria-metrics-k8s-stack
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "v1.101.0"
    app.kubernetes.io/managed-by: Helm
spec:

  
  extraArgs:
    vmalert.proxyURL: http://vmalert-my-release-victoria-metrics-k8s-stack.default.svc:8080
  image:
    tag: v1.101.0
  replicaCount: 1
  retentionPeriod: "1"
  storage:
    accessModes:
    - ReadWriteOnce
    resources:
      requests:
        storage: 20Gi
---
# Source: victoria-metrics-k8s-stack/charts/grafana/templates/tests/test-serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    helm.sh/chart: grafana-7.3.12
    app.kubernetes.io/name: grafana
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "10.4.3"
    app.kubernetes.io/managed-by: Helm
  name: my-release-grafana-test
  namespace: default
  annotations:
    "helm.sh/hook": test-success
    "helm.sh/hook-delete-policy": "before-hook-creation,hook-succeeded"
---
# Source: victoria-metrics-k8s-stack/charts/victoria-metrics-operator/templates/uninstall_hook.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: my-release-victoria-metrics-operator-cleanup-hook
  namespace: default
  labels:
    app.kubernetes.io/name: victoria-metrics-operator
    app.kubernetes.io/instance: my-release
    helm.sh/chart: victoria-metrics-operator-0.32.0
    app.kubernetes.io/managed-by: Helm
  annotations: 
    "helm.sh/hook": pre-delete
    "helm.sh/hook-weight": "-5"
    "helm.sh/hook-delete-policy": hook-succeeded
---
# Source: victoria-metrics-k8s-stack/charts/grafana/templates/tests/test-configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: my-release-grafana-test
  namespace: default
  annotations:
    "helm.sh/hook": test-success
    "helm.sh/hook-delete-policy": "before-hook-creation,hook-succeeded"
  labels:
    helm.sh/chart: grafana-7.3.12
    app.kubernetes.io/name: grafana
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "10.4.3"
    app.kubernetes.io/managed-by: Helm
data:
  run.sh: |-
    @test "Test Health" {
      url="http://my-release-grafana/api/health"

      code=$(wget --server-response --spider --timeout 90 --tries 10 ${url} 2>&1 | awk '/^  HTTP/{print $2}')
      [ "$code" == "200" ]
    }
---
# Source: victoria-metrics-k8s-stack/charts/victoria-metrics-operator/templates/uninstall_hook.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: my-release-victoria-metrics-operator-cleanup-hook
  namespace: default
  labels:
    app.kubernetes.io/name: victoria-metrics-operator
    app.kubernetes.io/instance: my-release
    helm.sh/chart: victoria-metrics-operator-0.32.0
    app.kubernetes.io/managed-by: Helm
  annotations: 
    "helm.sh/hook": pre-delete
    "helm.sh/hook-weight": "-5"
    "helm.sh/hook-delete-policy": hook-succeeded
rules:
  - apiGroups: ["operator.victoriametrics.com"]
    resources:
      - vmagents
      - vmalertmanagers
      - vmalerts
      - vmauths
      - vmclusters
      - vmsingles
    verbs: ["get", "list", "watch","delete"]
---
# Source: victoria-metrics-k8s-stack/charts/victoria-metrics-operator/templates/uninstall_hook.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: my-release-victoria-metrics-operator-cleanup-hook
  namespace: default
  labels:
    app.kubernetes.io/name: victoria-metrics-operator
    app.kubernetes.io/instance: my-release
    helm.sh/chart: victoria-metrics-operator-0.32.0
    app.kubernetes.io/managed-by: Helm
  annotations: 
    "helm.sh/hook": pre-delete
    "helm.sh/hook-weight": "-5"
    "helm.sh/hook-delete-policy": hook-succeeded
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: my-release-victoria-metrics-operator-cleanup-hook
subjects:
  - kind: ServiceAccount
    name: my-release-victoria-metrics-operator-cleanup-hook
    namespace: default
---
# Source: victoria-metrics-k8s-stack/charts/grafana/templates/tests/test.yaml
apiVersion: v1
kind: Pod
metadata:
  name: my-release-grafana-test
  labels:
    helm.sh/chart: grafana-7.3.12
    app.kubernetes.io/name: grafana
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "10.4.3"
    app.kubernetes.io/managed-by: Helm
  annotations:
    "helm.sh/hook": test-success
    "helm.sh/hook-delete-policy": "before-hook-creation,hook-succeeded"
  namespace: default
spec:
  serviceAccountName: my-release-grafana-test
  containers:
    - name: my-release-test
      image: "docker.io/bats/bats:v1.4.1"
      imagePullPolicy: "IfNotPresent"
      command: ["/opt/bats/bin/bats", "-t", "/tests/run.sh"]
      volumeMounts:
        - mountPath: /tests
          name: tests
          readOnly: true
  volumes:
    - name: tests
      configMap:
        name: my-release-grafana-test
  restartPolicy: Never
---
# Source: victoria-metrics-k8s-stack/charts/victoria-metrics-operator/templates/uninstall_hook.yaml
apiVersion: batch/v1
kind: Job
metadata:
  name: my-release-victoria-metrics-operator-cleanup-hook
  namespace: default
  labels: 
    app.kubernetes.io/name: victoria-metrics-operator
    app.kubernetes.io/instance: my-release
    helm.sh/chart: victoria-metrics-operator-0.32.0
    app.kubernetes.io/managed-by: Helm
  annotations: 
    "helm.sh/hook": pre-delete
    "helm.sh/hook-weight": "-5"
    "helm.sh/hook-delete-policy": hook-succeeded
spec:
  template:
    metadata:
      name: "my-release"
      labels: 
        app.kubernetes.io/name: victoria-metrics-operator
        app.kubernetes.io/instance: my-release
        helm.sh/chart: victoria-metrics-operator-0.32.0
        app.kubernetes.io/managed-by: Helm
    spec:
      serviceAccountName: my-release-victoria-metrics-operator-cleanup-hook
      containers:
        - name: kubectl
          image: "gcr.io/google_containers/hyperkube:v1.18.0"
          imagePullPolicy: "IfNotPresent"
          resources:
            limits:
              cpu: "500m"
              memory: "256Mi"
            requests:
              cpu: "100m"
              memory: "56Mi"
          command:
            - /bin/sh
            - -c
            - >
              kubectl delete vmagents --all --ignore-not-found=true;
              kubectl delete vmalertmanagers --all --ignore-not-found=true;
              kubectl delete vmalerts --all --ignore-not-found=true;
              kubectl delete vmauths --all --ignore-not-found=true;
              kubectl delete vmclusters --all --ignore-not-found=true;
              kubectl delete vmsingles --all --ignore-not-found=true;
      restartPolicy: OnFailure
