---
# Source: cloudhealth-collector/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: my-release-cloudhealth-collector
  labels:
    helm.sh/chart: cloudhealth-collector-0.1.6
    app.kubernetes.io/name: cloudhealth-collector
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "957"
    app.kubernetes.io/managed-by: Helm
automountServiceAccountToken: true
---
# Source: cloudhealth-collector/templates/secret.yaml
apiVersion: v1
kind: Secret
metadata:
  name: my-release-cloudhealth-collector
  labels:
    helm.sh/chart: cloudhealth-collector-0.1.6
    app.kubernetes.io/name: cloudhealth-collector
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "957"
    app.kubernetes.io/managed-by: Helm
type: Opaque
data:
  api_token: "PGNoYW5nZS1tZT4="
---
# Source: cloudhealth-collector/templates/clusterrole.yaml
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: my-release-cloudhealth-collector
  labels:
    helm.sh/chart: cloudhealth-collector-0.1.6
    app.kubernetes.io/name: cloudhealth-collector
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "957"
    app.kubernetes.io/managed-by: Helm
rules:
- apiGroups: [""]
  resources: ["services", "nodes", "pods"]
  verbs: ["get", "list", "watch"]
---
# Source: cloudhealth-collector/templates/clusterrolebinding.yaml
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: my-release-cloudhealth-collector
  labels:
    helm.sh/chart: cloudhealth-collector-0.1.6
    app.kubernetes.io/name: cloudhealth-collector
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "957"
    app.kubernetes.io/managed-by: Helm
subjects:
- kind: ServiceAccount
  name: my-release-cloudhealth-collector
  namespace: default
roleRef:
  kind: ClusterRole
  name: my-release-cloudhealth-collector
  apiGroup: rbac.authorization.k8s.io
---
# Source: cloudhealth-collector/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-release-cloudhealth-collector
  labels:
    helm.sh/chart: cloudhealth-collector-0.1.6
    app.kubernetes.io/name: cloudhealth-collector
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "957"
    app.kubernetes.io/managed-by: Helm

spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: cloudhealth-collector
      app.kubernetes.io/instance: my-release
  template:
    metadata:
      labels:
        app.kubernetes.io/name: cloudhealth-collector
        app.kubernetes.io/instance: my-release
    spec:
      serviceAccountName: my-release-cloudhealth-collector
      securityContext:
        {}
      containers:
      - name: cloudhealth-collector
        securityContext:
          {}
        image: "cloudhealth/container-collector:957"
        args: ["upload_k8s_state", "--verbose"]
        imagePullPolicy: IfNotPresent
        resources:
          limits:
            cpu: 1000m
            memory: 512Mi
          requests:
            cpu: 500m
            memory: 512Mi
        env:
        - name: CHT_API_TOKEN
          valueFrom:
            secretKeyRef:
              name: my-release-cloudhealth-collector
              key: api_key
        - name: CHT_CLUSTER_NAME
          value: your-cluster-name
        - name: CHT_INTERVAL
          value: "900"
        - name: CHT_JVM_MEM
          value: "-Xmx891M"          
      restartPolicy: Always
